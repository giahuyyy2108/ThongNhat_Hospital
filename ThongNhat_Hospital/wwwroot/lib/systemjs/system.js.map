{"version":3,"sources":["../node_modules/es-module-loader/core/common.js","../node_modules/es-module-loader/core/resolve.js","../node_modules/es-module-loader/core/loader-polyfill.js","../node_modules/es-module-loader/core/register-loader.js","../src/common.js","../src/fetch.js","../src/resolve.js","../src/config.js","../src/evaluate.js","../src/format-helpers.js","../src/instantiate.js","../src/systemjs-loader.js","../src/system.js"],"names":["isBrowser","window","document","isNode","process","versions","node","isWindows","platform","match","envGlobal","self","global","hasSymbol","Symbol","baseURI","createSymbol","name","getElementsByTagName","bases","href","location","split","slashIndex","lastIndexOf","substr","cwd","TypeError","replace","length","errArgs","Error","fileName","LoaderError__Check_error_message_for_loader_stack","childErr","newMessage","err","message","lineNumber","stack","originalErr","throwResolveError","relUrl","parentUrl","RangeError","resolveIfNotPlain","trim","parentProtocol","indexOf","firstChar","secondChar","pathname","parentIsPlain","undefined","segmented","output","segmentIndex","i","pop","push","substring","join","resolvedPromise","Promise","resolve","arrayValues","arr","values","iterator","iterable","keys","Object","keyIndex","next","value","done","Loader","this","registry","Registry","ensureInstantiated","module","ModuleNamespace","prototype","constructor","import","key","parent","loader","then","RESOLVE_INSTANTIATE","catch","addToError","RESOLVE","resolveInstantiate","ensureResolution","resolvedKey","resolved","get","iteratorSupport","REGISTRY","entries","map","set","namespace","has","hasOwnProperty","call","delete","BASE_OBJECT","baseObject","defineProperty","forEach","extendNamespace","enumerable","create","toStringTag","REGISTER_INTERNAL","RegisterLoader","registryDelete","deleted","records","linkRecord","lastRegister","trace","INSTANTIATE","instantiate","createLoadRecord","state","registration","importerSetters","loadError","evalError","instantiatePromise","dependencies","execute","executingRequire","moduleObj","setters","depsInstantiatePromise","dependencyInstantiations","parentKey","load","reject","link","createProcessAnonRegister","instantiation","traceLoad","default","__useDefault","registerDeclarative","resolveInstantiateDep","traceDepMap","loads","deps","dynamicDeps","depMap","declare","definedExports","declared","changed","p","ContextualLoader","exports","instantiateDeps","depsInstantiatePromises","Array","all","setter","deepInstantiateDeps","seen","loadCnt","queueLoad","processLoad","depLoad","id","meta","url","ensureEvaluate","doEvaluate","makeDynamicRequire","depLink","declarativeExecute","configurable","require","dynamicExecute","moduleDefault","__esModule","processAnonRegister","instantiated","register","registerDynamic","nullContext","e","freeze","noop","emptyModule","hasStringTag","protectedCreateNamespace","bindings","isModule","m","toString","CONFIG","METADATA","isWorker","importScripts","parentModuleContext","warn","msg","force","warnings","console","checkInstantiateWasm","wasmBuffer","bytes","Uint8Array","WebAssembly","compile","importObj","Module","imports","_export","Instance","loadNodeModule","baseURL","_nodeRequire","base","decodeURI","paths","_nodeModulePaths","extend","a","b","prepend","extendMeta","_prepend","val","concat","supportsPreload","supportsPrefetch","preloadScript","createElement","rel","as","head","appendChild","Image","src","workerImport","relList","supports","onerror","apply","arguments","scriptLoad","crossOrigin","integrity","script","cleanup","error","removeEventListener","removeChild","type","charset","async","addEventListener","readMemberExpression","pParts","shift","applyPaths","mapMatch","getMapMatch","target","checkMap","curLen","len","bestMatch","cjsRequireRegEx","fs","fetchFunction","fetchFetch","authorization","asBuffer","hasXhr","xhrFetch","opts","headers","Accept","credentials","fetch","res","ok","arrayBuffer","text","status","statusText","xhr","XMLHttpRequest","response","responseText","responseType","onreadystatechange","readyState","open","setRequestHeader","withCredentials","send","nodeFetch","hasFetch","readFile","data","dataString","noFetch","fetch$1","createMetadata","pluginKey","pluginArgument","pluginModule","packageKey","packageConfig","getParentMetadata","config","parentPluginIndex","parentMetadata","pluginFirst","packages","normalize","metadata","booleanIndex","conditionObj","parseCondition","resolveCondition","conditionValue","parsed","parsePlugin","plugin","packageResolve","argument","normalized","combinePluginParts","interpolateConditional","setMeta","decanonicalize","coreResolve","normalizeSync","packageResolveSync","doMap","packageName","relativeResolved","trailingSlash","skipExtensions","parentMap","parentMapMatch","mapped","doMapSync","pkgConfigMatch","getPackageConfigMatch","packageConfigKeys","createPackage","subPath","applyPackageConfigSync","createMeta","format","configured","loadPackageConfigPath","configPath","applyPackageConfig","extension","globals","nonce","sourceMap","encapsulateGlobal","cjsRequireDetection","cjsDeferDepsExecute","esModule","wildcardIndex","bestDepth","depth","getMetaMatches","metaPattern","matchMeta","matchDepth","argumentKey","pluginIndex","addDefaultExtension","pkg","pkgKey","defaultExtension","metaMatch","main","mapPath","validMapping","path","conditionPromises","conditions","c","condition","conditionValues","prop","negate","packageConfigPaths","createPkgConfigPathObj","lastWildcard","Math","max","regEx","RegExp","wildcard","exactMatch","packageConfigPath","pkgConfigPath","configLoader","pluginLoader","pkgConfig","setPkgConfig","pkgMeta","matchFn","dotRel","exactMeta","sysConditions","conditionExport","conditionModule","negation","conditionExportIndex","bool","interpolationRegEx","conditionalMatch","envConfigNames","envSet","cfg","envCallback","envConfig","envModule","cloneObj","obj","maxDepth","clone","getConfigItem","cfgItem","getConfig","configName","configNames","configItem","setConfig","isEnvConfig","wasm","setProduction","production","build","defaultJSExtensions","v","pkgName","packageLength","bundles","bundle","depCache","transpiler","prependConfig","hasBuffer","Buffer","sourceMapPrefix","vm","useVm","curSystem","inlineSourceMap","sourceMapString","btoa","unescape","encodeURIComponent","getSource","source","address","wrap","lastLineIndex","JSON","stringify","scriptExec","body","documentElement","_e","preExec","setAttribute","postExec","callCounter","System","SystemJS","supportsScriptExec","windowOrigin","evaluate","noWrap","runInThisContext","filename","setHelpers","newModule","requireResolve","bind","getPathVars","prepareGlobal","setAmdHelper","names","callback","errback","referer","splice","dynamicRequires","modules","define","factory","requireIndex","exportsIndex","moduleIndex","req","depValues","uri","contextualRequire","toUrl","curRequire","curMetaDeps","amdGetCJSDeps","lastNamedDefine","multipleNamedDefines","curEsModule","wrapEsModuleExecute","amd","amdDefine","amdRequire","stripOrigin","request","parentId","moduleId","dirname","chrome","navigator","userAgent","protocol","hostname","port","commentRegEx","stringRegEx","getCJSDeps","lastIndex","stringLocations","commentLocations","inLocation","locations","index","exec","dep","ignoredGlobalProps","globalSnapshot","globalIterator","globalName","getGlobalValue","globalValue","moduleName","encapsulate","oldGlobals","curDefine","g","singleGlobal","multipleExports","cjsRequirePre","cjsRequirePost","fnBracketRegEx","wsRegEx","requireRegExs","requireAlias","requireRegEx","clearLastDefine","metaDeps","registerLastDefine","supportsScriptLoad","nodeRequire","setMetaEsModule","moduleValue","loadBundlesAndDepCache","initializePlugin","runFetchPipeline","pluginLoad","matched","curModule","parts","locate","fetched","wasmInstantiated","stringSource","TextDecoder","decode","translateAndInstantiate","readMetaSyntax","translate","traceOpts","translated","sanitizeSourceMap","detectRegisterFormat","esmRegEx","transpile","calledInstantiate","result","detectLegacyFormat","registered","parse","pathVars","__cjsWrapper","args","cjsWrapper","hashBangRegEx","gl","exportName","retrieveGlobal","browser","leadingCommentAndMetaRegEx","leadingCommentAndMeta","codeStart","startsWith","amdRegEx","cjsExportsRegEx","originalName","file","sources","depsPrefix","metaRegEx","metaPartRegEx","scriptSrc","setMetaProperty","curPart","metaParts","metaString","metaName","metaValue","scripts","curScript","currentScript","defer","__filename","SystemJSLoader","_loader","loadedBundles","isProduction","isBuilder","dev","resolveSync","hasProxy","Proxy","option","registryWarn","method","version"],"mappings":";;;yBAGO,IAAIA,UAA8B,oBAAXC,QAA8C,oBAAbC,SACpDC,OAA4B,oBAAZC,SAA2BA,QAAQC,UAAYD,QAAQC,SAASC,KAChFC,UAA+B,oBAAZH,SAAuD,iBAArBA,QAAQI,UAAyBJ,QAAQI,SAASC,MAAM,QAEpHC,UAA4B,oBAATC,KAAuBA,KAAOC,OAMjDC,UAA8B,oBAAXC,OAqBZC,QApBJ,SAASC,aAAcC,GAC5B,OAAOJ,UAAYC,SAAW,KAAOG,EAsBvC,GAAuB,oBAAZf,UAA2BA,SAASgB,sBAG7C,GAFAH,QAAUb,SAASa,SAEdA,QAAS,CACZ,IAAII,MAAQjB,SAASgB,qBAAqB,QAC1CH,QAAUI,MAAM,IAAMA,MAAM,GAAGC,MAAQnB,OAAOoB,SAASD,UAG/B,oBAAZC,WACdN,QAAUM,SAASD,MAIrB,GAAIL,QAAS,CACXA,QAAUA,QAAQO,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC3C,IAAIC,WAAaR,QAAQS,YAAY,MACjB,IAAhBD,aACFR,QAAUA,QAAQU,OAAO,EAAGF,WAAa,QAExC,CAAA,GAAuB,oBAAZnB,UAA2BA,QAAQsB,IAMjD,MAAM,IAAIC,UAAU,0BALpBZ,QAAU,WAAaR,UAAY,IAAM,IAAMH,QAAQsB,MACnDnB,YACFQ,QAAUA,QAAQa,QAAQ,MAAO,MAOD,MAAhCb,QAAQA,QAAQc,OAAS,KAC3Bd,SAAW,KAKb,IAAIe,QAAwC,KAA9B,IAAIC,MAAM,EAAG,KAAKC,SAChC,SAASC,kDAAmDC,EAAUC,GAE/DnC,YACHmC,EAAaA,EAAWP,QAAQrB,UAAY,eAAiB,aAAc,KAE7E,IAEI6B,EAFAC,GAAWH,EAASG,SAAWH,GAAY,OAASC,EAItDC,EADEN,SAAWI,EAASF,SAChB,IAAID,MAAMM,EAASH,EAASF,SAAUE,EAASI,YAE/C,IAAIP,MAAMM,GAGlB,IAAIE,EAAQL,EAASM,YAAcN,EAASM,YAAYD,MAAQL,EAASK,MAUzE,OANEH,EAAIG,MAFFpC,OAEUkC,EAAU,OAASE,EAEnBA,EAEdH,EAAII,YAAcN,EAASM,aAAeN,EAEnCE,EC5FT,SAASK,kBAAmBC,EAAQC,GAClC,MAAM,IAAIC,WAAW,sBAAwBF,EAAS,QAAUC,GAE3D,SAASE,kBAAmBH,EAAQC,GACzCD,EAASA,EAAOI,OAChB,IAAIC,EAAiBJ,GAAaA,EAAUlB,OAAO,EAAGkB,EAAUK,QAAQ,KAAO,GAE3EC,EAAYP,EAAO,GACnBQ,EAAaR,EAAO,GAGxB,GAAkB,MAAdO,GAAoC,MAAfC,EAGvB,OAFKH,GACHN,kBAAkBC,EAAQC,GACrBI,EAAiBL,EAGrB,GAAkB,MAAdO,IAAqC,MAAfC,GAAqC,MAAfA,IAAqC,MAAdR,EAAO,IAAgC,IAAlBA,EAAOb,SAAiBa,GAAU,OAC7G,IAAlBA,EAAOb,SAAkBa,GAAU,OACrB,MAAdO,EAAmB,CACrB,IAIIE,EAJAC,GAAiBL,GAAuD,MAArCJ,EAAUI,EAAelB,QA0BhE,GArBIuB,QAEgBC,IAAdV,GACFF,kBAAkBC,EAAQC,GAC5BQ,EAAWR,GAMTQ,EAJ8C,MAAzCR,EAAUI,EAAelB,OAAS,GAElB,UAAnBkB,GACFI,EAAWR,EAAUlB,OAAOsB,EAAelB,OAAS,IAChCJ,OAAO0B,EAASH,QAAQ,KAAO,GAGxCL,EAAUlB,OAAO,GAKnBkB,EAAUlB,OAAOsB,EAAelB,OAAS,GAGpC,MAAdoB,EAAmB,CACrB,IAAIG,EAGF,OAAOT,EAAUlB,OAAO,EAAGkB,EAAUd,OAASsB,EAAStB,OAAS,GAAKa,EAFrED,kBAAkBC,EAAQC,GAa9B,IALA,IAAIW,EAAYH,EAAS1B,OAAO,EAAG0B,EAAS3B,YAAY,KAAO,GAAKkB,EAEhEa,KACAC,GAAgB,EAEXC,EAAI,EAAGA,EAAIH,EAAUzB,OAAQ4B,IAEpC,IAAsB,IAAlBD,EASJ,GAAqB,MAAjBF,EAAUG,GAwBdD,EAAeC,MAxBf,CAEE,GAAyB,MAArBH,EAAUG,EAAI,IAAoC,MAArBH,EAAUG,EAAI,IAAcA,EAAI,IAAMH,EAAUzB,OAK5E,CAAA,GAAyB,MAArByB,EAAUG,EAAI,IAAcA,EAAI,IAAMH,EAAUzB,OAGpD,CAEH2B,EAAeC,EACf,SALAA,GAAK,OALLF,EAAOG,MACPD,GAAK,EAaHL,GAAmC,IAAlBG,EAAO1B,QAC1BY,kBAAkBC,EAAQC,OA1BP,MAAjBW,EAAUG,KACZF,EAAOI,KAAKL,EAAUM,UAAUJ,EAAcC,EAAI,IAClDD,GAAgB,GAoCtB,OAHsB,IAAlBA,GACFD,EAAOI,KAAKL,EAAU7B,OAAO+B,IAExBb,EAAUlB,OAAO,EAAGkB,EAAUd,OAASsB,EAAStB,QAAU0B,EAAOM,KAAK,IAM/E,OAAuB,IADHnB,EAAOM,QAAQ,KAE7B7C,QAEgB,MAAduC,EAAO,IAA4B,OAAdA,EAAO,IAAeA,EAAO,GAAGjC,MAAM,UACtD,WAAaiC,EAAOd,QAAQ,MAAO,KAEvCc,OANT,EC7GF,IAAIoB,gBAAkBC,QAAQC,UAK9B,SAASC,YAAaC,GACpB,GAAIA,EAAIC,OACN,OAAOD,EAAIC,SAEb,GAAsB,oBAAXrD,SAA2BA,OAAOsD,SAC3C,MAAM,IAAIrC,MAAM,iDAElB,IAAIsC,KAmBJ,OAlBAA,EAASvD,OAAOsD,UAAY,WAC1B,IAAIE,EAAOC,OAAOD,KAAKJ,GACnBM,EAAW,EACf,OACEC,KAAM,WACJ,OAAID,EAAWF,EAAKzC,QAEhB6C,MAAOR,EAAII,EAAKE,MAChBG,MAAM,IAIND,WAAOrB,EACPsB,MAAM,MAKTN,EAST,SAASO,SACPC,KAAKC,SAAW,IAAIC,SAKtB,SAASC,mBAAoBC,GAC3B,KAAMA,aAAkBC,iBACtB,MAAM,IAAIvD,UAAU,iEACtB,OAAOsD,EALTL,OAAOO,UAAUC,YAAcR,OAS/BA,OAAOO,UAAUE,OAAS,SAAUC,EAAKC,GACvC,GAAmB,iBAARD,EACT,MAAM,IAAI3D,UAAU,2DAEtB,IAAI6D,EAASX,KACb,OAAOf,gBACN2B,KAAK,WACJ,OAAOD,EAAOE,qBAAqBJ,EAAKC,KAEzCE,KAAKT,oBAELW,MAAM,SAAUvD,GACf,MAAMwD,kDAAWxD,EAAK,WAAakD,GAAOC,EAAS,SAAWA,EAAS,QAI3E,IAAIM,QAAUjB,OAAOZ,QAAUhD,aAAa,WAWxC0E,oBAAsBd,OAAOkB,mBAAqB9E,aAAa,sBAYnE,SAAS+E,iBAAkBC,GACzB,QAAoB3C,IAAhB2C,EACF,MAAM,IAAIpD,WAAW,wBACvB,OAAOoD,EAXTpB,OAAOO,UAAUO,qBAAuB,SAAUJ,EAAKC,GACrD,IAAIC,EAASX,KACb,OAAOW,EAAOxB,QAAQsB,EAAKC,GAC1BE,KAAK,SAAUQ,GACd,OAAOT,EAAOV,SAASoB,IAAID,MAU/BrB,OAAOO,UAAUnB,QAAU,SAAUsB,EAAKC,GACxC,IAAIC,EAASX,KACb,OAAOf,gBACN2B,KAAK,WACJ,OAAOD,EAAOK,SAASP,EAAKC,KAE7BE,KAAKM,kBACLJ,MAAM,SAAUvD,GACf,MAAMwD,kDAAWxD,EAAK,aAAekD,GAAOC,EAAS,OAASA,EAAS,QAwB3E,IAAIY,gBAAoC,oBAAXrF,QAA0BA,OAAOsD,SAC1DgC,SAAWpF,aAAa,YAC5B,SAAS+D,WACPF,KAAKuB,aAGHD,kBAEFpB,SAASI,UAAUrE,OAAOsD,UAAY,WACpC,OAAOS,KAAKwB,UAAUvF,OAAOsD,aAI/BW,SAASI,UAAUkB,QAAU,WAC3B,IAAIvB,EAAWD,KAAKuB,UACpB,OAAOnC,YAAYM,OAAOD,KAAKQ,GAAUwB,IAAI,SAAUhB,GACrD,OAAQA,EAAKR,EAASQ,SAM5BP,SAASI,UAAUb,KAAO,WACxB,OAAOL,YAAYM,OAAOD,KAAKO,KAAKuB,aAGtCrB,SAASI,UAAUhB,OAAS,WAC1B,IAAIW,EAAWD,KAAKuB,UACpB,OAAOnC,YAAYM,OAAOD,KAAKQ,GAAUwB,IAAI,SAAUhB,GACrD,OAAOR,EAASQ,OAIpBP,SAASI,UAAUe,IAAM,SAAUZ,GACjC,OAAOT,KAAKuB,UAAUd,IAGxBP,SAASI,UAAUoB,IAAM,SAAUjB,EAAKkB,GACtC,KAAMA,aAAqBtB,iBACzB,MAAM,IAAInD,MAAM,6DAElB,OADA8C,KAAKuB,UAAUd,GAAOkB,EACf3B,MAGTE,SAASI,UAAUsB,IAAM,SAAUnB,GACjC,OAAOf,OAAOmC,eAAeC,KAAK9B,KAAKuB,UAAWd,IAGpDP,SAASI,UAAUyB,OAAS,SAAUtB,GACpC,QAAIf,OAAOmC,eAAeC,KAAK9B,KAAKuB,UAAWd,YACtCT,KAAKuB,UAAUd,IACf,IAUX,IAAIuB,YAAc7F,aAAa,cAc/B,SAASkE,gBAAiB4B,GACxBvC,OAAOwC,eAAelC,KAAMgC,aAC1BnC,MAAOoC,IAYPvC,OAAOD,KAAKwC,GAAYE,QAAQC,gBAAiBpC,MAWrD,SAASoC,gBAAiB3B,GACxBf,OAAOwC,eAAelC,KAAMS,GAC1B4B,YAAY,EACZhB,IAAK,WACH,OAAOrB,KAAKgC,aAAavB,MAX/BJ,gBAAgBC,UAAYZ,OAAO4C,OAAO,MAEpB,oBAAXrG,QAA0BA,OAAOsG,aAC1C7C,OAAOwC,eAAe7B,gBAAgBC,UAAWrE,OAAOsG,aACtD1C,MAAO,WCtNX,IAAI2C,kBAAoBrG,aAAa,qBAErC,SAASsG,iBACP1C,OAAO+B,KAAK9B,MAEZ,IAAI0C,EAAiB1C,KAAKC,SAAS8B,OACnC/B,KAAKC,SAAS8B,OAAS,SAAUtB,GAC/B,IAAIkC,EAAUD,EAAeZ,KAAK9B,KAAMS,GAQxC,OALImC,EAAQf,eAAepB,KAASmC,EAAQnC,GAAKoC,oBACxCD,EAAQnC,GACfkC,GAAU,GAGLA,GAGT,IAAIC,KAEJ5C,KAAKwC,oBAEHM,kBAActE,EAEdoE,QAASA,GAIX5C,KAAK+C,OAAQ,EAGfN,eAAenC,UAAYZ,OAAO4C,OAAOvC,OAAOO,WAChDmC,eAAenC,UAAUC,YAAckC,eAEvC,IAAIO,YAAcP,eAAeQ,YAAc9G,aAAa,eAY5D,SAAS+G,iBAAkBC,EAAO1C,EAAK2C,GACrC,OAAOD,EAAMP,QAAQnC,IACnBA,IAAKA,EAGL2C,aAAcA,EAGdhD,YAAQ5B,EAKR6E,qBAAiB7E,EAEjB8E,eAAW9E,EACX+E,eAAW/E,EAGXqE,YAEEW,wBAAoBhF,EACpBiF,kBAAcjF,EACdkF,aAASlF,EACTmF,kBAAkB,EAGlBC,eAAWpF,EAGXqF,aAASrF,EAGTsF,4BAAwBtF,EAExBuF,8BAA0BvF,IAuChC,SAASyC,mBAAoBN,EAAQF,EAAKuD,EAAW/D,EAAUkD,GAG7D,IAAI/C,EAASH,EAASQ,GACtB,GAAIL,EACF,OAAOlB,QAAQC,QAAQiB,GAEzB,IAAI6D,EAAOd,EAAMP,QAAQnC,GAGzB,OAAIwD,IAASA,EAAK7D,OACZ6D,EAAKX,UACApE,QAAQgF,OAAOD,EAAKX,WACtBL,YAAYtC,EAAQsD,EAAMA,EAAKpB,WAAY5C,EAAUkD,GAGvDxC,EAAOxB,QAAQsB,EAAKuD,GAC1BpD,KAAK,SAAUO,GAGd,GADAf,EAASH,EAASkB,GAEhB,OAAOf,EAWT,IATA6D,EAAOd,EAAMP,QAAQzB,MAMR8C,EAAK7D,SAChB6D,EAAOf,iBAAiBC,EAAOhC,EAAa8C,GAAQA,EAAKb,eAEvDa,EAAKX,UACP,OAAOpE,QAAQgF,OAAOD,EAAKX,WAE7B,IAAIa,EAAOF,EAAKpB,WAChB,OAAKsB,EAGElB,YAAYtC,EAAQsD,EAAME,EAAMlE,EAAUkD,GAFxCc,IAMb,SAASG,0BAA2BzD,EAAQsD,EAAMd,GAChD,OAAO,WACL,IAAIL,EAAeK,EAAML,aAEzB,OAAKA,GAGLK,EAAML,kBAAetE,EACrByF,EAAKb,aAAeN,GAEb,KALImB,EAAKb,cASpB,SAASH,YAAatC,EAAQsD,EAAME,EAAMlE,EAAUkD,GAClD,OAAOgB,EAAKX,qBAAuBW,EAAKX,oBAEvCS,EAAKb,aAAelE,QAAQC,UAAYD,QAAQC,UAAUyB,KAAK,WAE9D,OADAuC,EAAML,kBAAetE,EACdmC,EAAOqC,aAAaiB,EAAKxD,IAAkC,EAA7BE,EAAOqC,aAAahG,QAAcoH,0BAA0BzD,EAAQsD,EAAMd,OAEhHvC,KAAK,SAAUyD,GAEd,QAAsB7F,IAAlB6F,EAA6B,CAC/B,KAAMA,aAAyBhE,iBAC7B,MAAM,IAAIvD,UAAU,qDAKtB,cAHOqG,EAAMP,QAAQqB,EAAKxD,KACtBE,EAAOoC,OACTuB,UAAU3D,EAAQsD,EAAME,GACnBlE,EAASgE,EAAKxD,KAAO4D,EAI9B,IAAIjB,EAAea,EAAKb,aAGxB,GADAa,EAAKb,kBAAe5E,GACf4E,EACH,MAAM,IAAItG,UAAU,sFAoBtB,OAlBAqH,EAAKV,aAAeL,EAAa,GAEjCa,EAAKZ,mBAELc,EAAKP,aAGDR,EAAa,IACfe,EAAKP,UAAUW,QAAUJ,EAAKP,UAAUY,gBACxCL,EAAKR,iBAAmBP,EAAa,GACrCe,EAAKT,QAAUN,EAAa,IAK5BqB,oBAAoB9D,EAAQsD,EAAME,EAAMf,EAAa,IAGhDa,IAERnD,MAAM,SAAUvD,GAEf,MADA0G,EAAKpB,gBAAarE,EACZyF,EAAKX,UAAYW,EAAKX,WAAavC,kDAAWxD,EAAK,iBAAmB0G,EAAKxD,QAKrF,SAASiE,sBAAuB/D,EAAQF,EAAKuD,EAAW/D,EAAUkD,EAAOwB,GAwBvE,OAAOhE,EAAOxB,QAAQsB,EAAKuD,GAC1BpD,KAAK,SAAUO,GACVwD,IACFA,EAAYlE,GAAOU,GAGrB,IAAI8C,EAAOd,EAAMP,QAAQzB,GACrBf,EAASH,EAASkB,GAGtB,GAAIf,KAAY6D,GAAQA,EAAK7D,QAAUA,IAAW6D,EAAK7D,QACrD,OAAOA,EAET,GAAI6D,GAAQA,EAAKX,UACf,MAAMW,EAAKX,YAMRW,IAAS7D,GAAU6D,EAAK7D,UAC3B6D,EAAOf,iBAAiBC,EAAOhC,EAAa8C,GAAQA,EAAKb,eAE3D,IAAIe,EAAOF,EAAKpB,WAChB,OAAKsB,EAGElB,YAAYtC,EAAQsD,EAAME,EAAMlE,EAAUkD,GAFxCc,IAMb,SAASK,UAAW3D,EAAQsD,EAAME,GAChCxD,EAAOiE,MAAQjE,EAAOiE,UACtBjE,EAAOiE,MAAMX,EAAKxD,MAChBA,IAAKwD,EAAKxD,IACVoE,KAAMV,EAAKV,aACXqB,eACAC,OAAQZ,EAAKY,YAWjB,SAASN,oBAAqB9D,EAAQsD,EAAME,EAAMa,GAChD,IAAIpB,EAAYO,EAAKP,UACjBP,EAAkBY,EAAKZ,gBAEvB4B,GAAiB,EAGjBC,EAAWF,EAAQlD,KAAK/F,UAAQ,SAAUK,EAAMyD,GAClD,GAAoB,iBAATzD,EAAmB,CAC5B,IAAI+I,GAAU,EACd,IAAK,IAAIC,KAAKhJ,EACZyD,EAAQzD,EAAKgJ,GACH,iBAANA,GAA2BA,KAAKxB,GAAcA,EAAUwB,KAAOvF,IACjEsF,GAAU,EACVvB,EAAUwB,GAAKvF,GAGnB,IAAgB,IAAZsF,EACF,OAAOtF,MAEN,CACH,IAAKoF,GAAkB7I,KAAQwH,IAAcA,EAAUxH,KAAUyD,EAC/D,OAAOA,EACT+D,EAAUxH,GAAQyD,EAGpB,IAAK,IAAIjB,EAAI,EAAGA,EAAIyE,EAAgBrG,OAAQ4B,IAC1CyE,EAAgBzE,GAAGgF,GAErB,OAAO/D,GACN,IAAIwF,iBAAiB1E,EAAQsD,EAAKxD,MAErC0D,EAAKN,QAAUqB,EAASrB,QACxBM,EAAKT,QAAUwB,EAASxB,QACpBwB,EAASI,UACXnB,EAAKP,UAAYA,EAAYsB,EAASI,QACtCL,GAAiB,GAIrB,SAASM,gBAAiB5E,EAAQsD,EAAME,EAAMlE,EAAUkD,GACtD,GAAIgB,EAAKL,uBACP,OAAOK,EAAKL,uBAId,IAFA,IAAI0B,EAA0BC,MAAMtB,EAAKV,aAAazG,QAE7C4B,EAAI,EAAGA,EAAIuF,EAAKV,aAAazG,OAAQ4B,IAC5C4G,EAAwB5G,GAAK8F,sBAAsB/D,EAAQwD,EAAKV,aAAa7E,GAAIqF,EAAKxD,IAAKR,EAAUkD,EAAOxC,EAAOoC,OAASoB,EAAKY,SAAWZ,EAAKY,YAEnJ,IAAIjB,EAAyB5E,QAAQwG,IAAIF,GACxC5E,KAAK,SAAUmD,GAId,GAHAI,EAAKJ,yBAA2BA,EAG5BI,EAAKN,QACP,IAAK,IAAIjF,EAAI,EAAGA,EAAImF,EAAyB/G,OAAQ4B,IAAK,CACxD,IAAI+G,EAASxB,EAAKN,QAAQjF,GAC1B,GAAI+G,EAAQ,CACV,IAAItB,EAAgBN,EAAyBnF,GAE7C,GAAIyF,aAAyBhE,gBAC3BsF,EAAOtB,OAEJ,CACH,GAAIA,EAAcf,UAChB,MAAMe,EAAcf,UACtBqC,EAAOtB,EAAcjE,QAAUiE,EAAcxB,WAAWe,WAEpDS,EAAchB,iBAChBgB,EAAchB,gBAAgBvE,KAAK6G,KAM7C,OAAO1B,IAiBT,OAdItD,EAAOoC,QACTe,EAAyBA,EAAuBlD,KAAK,WAEnD,OADA0D,UAAU3D,EAAQsD,EAAME,GACjBF,MAGXH,EAAyBA,EAAuBhD,MAAM,SAAUvD,GAG9D,MADA4G,EAAKL,4BAAyBtF,EACxBuC,kDAAWxD,EAAK,WAAa0G,EAAKxD,QAGnBK,MAAM,cAEtBqD,EAAKL,uBAAyBA,EAGvC,SAAS8B,oBAAqBjF,EAAQsD,EAAME,EAAMlE,EAAUkD,GAC1D,OAAO,IAAIjE,QAAQ,SAAUC,EAAS+E,GACpC,IAAI2B,KACAC,EAAU,EACd,SAASC,EAAW9B,GAClB,IAAIE,EAAOF,EAAKpB,WACXsB,IAGuB,IAAxB0B,EAAK1H,QAAQ8F,KAEjB4B,EAAK/G,KAAKmF,GAEV6B,IACAP,gBAAgB5E,EAAQsD,EAAME,EAAMlE,EAAUkD,GAC7CvC,KAAKoF,EAAa9B,IAErB,SAAS8B,EAAa/B,GACpB6B,IACA,IAAI3B,EAAOF,EAAKpB,WAChB,GAAIsB,EACF,IAAK,IAAIvF,EAAI,EAAGA,EAAIuF,EAAKV,aAAazG,OAAQ4B,IAAK,CACjD,IAAIqH,EAAU9B,EAAKJ,yBAAyBnF,GACtCqH,aAAmB5F,iBACvB0F,EAAUE,GAGA,IAAZH,GACF3G,IAEJ4G,EAAU9B,KA0Cd,SAASoB,iBAAkB1E,EAAQF,GACjCT,KAAKW,OAASA,EACdX,KAAKS,IAAMT,KAAKkG,GAAKzF,EACrBT,KAAKmG,MACHC,IAAK3F,GAiBT,SAAS4F,eAAgB1F,EAAQsD,EAAME,EAAMlE,EAAUkD,EAAO0C,GAC5D,GAAI5B,EAAK7D,OACP,OAAO6D,EAAK7D,OAEd,GAAI6D,EAAKV,UACP,MAAMU,EAAKV,UAEb,GAAIsC,IAAgC,IAAxBA,EAAK1H,QAAQ8F,GACvB,OAAOA,EAAKpB,WAAWe,UAIzB,IAAIrG,EAAM+I,WAAW3F,EAAQsD,EAAME,EAAMlE,EAAUkD,EAAOgB,EAAKN,WAAegC,OAC9E,GAAItI,EACF,MAAMA,EAER,OAAO0G,EAAK7D,OAGd,SAASmG,mBAAoB5F,EAAQF,EAAKgD,EAAcM,EAA0B9D,EAAUkD,EAAO0C,GAEjG,OAAO,SAAUzJ,GACf,IAAK,IAAIwC,EAAI,EAAGA,EAAI6E,EAAazG,OAAQ4B,IACvC,GAAI6E,EAAa7E,KAAOxC,EAAM,CAC5B,IACIgE,EADA6F,EAAUlC,EAAyBnF,GAQvC,MAAO,iBAJLwB,EADE6F,aAAmB5F,gBACZ4F,EAEAI,eAAe1F,EAAQsF,EAASA,EAAQpD,WAAY5C,EAAUkD,EAAO0C,IAE9CzF,EAAOoE,aAAepE,EAG5D,MAAM,IAAIlD,MAAM,UAAYd,EAAO,2DAA6DqE,IAMpG,SAAS6F,WAAY3F,EAAQsD,EAAME,EAAMlE,EAAUkD,EAAO0C,GAGxD,IAAItI,EAIJ,GANAsI,EAAK/G,KAAKmF,GAMNE,EAAKN,QAEP,IADA,IAAIoC,EAASO,EACJ5H,EAAI,EAAGA,EAAIuF,EAAKV,aAAazG,OAAQ4B,IAG5C,MAFAqH,EAAU9B,EAAKJ,yBAAyBnF,cAEjByB,oBAIvBmG,EAAUP,EAAQpD,cACwB,IAA3BgD,EAAK1H,QAAQ8H,KAExB1I,EADE0I,EAAQ1C,UACJ0C,EAAQ1C,UAIR+C,WAAW3F,EAAQsF,EAASO,EAASvG,EAAUkD,EAAOqD,EAAQ3C,QAAUgC,OAG9EtI,GAGF,OAFA0G,EAAKpB,gBAAarE,EAClByF,EAAKV,UAAYxC,kDAAWxD,EAAK,cAAgB0G,EAAKxD,KAC/CwD,EAAKV,UAMlB,GAAIY,EAAKT,QAGP,GAAIS,EAAKN,QACPtG,EAAMkJ,mBAAmBtC,EAAKT,aAI3B,CACH,IAAItD,GAAW8F,GAAIjC,EAAKxD,KACpBmD,EAAYO,EAAKP,UACrBlE,OAAOwC,eAAe9B,EAAQ,WAC5BsG,cAAc,EACdhF,IAAK,SAAU4D,GACb1B,EAAUW,QAAUX,EAAUY,aAAec,GAE/CjE,IAAK,WACH,OAAOuC,EAAUY,gBAIrB,IAAImC,EAAUJ,mBAAmB5F,EAAQsD,EAAKxD,IAAK0D,EAAKV,aAAcU,EAAKJ,yBAA0B9D,EAAUkD,EAAO0C,GAGtH,IAAK1B,EAAKR,iBACR,IAAS/E,EAAI,EAAGA,EAAIuF,EAAKV,aAAazG,OAAQ4B,IAC5C+H,EAAQxC,EAAKV,aAAa7E,IAE9BrB,EAAMqJ,eAAezC,EAAKT,QAASiD,EAAS/C,EAAUW,QAASnE,GAG3DA,EAAOkF,UAAY1B,EAAUY,eAC/BZ,EAAUW,QAAUX,EAAUY,aAAepE,EAAOkF,SAEtD,IAAIuB,EAAgBjD,EAAUW,QAG9B,GAAIsC,GAAiBA,EAAcC,WACjC,IAAK,IAAI1B,KAAKyB,EACRnH,OAAOmC,eAAeC,KAAK+E,EAAezB,KAC5CxB,EAAUwB,GAAKyB,EAAczB,IASvC,GAFAnB,EAAKpB,gBAAarE,EAEdjB,EACF,OAAO0G,EAAKV,UAAYxC,kDAAWxD,EAAK,cAAgB0G,EAAKxD,KAO/D,GALAR,EAASgE,EAAKxD,KAAOwD,EAAK7D,OAAS,IAAIC,gBAAgB8D,EAAKP,YAKvDO,EAAKN,QAAS,CACjB,GAAII,EAAKZ,gBACP,IAASzE,EAAI,EAAGA,EAAIqF,EAAKZ,gBAAgBrG,OAAQ4B,IAC/CqF,EAAKZ,gBAAgBzE,GAAGqF,EAAK7D,QACjC6D,EAAKZ,qBAAkB7E,GA9kB3BiE,eAAenC,UAAUmC,eAAetD,QAAUY,OAAOZ,SAAW,SAAUsB,EAAKuD,GACjF,OAAOhG,kBAAkByC,EAAKuD,GAAa9H,UAG7CuG,eAAenC,UAAU0C,aAAe,SAAUvC,EAAKsG,KAoDvDtE,eAAenC,UAAUP,OAAOkB,oBAAsB,SAAUR,EAAKuD,GACnE,IAAIrD,EAASX,KACTmD,EAAQnD,KAAKwC,mBACbvC,EAAWD,KAAKC,SAASsB,UAE7B,OAAON,mBAAmBN,EAAQF,EAAKuD,EAAW/D,EAAUkD,GAC3DvC,KAAK,SAAUoG,GACd,GAAIA,aAAwB3G,gBAC1B,OAAO2G,EAGT,IAAI7C,EAAO6C,EAAanE,WAGxB,IAAKsB,EAAM,CACT,GAAI6C,EAAa5G,OACf,OAAO4G,EAAa5G,OACtB,MAAM4G,EAAazD,UAGrB,OAAOqC,oBAAoBjF,EAAQqG,EAAc7C,EAAMlE,EAAUkD,GAChEvC,KAAK,WACJ,OAAOyF,eAAe1F,EAAQqG,EAAc7C,EAAMlE,EAAUkD,OAAO3E,QA+TzEiE,eAAenC,UAAU2G,SAAW,SAAUxG,EAAKoE,EAAMG,GACvD,IAAI7B,EAAQnD,KAAKwC,wBAGDhE,IAAZwG,EACF7B,EAAML,cAAgBrC,EAAKoE,OAAMrG,IAKtB2E,EAAMP,QAAQnC,IAAQyC,iBAAiBC,EAAO1C,OAAKjC,IACzD4E,cAAgByB,EAAMG,OAASxG,IAOxCiE,eAAenC,UAAU4G,gBAAkB,SAAUzG,EAAKoE,EAAMlB,EAAkBD,GAChF,IAAIP,EAAQnD,KAAKwC,mBAGE,iBAAR/B,EACT0C,EAAML,cAAgBrC,EAAKoE,EAAMlB,IAKtBR,EAAMP,QAAQnC,IAAQyC,iBAAiBC,EAAO1C,OAAKjC,IACzD4E,cAAgByB,EAAMlB,EAAkBD,IAiBjD2B,iBAAiB/E,UAAUE,OAAS,SAAUC,GAG5C,OAFIT,KAAKW,OAAOoC,OACd/C,KAAKW,OAAOiE,MAAM5E,KAAKS,KAAKqE,YAAYhG,KAAK2B,GACxCT,KAAKW,OAAOH,OAAOC,EAAKT,KAAKS,MAqJtC,IAAI0G,eAIJ,SAASV,mBAAoB/C,GAC3B,IACEA,EAAQ5B,KAAKqF,aAEf,MAAOC,GACL,OAAOA,GAIX,SAASR,eAAgBlD,EAASiD,EAASrB,EAASlF,GAClD,IACE,IAAI1B,EAASgF,EAAQ5B,KAAK/F,UAAQ4K,EAASrB,EAASlF,QACrC5B,IAAXE,IACF0B,EAAOkF,QAAU5G,GAErB,MAAO0I,GACL,OAAOA,GAnBP1H,OAAO2H,QACT3H,OAAO2H,OAAOF,aCpoBT,IAAIlI,kBAAkBC,QAAQC,UAC9B,SAASmI,QAET,IAAIC,YAAc,IAAIlH,oBAYzBmH,aAVG,SAASC,yBAA0BC,GACxC,OAAIA,aAAoBrH,gBACfqH,EAELA,GAAYA,EAASZ,WAChB,IAAIzG,gBAAgBqH,GAEtB,IAAIrH,iBAAkBkE,QAASmD,EAAUlD,aAAckD,IAIzD,SAASC,SAAUC,GAGxB,YAFqBpJ,IAAjBgJ,eACFA,aAAiC,oBAAXvL,UAA4BA,OAAOsG,aACpDqF,aAAavH,iBAAmBmH,cAAqD,mBAArC9H,OAAOY,UAAUuH,SAAS/F,KAAK8F,GAGjF,IAAIE,OAAS3L,aAAa,iBACtB4L,SAAW5L,aAAa,YAIxB6L,SAA6B,oBAAX5M,QAA0C,oBAATU,MAAiD,oBAAlBmM,cA6CzFC,oBA3CG,SAASC,KAAMC,EAAKC,IACrBA,GAASrI,KAAKsI,UAA+B,oBAAZC,SAA2BA,QAAQJ,OACtEI,QAAQJ,KAAKC,GAGV,SAASI,qBAAsB7H,EAAQ8H,EAAY1B,GACxD,IAAI2B,EAAQ,IAAIC,WAAWF,GAI3B,OAAiB,IAAbC,EAAM,IAAyB,KAAbA,EAAM,IAA0B,MAAbA,EAAM,GACtCE,YAAYC,QAAQJ,GAAY7H,KAAK,SAAUgH,GACpD,IAAI/C,KACAhB,KACAiF,KAsBJ,OAnBIF,YAAYG,OAAOC,SACrBJ,YAAYG,OAAOC,QAAQpB,GAAGzF,QAAQ,SAAUvD,GAC9C,IAAI6B,EAAM7B,EAAEwB,OACZyD,EAAQ/E,KAAK,SAAU8I,GACrBkB,EAAUrI,GAAOmH,KAEQ,IAAvB/C,EAAK1G,QAAQsC,IACfoE,EAAK/F,KAAK2B,KAEhBE,EAAOsG,SAASpC,EAAM,SAAUoE,GAC9B,OACEpF,QAASA,EACTH,QAAS,WACPuF,EAAQ,IAAIL,YAAYM,SAAStB,EAAGkB,GAAWxD,aAIrDyB,KAEO,IAIJ7H,QAAQC,SAAQ,GAIlB,SAASgK,eAAgB1I,EAAK2I,GACnC,GAAe,MAAX3I,EAAI,GACN,MAAM,IAAIvD,MAAM,eAAiBuD,EAAM,oDAEzC,IAAKyH,oBAAqB,CACxB,IAAIa,EAAS/I,KAAKqJ,aAAa,UAC3BC,EAAOC,UAAUH,EAAQxM,OAAOlB,UAAY,EAAI,KACpDwM,oBAAsB,IAAIa,EAAOO,IACbE,MAAQT,EAAOU,iBAAiBH,GAEtD,OAAOpB,oBAAoBvB,QAAQlG,GAG9B,SAASiJ,OAAQC,EAAGC,GACzB,IAAK,IAAIxE,KAAKwE,EACPlK,OAAOmC,eAAeC,KAAK8H,EAAGxE,KAEnCuE,EAAEvE,GAAKwE,EAAExE,IAEX,OAAOuE,EAGF,SAASE,QAASF,EAAGC,GAC1B,IAAK,IAAIxE,KAAKwE,EACPlK,OAAOmC,eAAeC,KAAK8H,EAAGxE,SAEtB5G,IAATmL,EAAEvE,KACJuE,EAAEvE,GAAKwE,EAAExE,IAEb,OAAOuE,EAOF,SAASG,WAAYH,EAAGC,EAAGG,GAChC,IAAK,IAAI3E,KAAKwE,EACZ,GAAKlK,OAAOmC,eAAeC,KAAK8H,EAAGxE,GAAnC,CAEA,IAAI4E,EAAMJ,EAAExE,QACC5G,IAATmL,EAAEvE,GACJuE,EAAEvE,GAAK4E,EACAA,aAAevE,OAASkE,EAAEvE,aAAcK,MAC/CkE,EAAEvE,MAAQ6E,OAAOF,EAAWC,EAAML,EAAEvE,IAAI6E,OAAOF,EAAWJ,EAAEvE,GAAK4E,GAC5C,iBAAPA,GAA2B,OAARA,GAA+B,iBAARL,EAAEvE,GAC1DuE,EAAEvE,IAAM2E,EAAWF,QAAUH,QAAQA,UAAWC,EAAEvE,IAAK4E,GAC/CD,IACRJ,EAAEvE,GAAK4E,IAIb,IAAIE,iBAAkB,EAAOC,kBAAmB,EAazC,SAASC,cAAehE,GAE7B,GAAK8D,iBAAoBC,iBAAzB,CAMA,IAAIhG,EAAO9I,SAASgP,cAAc,QAC9BH,iBACF/F,EAAKmG,IAAM,UACXnG,EAAKoG,GAAK,UAIVpG,EAAKmG,IAAM,WAEbnG,EAAK5H,KAAO6J,EACZ/K,SAASmP,KAAKC,YAAYtG,OAhB1B,EACqB,IAAIuG,OACVC,IAAMvE,GAiBvB,SAASwE,aAAcD,EAAKxL,EAAS+E,GACnC,IACE+D,cAAc0C,GAEhB,MAAOvD,GACLlD,EAAOkD,GAETjI,IAGF,GA3CIhE,WACF,WACE,IAAI0P,EAAUxP,SAASgP,cAAc,QAAQQ,QAC7C,GAAIA,GAAWA,EAAQC,SAAU,CAC/BX,kBAAmB,EACnB,IACED,gBAAkBW,EAAQC,SAAS,WAErC,MAAO1D,MAPX,GA0CEjM,UAAW,CACb,IAAI4P,QAAU3P,OAAO2P,QACrB3P,OAAO2P,QAAU,SAAwB3C,EAAKuC,GACxCI,SACFA,QAAQC,MAAMhL,KAAMiL,YAInB,SAASC,WAAYP,EAAKQ,EAAaC,EAAWjM,EAAS+E,GAKhE,GAHAyG,EAAMA,EAAI5N,QAAQ,KAAM,OAGpBiL,SACF,OAAO4C,aAAaD,EAAKxL,EAAS+E,GAEpC,IAAImH,EAAShQ,SAASgP,cAAc,UAgBpC,SAASpG,IACP9E,IACAmM,IAIF,SAASC,EAAOhO,GACd+N,IACApH,EAAO,IAAIhH,MAAM,YAAcyN,IAGjC,SAASW,IACPD,EAAOG,oBAAoB,OAAQvH,GAAM,GACzCoH,EAAOG,oBAAoB,QAASD,GAAO,GAC3ClQ,SAASmP,KAAKiB,YAAYJ,GA7B5BA,EAAOK,KAAO,kBACdL,EAAOM,QAAU,QACjBN,EAAOO,OAAQ,EAEXT,IACFE,EAAOF,YAAcA,GACnBC,IACFC,EAAOD,UAAYA,GAErBC,EAAOQ,iBAAiB,OAAQ5H,GAAM,GACtCoH,EAAOQ,iBAAiB,QAASN,GAAO,GAExCF,EAAOV,IAAMA,EACbtP,SAASmP,KAAKC,YAAYY,GAoBrB,SAASS,qBAAsB1G,EAAGvF,GAEvC,IADA,IAAIkM,EAAS3G,EAAE3I,MAAM,KACdsP,EAAO/O,QACZ6C,EAAQA,EAAMkM,EAAOC,SACvB,OAAOnM,EAIF,SAASoM,WAAY7C,EAASI,EAAO/I,GAC1C,IAAIyL,EAAWC,YAAY3C,EAAO/I,GAClC,GAAIyL,EAAU,CACZ,IAAIE,EAAS5C,EAAM0C,GAAYzL,EAAI7D,OAAOsP,EAASlP,QAE/CoE,EAAWpD,kBAAkBoO,EAAQlQ,SACzC,YAAiBsC,IAAb4C,EACKA,EAEFgI,EAAUgD,EAEd,OAA0B,IAAtB3L,EAAItC,QAAQ,KACZsC,EAGA2I,EAAU3I,EAIrB,SAAS4L,SAAUjH,GACjB,IAAIhJ,EAAO4D,KAAK5D,KAEhB,GAAIA,EAAKQ,OAAO,EAAGwI,EAAEpI,UAAYoI,IAAMhJ,EAAKY,SAAWoI,EAAEpI,QAA6B,MAAnBZ,EAAKgJ,EAAEpI,SAAuC,MAApBoI,EAAEA,EAAEpI,OAAS,IAAkC,MAApBoI,EAAEA,EAAEpI,OAAS,IAAa,CAChJ,IAAIsP,EAASlH,EAAE3I,MAAM,KAAKO,OACtBsP,EAAStM,KAAKuM,MAChBvM,KAAKpE,MAAQwJ,EACbpF,KAAKuM,IAAMD,IAKV,SAASH,YAAa1K,EAAKrF,GAChC,GAAIsD,OAAOmC,eAAeC,KAAKL,EAAKrF,GAClC,OAAOA,EAET,IAAIoQ,GACFpQ,KAAMA,EACNR,WAAO4C,EACP+N,IAAK,GAKP,OAFA7M,OAAOD,KAAKgC,GAAKU,QAAQkK,SAAUG,GAE5BA,EAAU5Q,MAIZ,IAAI6Q,gBAAkB,0IC5LzBC,GAyCAC,cAjIJ,SAASC,WAAYxG,EAAKyG,EAAezB,EAAW0B,GAElD,GAAyB,aAArB1G,EAAIxJ,OAAO,EAAG,GAAmB,CACnC,GAAImQ,OACF,OAAOC,SAAS5G,EAAKyG,EAAezB,EAAW0B,GAE/C,MAAM,IAAI5P,MAAM,kDAIpBkJ,EAAMA,EAAIrJ,QAAQ,KAAM,OAExB,IAAIkQ,GAEFC,SAAWC,OAAQ,iCAYrB,OATI/B,IACF6B,EAAK7B,UAAYA,GAEfyB,IAC0B,iBAAjBA,IACTI,EAAKC,QAAuB,cAAIL,GAClCI,EAAKG,YAAc,WAGdC,MAAMjH,EAAK6G,GACjBrM,KAAK,SAAS0M,GACb,GAAIA,EAAIC,GACN,OAAOT,EAAWQ,EAAIE,cAAgBF,EAAIG,OAE1C,MAAM,IAAIvQ,MAAM,gBAAkBoQ,EAAII,OAAS,IAAMJ,EAAIK,cAI/D,SAASX,SAAU5G,EAAKyG,EAAezB,EAAW0B,GAChD,OAAO,IAAI5N,QAAQ,SAAUC,EAAS+E,GAEpCkC,EAAMA,EAAIrJ,QAAQ,KAAM,OAExB,IAAI6Q,EAAM,IAAIC,eAGd,SAAS5J,IACP9E,EAAQ2N,EAAWc,EAAIE,SAAWF,EAAIG,cAExC,SAASxC,IACPrH,EAAO,IAAIhH,MAAM,eAAiB0Q,EAAIF,OAAS,KAAOE,EAAIF,QAAUE,EAAID,WAAa,IAAMC,EAAID,WAAc,IAAM,IAAM,IAAM,YAAcvH,IAN3I0G,IACFc,EAAII,aAAe,eAQrBJ,EAAIK,mBAAqB,WACA,IAAnBL,EAAIM,aAEY,GAAdN,EAAIF,OACFE,EAAIE,SACN7J,KAKA2J,EAAI/B,iBAAiB,QAASN,GAC9BqC,EAAI/B,iBAAiB,OAAQ5H,IAGT,MAAf2J,EAAIF,OACXzJ,IAGAsH,MAINqC,EAAIO,KAAK,MAAO/H,GAAK,GAEjBwH,EAAIQ,mBACNR,EAAIQ,iBAAiB,SAAU,gCAE3BvB,IAC0B,iBAAjBA,GACTe,EAAIQ,iBAAiB,gBAAiBvB,GACxCe,EAAIS,iBAAkB,IAI1BT,EAAIU,KAAK,QAKb,SAASC,UAAWnI,EAAKyG,EAAezB,EAAW0B,GACjD,MAAwB,YAApB1G,EAAIxJ,OAAO,EAAG,GACZ4R,SACK5B,WAAWxG,EAAKyG,EAAezB,EAAW0B,GAE1C5N,QAAQgF,OAAO,IAAIhH,MAAM,oBAAsBkJ,EAAM,qFAGhEsG,GAAKA,IAAM/F,QAAQ,MAEjBP,EADE1K,UACI0K,EAAIrJ,QAAQ,MAAO,MAAMH,OAAO,GAEhCwJ,EAAIxJ,OAAO,GAEZ,IAAIsC,QAAQ,SAAUC,EAAS+E,GACpCwI,GAAG+B,SAASrI,EAAK,SAAS7I,EAAKmR,GAC7B,GAAInR,EACF,OAAO2G,EAAO3G,GAGd,GAAIuP,EACF3N,EAAQuP,OAEL,CAEH,IAAIC,EAAaD,EAAO,GACF,WAAlBC,EAAW,KACbA,EAAaA,EAAW/R,OAAO,IAEjCuC,EAAQwP,SAOlB,SAASC,UACP,MAAM,IAAI1R,MAAM,oDAKlB,IAAI6P,OAAmC,oBAAnBc,eAChBW,SAA4B,oBAAVnB,MAGrBV,cADmB,oBAAT7Q,WAA8C,IAAfA,KAAKuR,MAC9BT,WACRG,OACSC,SACU,oBAAZrG,SAA8C,oBAAZpL,QAChCgT,UAEAK,QAElB,IAAAC,QAAelC,cC9IR,SAASmC,iBACd,OACEC,eAAWvQ,EACXwQ,oBAAgBxQ,EAChByQ,kBAAczQ,EACd0Q,gBAAY1Q,EACZ2Q,mBAAe3Q,EACfyF,UAAMzF,GAyBV,SAAS4Q,kBAAmBzO,EAAQ0O,EAAQrL,GAC1C,IAMMsL,EANFC,EAAiBT,iBAEjB9K,IAKEqL,EAAOG,aACiD,KAArDF,EAAoBtL,EAAUrH,YAAY,QAC7C4S,EAAeP,eAAiBO,EAAeR,UAAY/K,EAAUpH,OAAO,EAAG0S,KAG3B,KAAjDA,EAAoBtL,EAAU7F,QAAQ,QACzCoR,EAAeP,eAAiBO,EAAeR,UAAY/K,EAAUpH,OAAO0S,EAAoB,IAIpGC,EAAeL,WAAa/C,YAAYkD,EAAOI,SAAUzL,GACrDuL,EAAeL,aACjBK,EAAeJ,cAAgBE,EAAOI,SAASF,EAAeL,cAGlE,OAAOK,EAGF,SAASG,UAAWjP,EAAKuD,GAC9B,IAAIqL,EAASrP,KAAK8H,QAEd6H,EAAWb,iBACXS,EAAiBH,kBAAkBpP,KAAMqP,EAAQrL,GAEjDrD,EAASX,KAEb,OAAOd,QAAQC,UAGdyB,KAAK,WAEJ,IAAIgP,EAAenP,EAAI9D,YAAY,MAEnC,IAAsB,IAAlBiT,EACF,OAAO1Q,QAAQC,QAAQsB,GAEzB,IAAIoP,EAAeC,eAAehO,KAAKnB,EAAQF,EAAI7D,OAAOgT,EAAe,IAUzE,OAAOG,iBAAiBjO,KAAKnB,EAAQkP,EAAc7L,GAAW,GAC7DpD,KAAK,SAAUoP,GACd,OAAOA,EAAiBvP,EAAI7D,OAAO,EAAGgT,GAAgB,aAKzDhP,KAAK,SAAUH,GACd,IAAIwP,EAASC,YAAYb,EAAOG,YAAa/O,GAE7C,OAAKwP,GAGLN,EAASZ,UAAYkB,EAAOE,OAErBjR,QAAQwG,KACb0K,eAAetO,KAAKnB,EAAQ0O,EAAQY,EAAOI,SAAUd,GAAkBA,EAAeP,gBAAkBhL,EAAW2L,EAAUJ,GAAgB,GAC7I5O,EAAOxB,QAAQ8Q,EAAOE,OAAQnM,KAE/BpD,KAAK,SAAU0P,GAKd,GAJAX,EAASX,eAAiBsB,EAAW,GACrCX,EAASZ,UAAYuB,EAAW,GAG5BX,EAASX,iBAAmBW,EAASZ,UACvC,MAAM,IAAI7R,MAAM,UAAYyS,EAASX,eAAiB,uHAExD,OAAOuB,mBAAmBlB,EAAOG,YAAac,EAAW,GAAIA,EAAW,OAhBjEF,eAAetO,KAAKnB,EAAQ0O,EAAQ5O,EAAK8O,GAAkBA,EAAeP,gBAAkBhL,EAAW2L,EAAUJ,GAAgB,KAmB3I3O,KAAK,SAAU0P,GACd,OAAOE,uBAAuB1O,KAAKnB,EAAQ2P,EAAYtM,EAAWuL,KAEnE3O,KAAK,SAAU0P,GAGd,OAFAG,QAAQ3O,KAAKnB,EAAQ0O,EAAQiB,EAAYX,GAErCA,EAASZ,YAAcY,EAAS1L,KAAKtD,OAChC2P,EAIF3P,EAAOxB,QAAQwQ,EAAS1L,KAAKtD,OAAQ2P,GAC3C1P,KAAK,SAAUmO,GAGd,OAFAY,EAASZ,UAAYA,EACrBY,EAASX,eAAiBsB,MAI7B1P,KAAK,SAAU0P,GAEd,OADA3P,EAAOoH,UAAUuI,GAAcX,EACxBW,IAMJ,SAASI,eAAgBrB,EAAQ5O,GACtC,IAAIwP,EAASC,YAAYb,EAAOG,YAAa/O,GAG7C,GAAIwP,EAAQ,CACV,IAAIlB,EAAY2B,eAAe5O,KAAK9B,KAAMqP,EAAQY,EAAOE,QACzD,OAAOI,mBAAmBlB,EAAOG,YAAamB,YAAY7O,KAAK9B,KAAMqP,EAAQY,EAAOI,cAAU7R,GAAW,GAAO,GAAQuQ,GAG1H,OAAO4B,YAAY7O,KAAK9B,KAAMqP,EAAQ5O,OAAKjC,GAAW,GAAO,GAGxD,SAASoS,cAAenQ,EAAKuD,GAClC,IAAIqL,EAASrP,KAAK8H,QAGd6H,EAAWb,iBACXS,EAAiBA,GAAkBH,kBAAkBpP,KAAMqP,EAAQrL,GAEnEiM,EAASC,YAAYb,EAAOG,YAAa/O,GAG7C,OAAIwP,GACFN,EAASZ,UAAY6B,cAAc9O,KAAK9B,KAAMiQ,EAAOE,OAAQnM,GACtDuM,mBAAmBlB,EAAOG,YAC7BqB,mBAAmB/O,KAAK9B,KAAMqP,EAAQY,EAAOI,SAAUd,EAAeP,gBAAkBhL,EAAW2L,EAAUJ,IAAkBI,EAASZ,WACxIY,EAASZ,YAGR8B,mBAAmB/O,KAAK9B,KAAMqP,EAAQ5O,EAAK8O,EAAeP,gBAAkBhL,EAAW2L,EAAUJ,IAAkBI,EAASZ,WAG9H,SAAS4B,YAAatB,EAAQ5O,EAAKuD,EAAW8M,EAAOC,GAC1D,IAAIC,EAAmBhT,kBAAkByC,EAAKuD,GAAa9H,SAG3D,GAAI8U,EACF,OAAO/E,WAAWoD,EAAOjG,QAASiG,EAAO7F,MAAOwH,GAGlD,GAAIF,EAAO,CACT,IAAI5E,EAAWC,YAAYkD,EAAO5N,IAAKhB,GAEvC,GAAIyL,IAGF8E,EAAmBhT,kBAFnByC,EAAM4O,EAAO5N,IAAIyK,GAAYzL,EAAI7D,OAAOsP,EAASlP,QAEPd,UAExC,OAAO+P,WAAWoD,EAAOjG,QAASiG,EAAO7F,MAAOwH,GAItD,GAAIhR,KAAKC,SAAS2B,IAAInB,GACpB,OAAOA,EAET,GAAyB,WAArBA,EAAI7D,OAAO,EAAG,GAChB,OAAO6D,EAET,IAAIwQ,EAAgBF,GAAuC,MAAxBtQ,EAAIA,EAAIzD,OAAS,GAChDoE,EAAW6K,WAAWoD,EAAOjG,QAASiG,EAAO7F,MAAOyH,EAAgBxQ,EAAM,IAAMA,GACpF,OAAIwQ,EACK7P,EAASxE,OAAO,EAAGwE,EAASpE,OAAS,GACvCoE,EAGT,SAASyP,mBAAoBxB,EAAQ5O,EAAKuD,EAAW2L,EAAUJ,EAAgB2B,GAE7E,GAAI3B,GAAkBA,EAAeJ,eAA4B,MAAX1O,EAAI,GAAY,CACpE,IAAI0Q,EAAY5B,EAAeJ,cAAc1N,IACzC2P,EAAiBD,GAAahF,YAAYgF,EAAW1Q,GAEzD,GAAI2Q,GAAuD,iBAA9BD,EAAUC,GAA8B,CACnE,IAAIC,EAASC,UAAUtR,KAAMqP,EAAQE,EAAeJ,cAAeI,EAAeL,WAAYkC,EAAgB3Q,EAAKkP,EAAUuB,GAC7H,GAAIG,EACF,OAAOA,GAIb,IAAIf,EAAaK,YAAY7O,KAAK9B,KAAMqP,EAAQ5O,EAAKuD,GAAW,GAAM,GAElEuN,EAAiBC,sBAAsBnC,EAAQiB,GAGnD,GAFAX,EAAST,WAAaqC,GAAkBA,EAAerC,YAAc/C,YAAYkD,EAAOI,SAAUa,IAE7FX,EAAST,WACZ,OAAOoB,EAET,IAAsD,IAAlDjB,EAAOoC,kBAAkBtT,QAAQmS,GAEnC,OADAX,EAAST,gBAAa1Q,EACf8R,EAGTX,EAASR,cAAgBE,EAAOI,SAASE,EAAST,cAAgBG,EAAOI,SAASE,EAAST,YAAcwC,iBAEzG,IAAIC,EAAUrB,EAAW1T,OAAO+S,EAAST,WAAWlS,OAAS,GAE7D,OAAO4U,uBAAuB5R,KAAMqP,EAAQM,EAASR,cAAeQ,EAAST,WAAYyC,EAAShC,EAAUuB,GAG9G,SAASd,eAAgBf,EAAQ5O,EAAKuD,EAAW2L,EAAUJ,EAAgB2B,GACzE,IAAIvQ,EAASX,KAEb,OAAOf,kBACN2B,KAAK,WAEJ,GAAI2O,GAAkBA,EAAeJ,eAAsC,OAArB1O,EAAI7D,OAAO,EAAG,GAAa,CAC/E,IAAIuU,EAAY5B,EAAeJ,cAAc1N,IACzC2P,EAAiBD,GAAahF,YAAYgF,EAAW1Q,GAEzD,GAAI2Q,EACF,OAAON,MAAMnQ,EAAQ0O,EAAQE,EAAeJ,cAAeI,EAAeL,WAAYkC,EAAgB3Q,EAAKkP,EAAUuB,GAGzH,OAAOjS,oBAER2B,KAAK,SAAUyQ,GACd,GAAIA,EACF,OAAOA,EAGT,IAAIf,EAAaK,YAAY7O,KAAKnB,EAAQ0O,EAAQ5O,EAAKuD,GAAW,GAAM,GAEpEuN,EAAiBC,sBAAsBnC,EAAQiB,GAGnD,OAFAX,EAAST,WAAaqC,GAAkBA,EAAerC,YAAc/C,YAAYkD,EAAOI,SAAUa,GAE7FX,EAAST,YAGwC,IAAlDG,EAAOoC,kBAAkBtT,QAAQmS,IACnCX,EAAST,gBAAa1Q,EACtBmR,EAAS1L,KAAO4N,aAChBlC,EAAS1L,KAAK6N,OAAS,OAEvBnC,EAAS1L,KAAKtD,OAAS,GAChBzB,QAAQC,QAAQmR,KAGzBX,EAASR,cAAgBE,EAAOI,SAASE,EAAST,cAAgBG,EAAOI,SAASE,EAAST,YAAcwC,kBAGxFH,IAAmB5B,EAASR,cAAc4C,WAEtCC,sBAAsBrR,EAAQ0O,EAAQkC,EAAeU,WAAYtC,GAAY1Q,mBACjG2B,KAAK,WACJ,IAAI+Q,EAAUrB,EAAW1T,OAAO+S,EAAST,WAAWlS,OAAS,GAE7D,OAAOkV,mBAAmBvR,EAAQ0O,EAAQM,EAASR,cAAeQ,EAAST,WAAYyC,EAAShC,EAAUuB,MApBnGhS,QAAQC,QAAQmR,KAyB7B,SAASuB,aACP,OACEM,UAAW,GACXtN,UAAMrG,EACNsT,YAAQtT,EACRmC,YAAQnC,EACR0M,gBAAY1M,EACZ4T,aAAS5T,EACT6T,WAAO7T,EACP4M,eAAW5M,EACX8T,eAAW9T,EACX8G,aAAS9G,EACT+T,mBAAmB,EACnBpH,iBAAa3M,EACbgU,qBAAqB,EACrBC,qBAAqB,EACrBC,UAAU,GAId,SAASjC,QAASpB,EAAQ5O,EAAKkP,GAC7BA,EAAS1L,KAAO0L,EAAS1L,MAAQ4N,aAGjC,IACIc,EADAC,EAAY,EAEhB,IAAK,IAAIxS,KAAUiP,EAAOlJ,KAExB,IAAuB,KADvBwM,EAAgBvS,EAAOjC,QAAQ,OAG3BiC,EAAOxD,OAAO,EAAG+V,KAAmBlS,EAAI7D,OAAO,EAAG+V,IAC/CvS,EAAOxD,OAAO+V,EAAgB,KAAOlS,EAAI7D,OAAO6D,EAAIzD,OAASoD,EAAOpD,OAAS2V,EAAgB,GAAI,CACtG,IAAIE,EAAQzS,EAAO3D,MAAM,KAAKO,OAClB4V,EAARC,IACFD,EAAYC,GACd/I,WAAW6F,EAAS1L,KAAMoL,EAAOlJ,KAAK/F,GAASwS,IAAcC,GASjE,GAJIxD,EAAOlJ,KAAK1F,IACdqJ,WAAW6F,EAAS1L,KAAMoL,EAAOlJ,KAAK1F,IAAM,GAG1CkP,EAAST,WAAY,CACvB,IAAIyC,EAAUlR,EAAI7D,OAAO+S,EAAST,WAAWlS,OAAS,GAElDmJ,KACJ,GAAIwJ,EAASR,cAAchJ,KAAM,CAC3ByM,EAAY,EAChBE,eAAenD,EAASR,cAAchJ,KAAMwL,EAAS,SAAUoB,EAAaC,EAAWC,GACpEL,EAAbK,IACFL,EAAYK,GACdnJ,WAAW3D,EAAM6M,EAAWC,GAA0BA,EAAZL,KAG5C9I,WAAW6F,EAAS1L,KAAMkC,GAAM,IAI9BwJ,EAASR,cAAc2C,QAAWnC,EAASZ,WAAcY,EAAS1L,KAAKtD,SACzEgP,EAAS1L,KAAK6N,OAASnC,EAAS1L,KAAK6N,QAAUnC,EAASR,cAAc2C,SAI5E,SAAS5B,YAAaV,EAAa/O,GACjC,IAAIyS,EACAnE,EAEAoE,EAAc3D,EAAc/O,EAAItC,QAAQ,KAAOsC,EAAI9D,YAAY,KAEnE,IAAqB,IAAjBwW,EAYJ,OATI3D,GACF0D,EAAczS,EAAI7D,OAAOuW,EAAc,GACvCpE,EAAYtO,EAAI7D,OAAO,EAAGuW,KAG1BD,EAAczS,EAAI7D,OAAO,EAAGuW,GAC5BpE,EAAYtO,EAAI7D,OAAOuW,EAAc,IAAMD,EAAYtW,OAAOsW,EAAYvW,YAAY,KAAO,KAI7F0T,SAAU6C,EACV/C,OAAQpB,GAKZ,SAASwB,mBAAoBf,EAAa0D,EAAanE,GACrD,OAAIS,EACKT,EAAY,IAAMmE,EAElBA,EAAc,IAAMnE,EA8F/B,SAASqE,oBAAqB/D,EAAQgE,EAAKC,EAAQ3B,EAAST,GAE1D,IAAKS,IAAY0B,EAAIE,kBAAoD,MAAhC5B,EAAQA,EAAQ3U,OAAS,IAAckU,EAC9E,OAAOS,EAET,IAAI6B,GAAY,EAgBhB,GAbIH,EAAIlN,MACN2M,eAAeO,EAAIlN,KAAMwL,EAAS,SAAUoB,EAAaC,EAAWC,GAClE,GAAmB,IAAfA,GAAoBF,EAAYpW,YAAY,OAASoW,EAAY/V,OAAS,EAC5E,OAAOwW,GAAY,KAIpBA,GAAanE,EAAOlJ,MACvB2M,eAAezD,EAAOlJ,KAAMmN,EAAS,IAAM3B,EAAS,SAAUoB,EAAaC,EAAWC,GACpF,GAAmB,IAAfA,GAAoBF,EAAYpW,YAAY,OAASoW,EAAY/V,OAAS,EAC5E,OAAOwW,GAAY,IAGrBA,EACF,OAAO7B,EAGT,IAAI4B,EAAmB,IAAMF,EAAIE,iBACjC,OAAI5B,EAAQ/U,OAAO+U,EAAQ3U,OAASuW,EAAiBvW,UAAYuW,EACxD5B,EAAU4B,EAEV5B,EAGX,SAASC,uBAAwBjR,EAAQ0O,EAAQgE,EAAKC,EAAQ3B,EAAShC,EAAUuB,GAE/E,IAAKS,EAAS,CACZ,IAAI0B,EAAII,KAMN,OAAOH,EALP3B,EAAoC,OAA1B0B,EAAII,KAAK7W,OAAO,EAAG,GAAcyW,EAAII,KAAK7W,OAAO,GAAKyW,EAAII,KASxE,GAAIJ,EAAI5R,IAAK,CACX,IAAIiS,EAAU,KAAO/B,EAEjBzF,EAAWC,YAAYkH,EAAI5R,IAAKiS,GAQpC,GALKxH,IACHwH,EAAU,KAAON,oBAAoB/D,EAAQgE,EAAKC,EAAQ3B,EAAST,MACnD,KAAOS,IACrBzF,EAAWC,YAAYkH,EAAI5R,IAAKiS,IAEhCxH,EAAU,CACZ,IAAImF,EAASC,UAAU3Q,EAAQ0O,EAAQgE,EAAKC,EAAQpH,EAAUwH,EAAS/D,EAAUuB,GACjF,GAAIG,EACF,OAAOA,GAKb,OAAOiC,EAAS,IAAMF,oBAAoB/D,EAAQgE,EAAKC,EAAQ3B,EAAST,GAG1E,SAASyC,aAAczH,EAAUmF,EAAQuC,GAGvC,QAAIvC,EAAOzU,OAAO,EAAGsP,EAASlP,UAAYkP,GAAY0H,EAAK5W,OAASkP,EAASlP,QAM/E,SAASsU,UAAW3Q,EAAQ0O,EAAQgE,EAAKC,EAAQpH,EAAU0H,EAAMjE,EAAUuB,GAC3C,MAA1B0C,EAAKA,EAAK5W,OAAS,KACrB4W,EAAOA,EAAKhX,OAAO,EAAGgX,EAAK5W,OAAS,IACtC,IAAIqU,EAASgC,EAAI5R,IAAIyK,GAErB,GAAsB,iBAAXmF,EACT,MAAM,IAAInU,MAAM,wEAA0EgP,EAAW,OAASoH,GAEhH,GAAKK,aAAazH,EAAUmF,EAAQuC,IAA2B,iBAAXvC,EAGpD,OAAOR,mBAAmB/O,KAAKnB,EAAQ0O,EAAQgC,EAASuC,EAAKhX,OAAOsP,EAASlP,QAASsW,EAAS,IAAK3D,EAAUA,EAAUuB,GAG1H,SAASgB,mBAAoBvR,EAAQ0O,EAAQgE,EAAKC,EAAQ3B,EAAShC,EAAUuB,GAE3E,IAAKS,EAAS,CACZ,IAAI0B,EAAII,KAMN,OAAOvU,QAAQC,QAAQmU,GALvB3B,EAAoC,OAA1B0B,EAAII,KAAK7W,OAAO,EAAG,GAAcyW,EAAII,KAAK7W,OAAO,GAAKyW,EAAII,KASxE,IAAIC,EAASxH,EAcb,OAZImH,EAAI5R,MACNiS,EAAU,KAAO/B,GACjBzF,EAAWC,YAAYkH,EAAI5R,IAAKiS,MAI9BA,EAAU,KAAON,oBAAoB/D,EAAQgE,EAAKC,EAAQ3B,EAAST,MACnD,KAAOS,IACrBzF,EAAWC,YAAYkH,EAAI5R,IAAKiS,MAI9BxH,EAAW4E,MAAMnQ,EAAQ0O,EAAQgE,EAAKC,EAAQpH,EAAUwH,EAAS/D,EAAUuB,GAAkBjS,mBACpG2B,KAAK,SAAUyQ,GACd,OAAIA,EACKnS,QAAQC,QAAQkS,GAGlBnS,QAAQC,QAAQmU,EAAS,IAAMF,oBAAoB/D,EAAQgE,EAAKC,EAAQ3B,EAAST,MAI5F,SAASJ,MAAOnQ,EAAQ0O,EAAQgE,EAAKC,EAAQpH,EAAU0H,EAAMjE,EAAUuB,GACvC,MAA1B0C,EAAKA,EAAK5W,OAAS,KACrB4W,EAAOA,EAAKhX,OAAO,EAAGgX,EAAK5W,OAAS,IAEtC,IAAIqU,EAASgC,EAAI5R,IAAIyK,GAErB,GAAsB,iBAAXmF,EACT,OAAKsC,aAAazH,EAAUmF,EAAQuC,GAE7BxD,eAAetO,KAAKnB,EAAQ0O,EAAQgC,EAASuC,EAAKhX,OAAOsP,EAASlP,QAASsW,EAAS,IAAK3D,EAAUA,EAAUuB,GACnHtQ,KAAK,SAAU0P,GACd,OAAOE,uBAAuB1O,KAAKnB,EAAQ2P,EAAYgD,EAAS,IAAK3D,KAH9D1Q,kBAYX,IAAI4U,KACAC,KACJ,IAAK,IAAI1M,KAAKiK,EAAQ,CACpB,IAAI0C,EAAIjE,eAAe1I,GACvB0M,EAAWhV,MACTkV,UAAWD,EACXtS,IAAK4P,EAAOjK,KAEdyM,EAAkB/U,KAAK2D,eAAenC,UAAUE,OAAOsB,KAAKnB,EAAQoT,EAAE3T,OAAQkT,IAIhF,OAAOpU,QAAQwG,IAAImO,GAClBjT,KAAK,SAAUqT,GAEd,IAAK,IAAIrV,EAAI,EAAGA,EAAIkV,EAAW9W,OAAQ4B,IAAK,CAC1C,IAAImV,EAAID,EAAWlV,GAAGoV,UAClBnU,EAAQiM,qBAAqBiI,EAAEG,KAAM,iBAAkBD,EAAgBrV,GAAKqV,EAAgBrV,GAAG4F,aAAeyP,EAAgBrV,IAClI,IAAKmV,EAAEI,QAAUtU,GAASkU,EAAEI,SAAWtU,EACrC,OAAOiU,EAAWlV,GAAG6C,OAG1Bb,KAAK,SAAUyQ,GACd,GAAIA,EACF,OAAKsC,aAAazH,EAAUmF,EAAQuC,GAE7BxD,eAAetO,KAAKnB,EAAQ0O,EAAQgC,EAASuC,EAAKhX,OAAOsP,EAASlP,QAASsW,EAAS,IAAK3D,EAAUA,EAAUuB,GACnHtQ,KAAK,SAAU0P,GACd,OAAOE,uBAAuB1O,KAAKnB,EAAQ2P,EAAYgD,EAAS,IAAK3D,KAH9D1Q,oBAaf,IAAImV,sBAGJ,SAASC,uBAAwBT,GAC/B,IAAIU,EAAeV,EAAKjX,YAAY,KAChCK,EAASuX,KAAKC,IAAIF,EAAe,EAAGV,EAAKjX,YAAY,MACzD,OACEK,OAAQA,EACRyX,MAAO,IAAIC,OAAO,KAAOd,EAAKhX,OAAO,EAAGI,GAAQD,QAAQ,qBAAsB,QAAQA,QAAQ,MAAO,WAAa,YAClH4X,UAA4B,IAAlBL,GAKd,SAAS9C,sBAAuBnC,EAAQiB,GAEtC,IADA,IAAIgD,EAA4BrB,EAApB2C,GAAa,EAChBhW,EAAI,EAAGA,EAAIyQ,EAAO+E,mBAAmBpX,OAAQ4B,IAAK,CACzD,IAAIiW,EAAoBxF,EAAO+E,mBAAmBxV,GAC9CwG,EAAIgP,mBAAmBS,KAAuBT,mBAAmBS,GAAqBR,uBAAuBQ,IACjH,KAAIvE,EAAWtT,OAASoI,EAAEpI,QAA1B,CAEA,IAAIpB,EAAQ0U,EAAW1U,MAAMwJ,EAAEqP,QAC3B7Y,GAAW0X,IAAasB,GAAcxP,EAAEuP,YAAarB,EAAOtW,OAASpB,EAAM,GAAGoB,WAChFsW,EAAS1X,EAAM,GACfgZ,GAAcxP,EAAEuP,SAChB1C,EAAaqB,EAASuB,EAAkBjY,OAAOwI,EAAEpI,UAIrD,GAAKsW,EAGL,OACEpE,WAAYoE,EACZrB,WAAYA,GAIhB,SAASD,sBAAuBrR,EAAQ0O,EAAQyF,EAAenF,EAAUW,GACvE,IAAIyE,EAAepU,EAAOqU,cAAgBrU,EAO1C,OAHyD,IAArD0O,EAAOoC,kBAAkBtT,QAAQ2W,IACnCzF,EAAOoC,kBAAkB3S,KAAKgW,GAEzBC,EAAavU,OAAOsU,GAC1BlU,KAAK,SAAUqU,GACdC,aAAavF,EAASR,cAAe8F,EAAWtF,EAAST,YAAY,EAAMG,GAC3EM,EAASR,cAAc4C,YAAa,IAErCjR,MAAM,SAAUvD,GACf,MAAMwD,kDAAWxD,EAAK,8CAAgDuX,KAI1E,SAAShC,eAAgBqC,EAASxD,EAASyD,GAEzC,IAAIzC,EACJ,IAAK,IAAIvS,KAAU+U,EAAS,CAE1B,IAAIE,EAAiC,OAAxBjV,EAAOxD,OAAO,EAAG,GAAc,KAAO,GAKnD,GAJIyY,IACFjV,EAASA,EAAOxD,OAAO,KAGF,KADvB+V,EAAgBvS,EAAOjC,QAAQ,OAI3BiC,EAAOxD,OAAO,EAAG+V,KAAmBhB,EAAQ/U,OAAO,EAAG+V,IACnDvS,EAAOxD,OAAO+V,EAAgB,KAAOhB,EAAQ/U,OAAO+U,EAAQ3U,OAASoD,EAAOpD,OAAS2V,EAAgB,IAEtGyC,EAAQhV,EAAQ+U,EAAQE,EAASjV,GAASA,EAAO3D,MAAM,KAAKO,QAC9D,OAIN,IAAIsY,EAAYH,EAAQxD,IAAYjS,OAAOmC,eAAeC,KAAKqT,EAASxD,GAAWwD,EAAQxD,GAAWwD,EAAQ,KAAOxD,GACjH2D,GACFF,EAAQE,EAAWA,EAAW,GA4ClC,IAAIC,eAAiB,UAAW,OAAQ,MAAO,QAAS,aAAc,WAEtE,SAASzF,eAAgBkE,GACvB,IAAIwB,EAAiBC,EAEjBC,EACAC,EAAuB3B,EAAUrX,YAAY,KAoBjD,OAnB8B,IAA1BgZ,GACFH,EAAkBxB,EAAUpX,OAAO+Y,EAAuB,GAC1DF,EAAkBzB,EAAUpX,OAAO,EAAG+Y,GAEX,MAAvBH,EAAgB,KAClBE,GAAW,EACXF,EAAkBA,EAAgB5Y,OAAO,MAI3C8Y,EAA4B,MAAjB1B,EAAU,GACrBwB,EAAkB,UAClBC,EAAkBzB,EAAUpX,OAAO8Y,IACa,IAA5CH,cAAcpX,QAAQsX,KACxBD,EAAkBC,EAClBA,EAAkB,QAKpBrV,OAAQqV,GAAmB,cAC3BvB,KAAMsB,EACNrB,OAAQuB,GAIZ,SAAS3F,iBAAkBF,EAAc7L,EAAW4R,GAElD,OAAOnT,eAAenC,UAAUE,OAAOsB,KAAK9B,KAAM6P,EAAazP,OAAQ4D,GACtEpD,KAAK,SAAUoT,GACd,IAAIpM,EAAIkE,qBAAqB+D,EAAaqE,KAAMF,GAEhD,GAAI4B,GAAqB,kBAANhO,EACjB,MAAM,IAAI9K,UAAU,2CAEtB,OAAO+S,EAAasE,QAAUvM,EAAIA,IAItC,IAAIiO,mBAAqB,cACzB,SAASrF,uBAAwB/P,EAAKuD,EAAWuL,GAE/C,IAAIuG,EAAmBrV,EAAI7E,MAAMia,oBAEjC,IAAKC,EACH,OAAO5W,QAAQC,QAAQsB,GAEzB,IAAIoP,EAAeC,eAAehO,KAAK9B,KAAM8V,EAAiB,GAAGlZ,OAAO,EAAGkZ,EAAiB,GAAG9Y,OAAS,IAUxG,OAAO+S,iBAAiBjO,KAAK9B,KAAM6P,EAAc7L,GAAW,GAC3DpD,KAAK,SAAUoP,GACd,GAA8B,iBAAnBA,EACT,MAAM,IAAIlT,UAAU,2BAA6B2D,EAAM,iCAEzD,IAAqC,IAAjCuP,EAAe7R,QAAQ,KACzB,MAAM,IAAIrB,UAAU,sCAAwC2D,GAAOuD,EAAY,OAASA,EAAY,IAAM,2BAA6BgM,EAAiB,oCAE1J,OAAOvP,EAAI1D,QAAQ8Y,mBAAoB7F,KC5zB3C,IAAI+F,gBAAkB,gBAAiB,aAAc,YAAa,cAAe,oBACjF,SAASC,OAAOrV,EAAQsV,EAAKC,GAC3B,IAAK,IAAItX,EAAI,EAAGA,EAAImX,eAAe/Y,OAAQ4B,IAAK,CAC9C,IAAIuX,EAAYJ,eAAenX,GAC3BqX,EAAIE,IAAcC,UAAUD,EAAUvZ,OAAO,EAAGuZ,EAAUnZ,OAAS,KACrEkZ,EAAYD,EAAIE,KAItB,SAASE,SAAUC,EAAKC,GACtB,IAAIC,KACJ,IAAK,IAAIpR,KAAKkR,EAAK,CACjB,IAAIpC,EAAOoC,EAAIlR,GACA,EAAXmR,EACErC,aAAgBzO,MAClB+Q,EAAMpR,MAAQ6E,OAAOiK,GACE,iBAATA,EACdsC,EAAMpR,GAAKiR,SAASnC,EAAMqC,EAAW,GACxB,kBAANnR,IACPoR,EAAMpR,GAAK8O,GAGbsC,EAAMpR,GAAK8O,EAGf,OAAOsC,EAGF,SAASC,cAAepH,EAAQjK,GACrC,IAAIsR,EAAUrH,EAAOjK,GAGrB,OAAIsR,aAAmBjR,MACd4J,EAAOjK,GAAG6E,WACS,iBAAZyM,EACPL,SAASK,EAAS,GAElBrH,EAAOjK,GAGX,SAASuR,UAAWC,GACzB,GAAIA,EAAY,CACd,IAAyC,IAArCC,YAAY1Y,QAAQyY,GACtB,OAAOH,cAAczW,KAAK8H,QAAS8O,GACrC,MAAM,IAAI1Z,MAAM,IAAM0Z,EAAa,uDAAyDC,YAAY7X,KAAK,MAAQ,KAIvH,IADA,IAAIiX,KACKrX,EAAI,EAAGA,EAAIiY,YAAY7Z,OAAQ4B,IAAK,CAC3C,IAAIwG,EAAIyR,YAAYjY,GAChBkY,EAAaL,cAAczW,KAAK8H,QAAS1C,QAC1B5G,IAAfsY,IACFb,EAAI7Q,GAAK0R,GAEb,OAAOb,EAGF,SAASc,UAAWd,EAAKe,GAC9B,IAeM5N,EAfFzI,EAASX,KACTqP,EAASrP,KAAK8H,QAWlB,GATI,aAAcmO,IAChB5G,EAAO/G,SAAW2N,EAAI3N,UAEpB,SAAU2N,IACZ5G,EAAO4H,KAA8B,oBAAhBrO,aAA+BqN,EAAIgB,OAEtD,eAAgBhB,GAAO,UAAWA,IACpCiB,cAAcpV,KAAKnB,IAAUsV,EAAIkB,cAAelB,EAAImB,OAAShB,WAAaA,UAAUgB,SAEjFJ,EAwBH,IAAK,IAAI5R,KApBT4Q,OAAOrV,EAAQsV,EAAK,SAASA,GAC3B7M,EAAUA,GAAW6M,EAAI7M,WAE3BA,EAAUA,GAAW6M,EAAI7M,WAIvBiG,EAAOjG,QAAUpL,kBAAkBoL,EAASlN,UAAY8B,kBAAkB,KAAOoL,EAASlN,SACxC,MAA9CmT,EAAOjG,QAAQiG,EAAOjG,QAAQpM,OAAS,KACzCqS,EAAOjG,SAAW,MAGlB6M,EAAIzM,OACNE,OAAO2F,EAAO7F,MAAOyM,EAAIzM,OAE3BwM,OAAOrV,EAAQsV,EAAK,SAASA,GACvBA,EAAIzM,OACNE,OAAO2F,EAAO7F,MAAOyM,EAAIzM,SAGf6F,EAAO7F,OACmB,IAAlC6F,EAAO7F,MAAMpE,GAAGjH,QAAQ,OAE5BgK,KAAKrG,KAAKuN,EAAQ,eAAiBjK,EAAI,OAASiK,EAAO7F,MAAMpE,GAAK,+DAC3DiK,EAAO7F,MAAMpE,IAUxB,GANI6Q,EAAIoB,qBACNlP,KAAKrG,KAAKuN,EAAQ,yGAAyG,GAE9F,kBAApB4G,EAAIzG,cACbH,EAAOG,YAAcyG,EAAIzG,aAEvByG,EAAIxU,IACN,IAAK,IAAI2D,KAAK6Q,EAAIxU,IAAK,CACrB,IAAI6V,EAAIrB,EAAIxU,IAAI2D,GAEhB,GAAiB,iBAANkS,EAAgB,CACzB,IAAIjG,EAASV,YAAY7O,KAAKnB,EAAQ0O,EAAQiI,OAAG9Y,GAAW,GAAO,GAClC,MAA7B6S,EAAOA,EAAOrU,OAAQ,IAAkC,MAApBoI,EAAEA,EAAEpI,OAAS,IAAkC,MAApBoI,EAAEA,EAAEpI,OAAS,KAC9EqU,EAASA,EAAOzU,OAAO,EAAGyU,EAAOrU,OAAS,IAC5CqS,EAAO5N,IAAI2D,GAAKiM,MAIb,CAEHkG,GADIA,EAAU5G,YAAY7O,KAAKnB,EAAQ0O,EAA4B,MAApBjK,EAAEA,EAAEpI,OAAS,GAAaoI,EAAI,IAAMA,OAAG5G,GAAW,GAAM,IACrF5B,OAAO,EAAG2a,EAAQva,OAAS,GAE7C,IAAIqW,EAAMhE,EAAOI,SAAS8H,GACrBlE,KACHA,EAAMhE,EAAOI,SAAS8H,GAAW7F,iBAE7B6B,iBAAmB,IAEzB2B,aAAa7B,GAAO5R,IAAK6V,GAAKC,GAAS,EAAOlI,IAKpD,GAAI4G,EAAI7B,mBAAoB,CAE1B,IADA,IAAIA,KACKxV,EAAI,EAAGA,EAAIqX,EAAI7B,mBAAmBpX,OAAQ4B,IAAK,CACtD,IAAIgV,EAAOqC,EAAI7B,mBAAmBxV,GAC9B4Y,EAAgBjD,KAAKC,IAAIZ,EAAKjX,YAAY,KAAO,EAAGiX,EAAKjX,YAAY,MACrE2T,EAAaK,YAAY7O,KAAKnB,EAAQ0O,EAAQuE,EAAKhX,OAAO,EAAG4a,QAAgBhZ,GAAW,GAAO,GACnG4V,EAAmBxV,GAAK0R,EAAasD,EAAKhX,OAAO4a,GAEnDnI,EAAO+E,mBAAqBA,EAG9B,GAAI6B,EAAIwB,QACN,IAAK,IAAIrS,KAAK6Q,EAAIwB,QAAS,CACzB,IAAIC,KACJ,IAAS9Y,EAAI,EAAGA,EAAIqX,EAAIwB,QAAQrS,GAAGpI,OAAQ4B,IACzC8Y,EAAO5Y,KAAK6B,EAAOiQ,cAAcqF,EAAIwB,QAAQrS,GAAGxG,KAClDyQ,EAAOoI,QAAQrS,GAAKsS,EAIxB,GAAIzB,EAAIxG,SACN,IAAK,IAAIrK,KAAK6Q,EAAIxG,SAAU,CAC1B,GAAIrK,EAAExJ,MAAM,oBACV,MAAM,IAAIkB,UAAU,IAAMsI,EAAI,kCAEhC,IAAImS,EACJA,GADIA,EAAU5G,YAAY7O,KAAKnB,EAAQ0O,EAA4B,MAApBjK,EAAEA,EAAEpI,OAAS,GAAaoI,EAAI,IAAMA,OAAG5G,GAAW,GAAM,IACrF5B,OAAO,EAAG2a,EAAQva,OAAS,GAE7CkY,aAAa7F,EAAOI,SAAS8H,GAAWlI,EAAOI,SAAS8H,IAAY7F,gBAAiBuE,EAAIxG,SAASrK,GAAImS,GAAS,EAAOlI,GAI1H,GAAI4G,EAAI0B,SACN,IAAK,IAAIvS,KAAK6Q,EAAI0B,SAChBtI,EAAOsI,SAAShX,EAAOiQ,cAAcxL,OAAS6E,OAAOgM,EAAI0B,SAASvS,IAGtE,GAAI6Q,EAAI9P,KACN,IAAK,IAAIf,KAAK6Q,EAAI9P,KAEhB,GAAa,MAATf,EAAE,GACJsE,OAAO2F,EAAOlJ,KAAKf,GAAKiK,EAAOlJ,KAAKf,OAAU6Q,EAAI9P,KAAKf,QAEpD,CACH,IAAIhE,EAAWuP,YAAY7O,KAAKnB,EAAQ0O,EAAQjK,OAAG5G,GAAW,GAAM,GACpEkL,OAAO2F,EAAOlJ,KAAK/E,GAAYiO,EAAOlJ,KAAK/E,OAAiB6U,EAAI9P,KAAKf,IAU3E,IAAK,IAAI2O,IALL,eAAgBkC,IAClB5G,EAAOuI,WAAa3B,EAAI2B,YAIZ3B,GACoB,IAA5BY,YAAY1Y,QAAQ4V,KAEW,IAA/BgC,eAAe5X,QAAQ4V,KAI3BpT,EAAOoT,GAAKkC,EAAIlC,IAGlBiC,OAAOrV,EAAQsV,EAAK,SAASA,GAC3BtV,EAAO0O,OAAO4G,GAAK,KAIhB,SAASvE,gBACd,OACE6B,sBAAkB/U,EAClBiV,UAAMjV,EACNsT,YAAQtT,EACR2H,UAAM3H,EACNiD,SAAKjD,EACL2Q,mBAAe3Q,EACfuT,YAAY,GAKT,SAASmD,aAAc7B,EAAK4C,EAAKsB,EAASM,EAAexI,GAC9D,IAAK,IAAI6E,KAAQ+B,EACF,SAAT/B,GAA4B,WAATA,GAA8B,qBAATA,GAAwC,eAATA,EACpE2D,QAA+BrZ,IAAd6U,EAAIa,KACxBb,EAAIa,GAAQ+B,EAAI/B,IAEF,QAATA,GACN2D,EAAgBhO,QAAUH,QAAQ2J,EAAI5R,IAAM4R,EAAI5R,QAAWwU,EAAIxU,KAEhD,SAATyS,GACN2D,EAAgBhO,QAAUH,QAAQ2J,EAAIlN,KAAOkN,EAAIlN,SAAY8P,EAAI9P,MAE3DzG,OAAOmC,eAAeC,KAAKmU,EAAK/B,IACvC/L,KAAKrG,KAAKuN,EAAQ,IAAM6E,EAAO,4DAA8DqD,GAoBjG,YAf6B/Y,IAAzB6U,EAAIE,mBACNF,EAAIE,iBAAmB,WAER/U,IAAb6U,EAAII,MAAsBJ,EAAI5R,KAAO4R,EAAI5R,IAAI,MAC/C4R,EAAII,KAAOJ,EAAI5R,IAAI,YACZ4R,EAAI5R,IAAI,MAGY,iBAAb4R,EAAII,OAClBJ,EAAI5R,IAAM4R,EAAI5R,QACd4R,EAAI5R,IAAI,WAAa4R,EAAII,KACzBJ,EAAII,KAAc,QAAIJ,EAAII,KAAc,SAAK,KAC7CJ,EAAII,KAAO,SAGNJ,EC/RT,IAAIyE,UAA8B,oBAAXC,OACvB,IACMD,WAAoD,SAAvC,IAAIC,OAAO,KAAKlQ,SAAS,YACxCiQ,WAAY,GAEhB,MAAO1Q,GACL0Q,WAAY,EAGd,IAAIE,gBAAkB,uDA8BlBxN,KA2BAyN,GACAC,MAEAC,UA3DJ,SAASC,gBAAiBC,GACxB,OAAIP,UACKE,gBAAkB,IAAID,OAAOM,GAAiBxQ,SAAS,UACvC,oBAATyQ,KACPN,gBAAkBM,KAAKC,SAASC,mBAAmBH,KAEnD,GAGX,SAASI,UAAUC,EAAQpG,EAAWqG,EAASC,GAC7C,IAAIC,EAAgBH,EAAO/b,YAAY,MAEvC,GAAI2V,EAAW,CACb,GAAwB,iBAAbA,EACT,MAAM,IAAIxV,UAAU,qDAEtBwV,EAAYwG,KAAKC,UAAUzG,GAG7B,OAAQsG,EAAO,gCAAkC,IAAMF,GAAUE,EAAO,wBAA0B,KAEvD,oBAApCF,EAAO9b,OAAOic,EAAe,IAC5B,mBAAqBF,GAAWrG,EAAY,cAAgB,IAAM,KAEnEA,GAAa8F,gBAAgB9F,IAAc,IAMpD,SAAS0G,WAAWrY,EAAQ+X,EAAQpG,EAAWqG,EAAStG,GACjD7H,OACHA,KAAOnP,SAASmP,MAAQnP,SAAS4d,MAAQ5d,SAAS6d,iBAEpD,IAAI7N,EAAShQ,SAASgP,cAAc,UACpCgB,EAAOoC,KAAOgL,UAAUC,EAAQpG,EAAWqG,GAAS,GACpD,IACIvR,EADA2D,EAAU3P,OAAO2P,QAgBrB,GAdA3P,OAAO2P,QAAU,SAASoO,GACxB/R,EAAIrG,WAAWoY,EAAI,cAAgBR,GAC/B5N,GACFA,EAAQC,MAAMhL,KAAMiL,YAExBmO,QAAQzY,GAEJ0R,GACFhH,EAAOgO,aAAa,QAAShH,GAE/B7H,KAAKC,YAAYY,GACjBb,KAAKiB,YAAYJ,GACjBiO,WACAle,OAAO2P,QAAUA,EACb3D,EACF,OAAOA,EAQX,IAAImS,YAAc,EAClB,SAASH,QAASzY,GACK,GAAjB4Y,gBACFpB,UAAYpc,UAAOyd,QACrBzd,UAAOyd,OAASzd,UAAO0d,SAAW9Y,EAEpC,SAAS2Y,WACc,KAAfC,cACJxd,UAAOyd,OAASzd,UAAO0d,SAAWtB,WAGtC,IAAIuB,oBAAqB,ECgFrBC,aD1EG,SAASC,SAAUjZ,OAAQ+X,OAAQpG,UAAWqG,QAASvN,UAAWiH,MAAOwH,QAC9E,GAAKnB,OAAL,CAEA,GAAIrG,OAASqH,mBACX,OAAOV,WAAWrY,OAAQ+X,OAAQpG,UAAWqG,QAAStG,OACxD,IACE+G,QAAQzY,SAEHsX,IAAMtX,OAAO0I,eAChB4O,GAAKtX,OAAO0I,aAAa,MACzB6O,MAAQD,GAAG6B,iBAAiB,6CAA+CnZ,QAEzEuX,MACFD,GAAG6B,iBAAiBrB,UAAUC,OAAQpG,UAAWqG,SAAUkB,SAAWE,SAAUpB,SAAWrG,UAAY,cAAgB,MAEvH,KAAUmG,UAAUC,OAAQpG,UAAWqG,SAAUkB,SACnDP,WAEF,MAAOlS,GAEL,OADAkS,WACOlS,IC3GJ,SAAS4S,WAAYrZ,GAC1BA,EAAOe,IAAI,gBAAiBf,EAAOsZ,WACjCC,eAAgBA,eAAeC,KAAKxZ,GACpCyZ,YAAaA,eAGfzZ,EAAOe,IAAI,mBAAoBf,EAAOsZ,WACpCI,cAAeA,iBAIZ,SAASC,aAAc3Z,GAM5B,SAASgG,EAAS4T,EAAOC,EAAUC,EAASC,GAE1C,GAAqB,iBAAVH,KAAwBA,aAAiB9U,OAClD,OAAOkB,EAAQqE,MAAM,KAAMvF,MAAMnF,UAAUqa,OAAO7Y,KAAKmJ,UAAW,EAAGA,UAAUjO,OAAS,IAK1F,GAFqB,iBAAVud,GAA0C,mBAAbC,IACtCD,GAASA,MACPA,aAAiB9U,OAWhB,CAAA,GAAqB,iBAAV8U,EAAoB,CAClC,IAAIjK,EAAa3P,EAAO+P,eAAe6J,EAAOG,GAC1Cta,EAASO,EAAOU,IAAIiP,GACxB,IAAKlQ,EACH,MAAM,IAAIlD,MAAM,sCAAwCqd,EAAQ,QAAUjK,GAAcoK,EAAU,UAAYA,EAAU,KAAO,MACjI,MAAO,iBAAkBta,EAASA,EAAOoE,aAAepE,EAIxD,MAAM,IAAItD,UAAU,mBAlBpB,IADA,IAAI8d,KACKhc,EAAI,EAAGA,EAAI2b,EAAMvd,OAAQ4B,IAChCgc,EAAgB9b,KAAK6B,EAAOH,OAAO+Z,EAAM3b,GAAI8b,IAC/Cxb,QAAQwG,IAAIkV,GAAiBha,KAAK,SAAUia,GACtCL,GACFA,EAASxP,MAAM,KAAM6P,IACtBJ,GAgBP,SAASK,EAAQ1e,EAAMyI,EAAMkW,GAaf,IAAWA,EAYnBC,EAAcC,EAAcC,EAkBhC,SAASxX,EAASyX,EAAK7V,EAASlF,GAE9B,IADA,IAAIgb,KACKxc,EAAI,EAAGA,EAAIiG,EAAK7H,OAAQ4B,IAC/Bwc,EAAUtc,KAAKqc,EAAItW,EAAKjG,KAa1B,GAXAwB,EAAOib,IAAMjb,EAAO8F,GAEpB9F,EAAOiP,OAAS/H,MAGK,IAAjB4T,GACFE,EAAUT,OAAOO,EAAa,EAAG9a,IAEb,IAAlB6a,GACFG,EAAUT,OAAOM,EAAc,EAAG3V,IAEd,IAAlB0V,EAAqB,CACvB,IAAIM,EAAoB,SAAUf,EAAOC,EAAUC,GACjD,MAAqB,iBAAVF,GAA0C,mBAAbC,EAC/BW,EAAIZ,GACN5T,EAAQ7E,KAAKnB,EAAQ4Z,EAAOC,EAAUC,EAASra,EAAO8F,KAE/DoV,EAAkBC,MAAQ,SAAUnf,GAClC,OAAOuE,EAAOiQ,cAAcxU,EAAMgE,EAAO8F,KAE3CkV,EAAUT,OAAOK,EAAc,EAAGM,GAIpC,IAAIE,EAAazf,UAAO4K,QACxB5K,UAAO4K,QAAUA,EAEjB,IAAIjI,EAASqc,EAAQ/P,OAAwB,IAAlBiQ,EAAsBlf,UAASuJ,EAAS8V,GAEnErf,UAAO4K,QAAU6U,OAEK,IAAX9c,IACT0B,EAAOkF,QAAU5G,GA/ED,iBAATtC,IACT2e,EAAUlW,EACVA,EAAOzI,EACPA,EAAO,MAGHyI,aAAgBY,QAEpBZ,GAAQ,UAAW,UAAW,UAAU8V,OAAO,GAD/CI,EAAUlW,GACgD7H,SAGrC,mBAAZ+d,IACYA,EAElBA,EAFHA,EACS,WAAa,OAAOA,IAG1B3e,GACCqf,cACF5W,EAAOA,EAAKoF,OAAOwR,aACnBA,iBAAcjd,IAOgC,KAA7Cwc,EAAenW,EAAK1G,QAAQ,cAE/B0G,EAAK8V,OAAOK,EAAc,GAIrB5e,IACHyI,EAAOA,EAAKoF,OAAOyR,cAAcX,EAAQlT,WAAYmT,OAGP,KAA7CC,EAAepW,EAAK1G,QAAQ,aAC/B0G,EAAK8V,OAAOM,EAAc,IAEoB,KAA3CC,EAAcrW,EAAK1G,QAAQ,YAC9B0G,EAAK8V,OAAOO,EAAa,GA2CtB9e,GAIHuE,EAAOuG,gBAAgB9K,EAAMyI,GAAM,EAAOnB,GAStCiY,gBAEFC,uBADAD,qBAAkBnd,GAGVod,uBACRD,iBAAmB9W,EAAMnB,KAjB3B/C,EAAOuG,gBAAgBrC,GAAM,EAAOgX,YAAcC,oBAAoBpY,GAAWA,GAqBrFoX,EAAOiB,OAEPpb,EAAOqb,UAAYlB,EACnBna,EAAOsb,WAAatV,EAQtB,SAASuV,YAAYtI,GACnB,MAA0B,aAAtBA,EAAKhX,OAAO,EAAG,GACVgX,EAAKhX,OAAO,IAAMlB,WAEvBie,cAAgB/F,EAAKhX,OAAO,EAAG+c,aAAa3c,UAAY2c,aACnD/F,EAAKhX,OAAO+c,aAAa3c,QAE3B4W,EAGF,SAASsG,eAAgBiC,EAASC,GACvC,OAAOF,YAAYlc,KAAK4Q,cAAcuL,EAASC,IAG1C,SAAShC,YAAaiC,GAE3B,IACItC,EADA5G,EAAckJ,EAAS1f,YAAY,KAOnC2f,GAJFvC,GADmB,IAAjB5G,EACSkJ,EAASzf,OAAO,EAAGuW,GAEnBkJ,GAEU5f,MAAM,KAI7B,OAHA6f,EAAQzd,MACRyd,EAAUA,EAAQtd,KAAK,MAGrB+a,SAAUmC,YAAYnC,GACtBuC,QAASJ,YAAYI,IDhHrBnhB,WAAgC,oBAAZE,UAA2BA,SAASgB,uBACpDjB,OAAOmhB,QAAUnhB,OAAOmhB,OAAOpK,WAAaqK,UAAUC,UAAU7gB,MAAM,eAC1E8d,oBAAqB,IC8EH,oBAAXte,QAA8C,oBAAbC,UAA4BD,OAAOoB,WAC7Emd,aAAend,SAASkgB,SAAW,KAAOlgB,SAASmgB,UAAYngB,SAASogB,KAAO,IAAMpgB,SAASogB,KAAO,KAmCvG,IAAIC,aAAe,oDACfC,YAAc,mEAOX,SAASC,WAAYrE,GAC1BjM,gBAAgBuQ,UAAYH,aAAaG,UAAYF,YAAYE,UAAY,EAE7E,IAEIphB,EAFAiJ,KAKAoY,KAAsBC,KAE1B,SAASC,EAAYC,EAAWxhB,GAC9B,IAAK,IAAIgD,EAAI,EAAGA,EAAIwe,EAAUpgB,OAAQ4B,IACpC,GAAIwe,EAAUxe,GAAG,GAAKhD,EAAMyhB,OAASD,EAAUxe,GAAG,GAAKhD,EAAMyhB,MAC3D,OAAO,EACX,OAAO,EAGT,GAAI3E,EAAO1b,OAAS0b,EAAOjc,MAAM,MAAMO,OAAS,IAAK,CACnD,KAAOpB,EAAQkhB,YAAYQ,KAAK5E,IAC9BuE,EAAgBne,MAAMlD,EAAMyhB,MAAOzhB,EAAMyhB,MAAQzhB,EAAM,GAAGoB,SAI5D,KAAOpB,EAAQihB,aAAaS,KAAK5E,IAE1ByE,EAAWF,EAAiBrhB,IAC/BshB,EAAiBpe,MAAMlD,EAAMyhB,MAAQzhB,EAAM,GAAGoB,OAAQpB,EAAMyhB,MAAQzhB,EAAM,GAAGoB,OAAS,IAI5F,KAAOpB,EAAQ6Q,gBAAgB6Q,KAAK5E,IAElC,IAAKyE,EAAWF,EAAiBrhB,KAAWuhB,EAAWD,EAAkBthB,GAAQ,CAC/E,IAAI2hB,EAAM3hB,EAAM,GAAGgB,OAAO,EAAGhB,EAAM,GAAGoB,OAAS,GAE/C,GAAIugB,EAAI3hB,MAAM,OACZ,SACFiJ,EAAK/F,KAAKye,GAId,OAAO1Y,EAKT,IAAI2Y,oBAAsB,KAAM,iBAAkB,eAAgB,gBAAiB,SAAU,eAAgB,WAC3G,wBAAyB,gBAAiB,oBAAqB,kBAAmB,kBAAmB,mBAEnGC,eACG,SAASC,eAAgBC,GAC9B,IAAgD,IAA5CH,mBAAmBrf,QAAQwf,GAA/B,CAEA,IACE,IAAI9d,EAAQ9D,UAAO4hB,GAErB,MAAOvW,GACLoW,mBAAmB1e,KAAK6e,GAE1B3d,KAAK2d,EAAY9d,IAGZ,SAAS+d,eAAgBtY,GAC9B,GAAuB,iBAAZA,EACT,OAAOwG,qBAAqBxG,EAASvJ,WAEvC,KAAMuJ,aAAmBG,OACvB,MAAM,IAAIvI,MAAM,6CAGlB,IADA,IAAI2gB,KACKjf,EAAI,EAAGA,EAAI0G,EAAQtI,OAAQ4B,IAClCif,EAAYvY,EAAQ1G,GAAGnC,MAAM,KAAKoC,OAASiN,qBAAqBxG,EAAQ1G,GAAI7C,WAC9E,OAAO8hB,EAGF,SAASxD,cAAeyD,EAAYxY,EAAS8M,EAAS2L,GAE3D,IAKIC,EALAC,EAAYliB,UAAO+e,OAMvB,GAJA/e,UAAO+e,YAAStc,EAIZ4T,EAEF,IAAK,IAAI8L,KADTF,KACc5L,EACZ4L,EAAWE,GAAKniB,UAAOmiB,GACvBniB,UAAOmiB,GAAK9L,EAAQ8L,GAcxB,OATK5Y,IACHmY,kBAEA/d,OAAOD,KAAK1D,WAAQoG,QAAQub,eAAgB,SAAUthB,EAAMyD,GAC1D4d,eAAerhB,GAAQyD,KAKpB,WACL,IAEIse,EAFAN,EAAcvY,EAAUsY,eAAetY,MAGvC8Y,IAAoB9Y,EA6BxB,GA3BKA,IAAWyY,GACdre,OAAOD,KAAK1D,WAAQoG,QAAQub,eAAgB,SAAUthB,EAAMyD,GACtD4d,eAAerhB,KAAUyD,QAEfrB,IAAVqB,IAIAke,IACFhiB,UAAOK,QAAQoC,GAEZ8G,IACHuY,EAAYzhB,GAAQyD,OAECrB,IAAjB2f,EACGC,GAAmBD,IAAiBte,IACvCue,GAAkB,GAGpBD,EAAete,MAKvBge,EAAcO,EAAkBP,EAAcM,EAG1CH,EACF,IAAK,IAAIE,KAAKF,EACZjiB,UAAOmiB,GAAKF,EAAWE,GAI3B,OAFAniB,UAAO+e,OAASmD,EAETJ,GAKX,IAAIQ,cAAgB,kCAChBC,eAAiB,6CACjBC,eAAiB,eACjBC,QAAU,aAEVC,iBAEJ,SAAS/C,cAAchD,EAAQsC,GAM7B,IACI0D,IAJJhG,EAASA,EAAO3b,QAAQ8f,aAAc,KAGlBjhB,MAAM2iB,gBACC,GAAG9hB,MAAM,KAAKue,IAAiB,WAAWje,QAAQyhB,QAAS,IAGlFG,EAAeF,cAAcC,KAAkBD,cAAcC,GAAgB,IAAIhK,OAAO2J,cAAgBK,EAAeJ,eAAgB,MAE3IK,EAAa3B,UAAY,EAKzB,IAHA,IAEIphB,EAFAiJ,KAGGjJ,EAAQ+iB,EAAarB,KAAK5E,IAC/B7T,EAAK/F,KAAKlD,EAAM,IAAMA,EAAM,IAE9B,OAAOiJ,EAGT,SAASiX,oBAAqBpY,GAC5B,OAAO,SAAUiD,EAASrB,EAASlF,GACjCsD,EAAQiD,EAASrB,EAASlF,GAEF,iBADxBkF,EAAUlF,EAAOkF,UACsC,mBAAZA,GAA6B,eAAgBA,GACtF5F,OAAOwC,eAAe9B,EAAOkF,QAAS,cACpCzF,OAAO,KAMf,IAAI+b,sBAAuB,EACvBD,gBACAF,YACAI,aAAc,EACX,SAAS+C,gBAAiBC,EAAUnM,GACzC+I,YAAcoD,EACdhD,YAAcnJ,EACdiJ,qBAAkBnd,EAClBod,sBAAuB,EAElB,SAASkD,mBAAoBne,GAC9Bgb,gBACFhb,EAAOuG,gBAAgBuU,YAAcE,gBAAgB,GAAG1R,OAAOwR,aAAeE,gBAAgB,IAC1F,EAAOE,YAAcC,oBAAoBH,gBAAgB,IAAMA,gBAAgB,IAG5EC,sBACPjb,EAAOuG,oBAAoB,EAAOI,MCvZtC,IAAIyX,oBAAsB5jB,WAAa6M,WAAkC,oBAAdwU,WAA6BA,UAAUC,YAAcD,UAAUC,UAAU7gB,MAAM,iBAG/HojB,YAIX,SAASC,gBAAiBtP,EAAUuP,IAC9BvP,EAAS1L,KAAKyO,UAAoC,iBAAhBwM,GAAmD,mBAAhBA,GACnE,eAAgBA,GACpBxf,OAAOwC,eAAegd,EAAa,cACjCrf,OAAO,IAIN,SAASoD,cAAaxC,EAAKsG,GAChC,IAAIpG,EAASX,KACTqP,EAASrP,KAAK8H,QAElB,OAAQqX,uBAAuB9P,EAAQrP,KAAMS,IAAQxB,mBACpD2B,KAAK,WACJ,IAAImG,IAAJ,CAGA,IAAI4I,EAAWhP,EAAOoH,UAAUtH,GAGhC,GAAyB,WAArBA,EAAI7D,OAAO,EAAG,GAAiB,CACjC,IAAK+D,EAAO0I,aACV,MAAM,IAAIvM,UAAU,iBAAmB2D,EAAM,8CAK/C,OAJAE,EAAOuG,oBAAoB,EAAO,WAChC,OAAOiC,eAAerH,KAAKnB,EAAQF,EAAI7D,OAAO,GAAI+D,EAAOyI,gBAE3DrC,IAkBF,OAdI4I,EAAS1L,KAAKiH,YACZyE,EAAS1L,KAAK8K,WAAcgQ,qBAC9BpP,EAAS1L,KAAKiH,YAAa,EAC3B/C,KAAKrG,KAAKuN,EAAQ,iCAAmC5O,EAAM,OAGzB,IAA7BkP,EAAS1L,KAAKiH,aAAyByE,EAAS1L,KAAK8K,WAAagQ,qBAEpEpP,EAAS1L,KAAKY,MAAS8K,EAAS1L,KAAKmO,WACZ,WAAzBzC,EAAS1L,KAAK6N,QAAgD,aAAzBnC,EAAS1L,KAAK6N,QAAkD,WAAzBnC,EAAS1L,KAAK6N,QAAuBnC,EAAS1L,KAAKqB,WAClIqK,EAAS1L,KAAKiH,YAAa,IAI1ByE,EAAS1L,KAAKiH,WAOZ,IAAIhM,QAAQ,SAAUC,EAAS+E,GACpC,GAA6B,QAAzByL,EAAS1L,KAAK6N,QAAoB/V,UAAO+e,SAAWna,EAAOqb,UAC7D,MAAM,IAAI9e,MAAM,4DAA8DygB,WAAa,iCAE7FzS,WAAWzK,EAAKkP,EAAS1L,KAAKkH,YAAawE,EAAS1L,KAAKmH,UAAW,WAClE,IAAKrE,IAAuB,CAC1B4I,EAAS1L,KAAK6N,OAAS,SACvB,IAAI+L,EAAclO,EAAS1L,KAAKqB,SAAWsY,eAAejO,EAAS1L,KAAKqB,SACxE3E,EAAOuG,oBAAoB,EAAO,WAEhC,OADA+X,gBAAgBtP,EAAUkO,GACnBA,IAET9W,IAGF5H,KACC+E,KAtBIkb,iBAAiBze,EAAQF,EAAKkP,GACpC/O,KAAK,WACJ,OAAOye,iBAAiB1e,EAAQF,EAAKkP,EAAU5I,EAAqBsI,EAAO4H,WAuBhFrW,KAAK,SAAUoG,GAEd,cADOrG,EAAOoH,UAAUtH,GACjBuG,IAIX,SAASoY,iBAAkBze,EAAQF,EAAKkP,GACtC,OAAKA,EAASZ,UAGPpO,EAAOH,OAAOmP,EAASZ,WAAWnO,KAAK,SAAUuP,GACtDR,EAASV,aAAekB,EACxBR,EAAS2P,YACPljB,KAAMqE,EACNkY,QAAShJ,EAASX,eAClB0J,YAAQla,EACRmR,SAAUA,EAAS1L,MAErB0L,EAAS1L,KAAKY,KAAO8K,EAAS1L,KAAKY,WAV5B5F,kBAcX,SAASkgB,uBAAwB9P,EAAQ1O,EAAQF,GAE/C,IAAIoE,EACJ,GAAI1J,YAAc0J,EAAOwK,EAAOsI,SAASlX,IACvC,IAAK,IAAI7B,EAAI,EAAGA,EAAIiG,EAAK7H,OAAQ4B,IAC/B+B,EAAO+O,UAAU7K,EAAKjG,GAAI6B,GAAKG,KAAKwJ,mBAEnC,CACH,IAAImV,GAAU,EACd,IAAK,IAAI3V,KAAKyF,EAAOoI,QAAS,CAC5B,IAAS7Y,EAAI,EAAGA,EAAIyQ,EAAOoI,QAAQ7N,GAAG5M,OAAQ4B,IAAK,CACjD,IAAI4gB,EAAYnQ,EAAOoI,QAAQ7N,GAAGhL,GAElC,GAAI4gB,IAAc/e,EAAK,CACrB8e,GAAU,EACV,MAIF,IAAgC,IAA5BC,EAAUrhB,QAAQ,KAAa,CACjC,IAAIshB,EAAQD,EAAU/iB,MAAM,KAC5B,GAAqB,IAAjBgjB,EAAMziB,OAAc,CACtBqS,EAAOoI,QAAQ7N,GAAG+Q,OAAO/b,IAAK,GAC9B,SAGF,GAAI6B,EAAI7D,OAAO,EAAG6iB,EAAM,GAAGziB,UAAYyiB,EAAM,IACzChf,EAAI7D,OAAO6D,EAAIzD,OAASyiB,EAAM,GAAGziB,OAAQyiB,EAAM,GAAGziB,UAAYyiB,EAAM,GAAI,CAC1EF,GAAU,EACV,QAKN,GAAIA,EACF,OAAO5e,EAAOH,OAAOoJ,KAK7B,SAASyV,iBAAkB1e,EAAQF,EAAKkP,EAAU5I,EAAqBkQ,GAIrE,OAHItH,EAAS1L,KAAKqB,UAAYqK,EAAS1L,KAAK6N,SAC1CnC,EAAS1L,KAAK6N,OAAS,UAElB7S,kBAGN2B,KAAK,WACJ,GAAK+O,EAASV,cAAiBU,EAASV,aAAayQ,OAGrD,OAAOxgB,QAAQC,QAAQwQ,EAASV,aAAayQ,OAAO5d,KAAKnB,EAAQgP,EAAS2P,aACzE1e,KAAK,SAAU+X,GACVA,IACFhJ,EAAS2P,WAAW3G,QAAUA,OAKnC/X,KAAK,WACJ,OAAK+O,EAASV,cAGdgI,GAAO,EAEFtH,EAASV,aAAa5B,MAGpBsC,EAASV,aAAa5B,MAAMvL,KAAKnB,EAAQgP,EAAS2P,WAAY,SAAUrb,GAC7E,OAAOoJ,QAAMpJ,EAAK0U,QAAShJ,EAAS1L,KAAK4I,cAAe8C,EAAS1L,KAAKmH,WAAW,KAH1EiC,QAAMsC,EAAS2P,WAAW3G,QAAShJ,EAAS1L,KAAK4I,cAAe8C,EAAS1L,KAAKmH,WAAW,IALzFiC,QAAM5M,EAAKkP,EAAS1L,KAAK4I,cAAe8C,EAAS1L,KAAKmH,UAAW6L,KAY3ErW,KAAK,SAAU+e,GAEd,OAAK1I,GAA2B,iBAAZ0I,EAGbnX,qBAAqB7H,EAAQgf,EAAS5Y,GAC5CnG,KAAK,SAAUgf,GACd,IAAIA,EAAJ,CAMA,IAAIC,EAAe1kB,UAAY,IAAI2kB,YAAY,SAASC,OAAO,IAAIpX,WAAWgX,IAAYA,EAAQ9X,WAClG,OAAOmY,wBAAwBrf,EAAQF,EAAKof,EAAclQ,EAAU5I,MAX7DiZ,wBAAwBrf,EAAQF,EAAKkf,EAAShQ,EAAU5I,KAgBrE,SAASiZ,wBAAyBrf,EAAQF,EAAKiY,EAAQ/I,EAAU5I,GAC/D,OAAO7H,QAAQC,QAAQuZ,GAEtB9X,KAAK,SAAU8X,GAMd,MAL6B,WAAzB/I,EAAS1L,KAAK6N,SAChBnC,EAAS1L,KAAK6N,YAAStT,GAEzByhB,eAAevH,EAAQ/I,GAElBA,EAASV,cAGdU,EAAS2P,WAAW5G,OAASA,EAExB/I,EAASV,aAAaiR,UAGpBhhB,QAAQC,QAAQwQ,EAASV,aAAaiR,UAAUpe,KAAKnB,EAAQgP,EAAS2P,WAAY3P,EAASwQ,YACjGvf,KAAK,SAAUwf,GACd,GAAIzQ,EAAS1L,KAAKqO,UAAW,CAC3B,GAAuC,iBAA5B3C,EAAS1L,KAAKqO,UACvB,MAAM,IAAIpV,MAAM,qDAClBmjB,kBAAkB1Q,EAAS2P,WAAW3G,QAAShJ,EAAS1L,KAAKqO,WAG/D,MAA0B,iBAAf8N,EACFA,EAEAzQ,EAAS2P,WAAW5G,SAbtBA,GALAA,IAqBV9X,KAAK,SAAU8X,GACd,OAAK/I,EAAS1L,KAAK6N,QAAqC,aAA3B4G,EAAO3Z,UAAU,EAAG,GAKpB,aAAzB4Q,EAAS1L,KAAK6N,SAA0BnC,EAAS1L,KAAK6N,QAAUwO,qBAAqB5H,IACvF/I,EAAS1L,KAAK6N,OAAS,WAChB4G,GAGoB,QAAzB/I,EAAS1L,KAAK6N,SAAqBnC,EAAS1L,KAAK6N,QAAW4G,EAAO9c,MAAM2kB,WAI7E5Q,EAAS1L,KAAK6N,OAAS,MAChB0O,UAAU7f,EAAQ+X,EAAQjY,EAAKkP,EAAU5I,IAJvC2R,GAVP/I,EAAS1L,KAAK6N,OAAS,SAChB4G,KAiBV9X,KAAK,SAAUwf,GACd,GAA0B,iBAAfA,IAA4BzQ,EAASV,eAAiBU,EAASV,aAAahM,YACrF,OAAOmd,EAET,IAAIK,GAAoB,EAExB,OADA9Q,EAAS2P,WAAW5G,OAAS0H,EACtBlhB,QAAQC,QAAQwQ,EAASV,aAAahM,YAAYnB,KAAKnB,EAAQgP,EAAS2P,WAAY,SAAUrb,GAGnG,GAFAmc,EAAanc,EAAKyU,OAClB/I,EAAS1L,KAAOA,EAAK0L,SACjB8Q,EACF,MAAM,IAAIvjB,MAAM,yCAClBujB,GAAoB,KAErB7f,KAAK,SAAU8f,GACd,OAAID,EACKL,EACF3Y,yBAAyBiZ,OAGnC9f,KAAK,SAAU8X,GAEd,GAAsB,iBAAXA,EACT,OAAOA,EAEJ/I,EAAS1L,KAAK6N,SACjBnC,EAAS1L,KAAK6N,OAAS6O,mBAAmBjI,IAE5C,IAAIkI,GAAa,EAEjB,OAAQjR,EAAS1L,KAAK6N,QACpB,IAAK,MACL,IAAK,WACL,IAAK,SAEH,GADIvU,EAAMqc,SAASjZ,EAAQ+X,EAAQ/I,EAAS1L,KAAKqO,UAAW7R,EAAKkP,EAAS1L,KAAKmH,UAAWuE,EAAS1L,KAAKoO,OAAO,GAE7G,MAAM9U,EACR,OAAKwJ,SAEL,EADSQ,YAIX,IAAK,OAEH,IAAI0I,EAAS6I,KAAK+H,MAAMnI,GACxB,OAAO/X,EAAOsZ,WAAY1V,QAAS0L,EAAQzL,aAAcyL,IAE3D,IAAK,MACH,IAAIgO,EAAYliB,UAAO+e,OACvB/e,UAAO+e,OAASna,EAAOqb,UAEvB4C,gBAAgBjP,EAAS1L,KAAKY,KAAM8K,EAAS1L,KAAKyO,UAElD,IAAInV,EAAMqc,SAASjZ,EAAQ+X,EAAQ/I,EAAS1L,KAAKqO,UAAW7R,EAAKkP,EAAS1L,KAAKmH,UAAWuE,EAAS1L,KAAKoO,OAAO,GAW/G,IARAuO,EAAa7Z,OAEX+X,mBAAmBne,GACnBigB,EAAa7Z,KAGfhL,UAAO+e,OAASmD,EAEZ1gB,EACF,MAAMA,EACV,MAEA,IAAK,MACH,IAAIshB,EAAWlP,EAAS1L,KAAKY,KACzBA,GAAQ8K,EAAS1L,KAAKY,UAAYoF,OAAO0F,EAAS1L,KAAKuO,oBAAsBuK,WAAWrE,OAE5F,IAAK,IAAIwF,KAAKvO,EAAS1L,KAAKmO,QACtBzC,EAAS1L,KAAKmO,QAAQ8L,IACxBrZ,EAAK/F,KAAK6Q,EAAS1L,KAAKmO,QAAQ8L,IAEpCvd,EAAOuG,gBAAgBrC,GAAM,EAAM,SAAU8B,EAASrB,EAASlF,GAS7D,GARAuG,EAAQxH,QAAU,SAAUsB,GAC1B,OAAOyZ,eAAepY,KAAKnB,EAAQF,EAAKL,EAAO8F,KAGjD9F,EAAOoJ,SACPpJ,EAAOuG,QAAUA,GAGZgJ,EAAS1L,KAAKwO,qBAAuBoM,EACxC,IAAK,IAAIjgB,EAAI,EAAGA,EAAIigB,EAAS7hB,OAAQ4B,IACnC+H,EAAQkY,EAASjgB,IAErB,IAAIkiB,EAAW1G,YAAYha,EAAO8F,IAC9B6a,GACFzb,QAASA,EACT0b,MAAOra,EAASrB,EAASlF,EAAQ0gB,EAAS/G,SAAU+G,EAASxE,QAASvgB,UAAQA,YAG5EklB,EAAa,6EAGjB,GAAItR,EAAS1L,KAAKmO,QAChB,IAAK,IAAI8L,KAAKvO,EAAS1L,KAAKmO,QAC1B2O,EAAaC,KAAKliB,KAAK6H,EAAQgJ,EAAS1L,KAAKmO,QAAQ8L,KACrD+C,GAAc,KAAO/C,EAIzB,IAAIpD,EAAS/e,UAAO+e,OACpB/e,UAAO+e,YAAStc,EAChBzC,UAAOglB,aAAeA,EAEtBrI,EAASuI,EAAa,MAAQvI,EAAO3b,QAAQmkB,gBAAe,IAAM,uDAElE,IAAI3jB,EAAMqc,SAASjZ,EAAQ+X,EAAQ/I,EAAS1L,KAAKqO,UAAW7R,EAAKkP,EAAS1L,KAAKmH,UAAWuE,EAAS1L,KAAKoO,OAAO,GAC/G,GAAI9U,EACF,MAAMA,EAER0hB,gBAAgBtP,EAAUrK,GAE1BvJ,UAAOglB,kBAAeviB,EACtBzC,UAAO+e,OAASA,IAElB8F,EAAa7Z,IACf,MAEA,IAAK,SACClC,EAAO8K,EAAS1L,KAAKY,SACzB,IAAK,IAAIqZ,KAAKvO,EAAS1L,KAAKmO,QAAS,CACnC,IAAI+O,EAAKxR,EAAS1L,KAAKmO,QAAQ8L,GAC3BiD,GACFtc,EAAK/F,KAAKqiB,GAGdxgB,EAAOuG,gBAAgBrC,GAAM,EAAO,SAAU8B,EAASrB,EAASlF,GAC9D,IAAIgS,EACJ,GAAIzC,EAAS1L,KAAKmO,QAEhB,IAAK,IAAI8L,KADT9L,KACczC,EAAS1L,KAAKmO,QACtBzC,EAAS1L,KAAKmO,QAAQ8L,KACxB9L,EAAQ8L,GAAKvX,EAAQgJ,EAAS1L,KAAKmO,QAAQ8L,KAGjD,IAAIkD,EAAazR,EAAS1L,KAAKqB,QAE3B8b,IACF1I,GAAU,KAAOiF,WAAa,KAAOyD,EAAa,QAAUA,EAAa,KAE3E,IAAIC,EAAiBhH,cAAcja,EAAO8F,GAAIkb,EAAYhP,EAASzC,EAAS1L,KAAKsO,mBAC7EhV,EAAMqc,SAASjZ,EAAQ+X,EAAQ/I,EAAS1L,KAAKqO,UAAW7R,EAAKkP,EAAS1L,KAAKmH,UAAWuE,EAAS1L,KAAKoO,OAAO,GAE/G,GAAI9U,EACF,MAAMA,EAER,IAAImB,EAAS2iB,IAEb,OADApC,gBAAgBtP,EAAUjR,GACnBA,IAETkiB,EAAa7Z,IACf,MAEA,QACE,MAAM,IAAIjK,UAAU,0BAA4B6S,EAAS1L,KAAK6N,OAAS,UAAYrR,EAAM,MAAiC,QAAzBkP,EAAS1L,KAAK6N,OAAmB,2BAA6B,KAGnK,IAAK8O,EACH,MAAM,IAAI1jB,MAAM,UAAYuD,EAAM,gBAAkBkP,EAAS1L,KAAK6N,OAAS,oCAhZ1D,oBAAZnL,SAA8C,oBAAZpL,SAA4BA,QAAQ+lB,UAC/EtC,YAAcrY,SAmZhB,IAAIgX,WAA4B,oBAAR7hB,KAAsB,OAAS,SAG5CykB,SAAW,2LAElBgB,2BAA6B,0FAC1B,SAASjB,qBAAqB5H,GACnC,IAAI8I,EAAwB9I,EAAO9c,MAAM2lB,4BACzC,IAAKC,EACH,OAAO,EACT,IAAIC,EAAYD,EAAsB,GAAGxkB,OACzC,OAAO0b,EAAOgJ,WAAW,kBAAmBD,IAAc/I,EAAOgJ,WAAW,oBAAqBD,GAMnG,IAAIE,SAAW,0RAGXC,gBAAkB,8HAMlBV,gBAAgB,UAEb,SAASP,mBAAoBjI,GAClC,OAAIA,EAAO9c,MAAM+lB,UACR,OAETC,gBAAgB5E,UAAY,EAC5BvQ,gBAAgBuQ,UAAY,EACxBvQ,gBAAgB6Q,KAAK5E,IAAWkJ,gBAAgBtE,KAAK5E,GAChD,MAGF,UAGT,SAAS2H,kBAAmB1H,EAASrG,GACnC,IAAIuP,EAAelJ,EAAQlc,MAAM,KAAK,GAGjC6V,EAAUwP,MAAQxP,EAAUwP,MAAQnJ,IACvCrG,EAAUwP,KAAOD,EAAe,iBAG7BvP,EAAUyP,SAAWzP,EAAUyP,QAAQ/kB,QAAU,KAAOsV,EAAUyP,QAAQ,IAAMzP,EAAUyP,QAAQ,KAAOpJ,MAC5GrG,EAAUyP,SAAWF,IAGzB,SAASrB,UAAW7f,EAAQ+X,EAAQjY,EAAKkP,EAAU5I,GACjD,IAAKpG,EAAOiX,WACV,MAAM,IAAI9a,UAAU,oJAGtB,GAAI6S,EAAS1L,KAAKY,KAAM,CAEtB,IADA,IAAImd,EAAa,GACRpjB,EAAI,EAAGA,EAAI+Q,EAAS1L,KAAKY,KAAK7H,OAAQ4B,IAC7CojB,GAAc,WAAarS,EAAS1L,KAAKY,KAAKjG,GAAK,MACrD8Z,EAASsJ,EAAatJ,EAIxB,OAAO/X,EAAOH,OAAOsB,KAAKnB,EAAQA,EAAOiX,YACxChX,KAAK,SAAUgX,GAId,KAHAA,EAAaA,EAAWpT,cAAgBoT,GAGxBsI,UACd,MAAM,IAAIhjB,MAAMyD,EAAOiX,WAAa,sCAGtC,OAAIA,IAAejI,EAASV,aACnByJ,GAG8B,iBAA5B/I,EAAS1L,KAAKqO,YACvB3C,EAAS1L,KAAKqO,UAAYwG,KAAK+H,MAAMlR,EAAS1L,KAAKqO,YAErD3C,EAAS2P,WAAa3P,EAAS2P,aAC7BljB,KAAMqE,EACNkY,QAASlY,EACTiY,OAAQA,EACR/I,SAAUA,EAAS1L,MAErB0L,EAAS1L,KAAKY,KAAO8K,EAAS1L,KAAKY,SAE5B3F,QAAQC,QAAQyY,EAAWsI,UAAUpe,KAAKnB,EAAQgP,EAAS2P,WAAY3P,EAASwQ,YACtFvf,KAAK,SAAU8X,GAEd,IAAIpG,EAAY3C,EAAS1L,KAAKqO,UAO9B,OANIA,GAAkC,iBAAdA,GACtB+N,kBAAkB5f,EAAK6R,GAEI,QAAzB3C,EAAS1L,KAAK6N,QAAoBwO,qBAAqB5H,KACzD/I,EAAS1L,KAAK6N,OAAS,YAElB4G,MAER,SAAUnb,GACX,MAAMwD,kDAAWxD,EAAK,0CAA4CkD,KAMtE,IAAIwhB,UAAY,uFACZC,cAAgB,wEClgBhBC,UAgFO/L,UDobX,SAASgM,gBAAgBhW,EAAQhH,EAAGvF,GAGlC,IAFA,IACIwiB,EADAtW,EAAS3G,EAAE3I,MAAM,KAEE,EAAhBsP,EAAO/O,QAEZoP,EAASA,EADTiW,EAAUtW,EAAOC,SACUI,EAAOiW,YAGZ7jB,IAApB4N,EADJiW,EAAUtW,EAAOC,WAEfI,EAAOiW,GAAWxiB,GAGtB,SAASogB,eAAgBvH,EAAQ/I,GAC/B,IAAIxJ,EAAOuS,EAAO9c,MAAMqmB,WACxB,GAAK9b,EAKL,IAFA,IAAImc,EAAYnc,EAAK,GAAGvK,MAAMsmB,eAErBtjB,EAAI,EAAGA,EAAI0jB,EAAUtlB,OAAQ4B,IAAK,CACzC,IAAIyjB,EAAUC,EAAU1jB,GACpB2N,EAAM8V,EAAQrlB,OAEdoB,EAAYikB,EAAQzlB,OAAO,EAAG,GAIlC,GAHkC,KAA9BylB,EAAQzlB,OAAO2P,EAAM,EAAG,IAC1BA,IAEe,KAAbnO,GAAiC,KAAbA,EAAxB,CAGA,IAAImkB,EAAaF,EAAQzlB,OAAO,EAAGylB,EAAQrlB,OAAS,GAChDwlB,EAAWD,EAAW3lB,OAAO,EAAG2lB,EAAWpkB,QAAQ,MAEvD,GAAIqkB,EAAU,CACZ,IAAIC,EAAYF,EAAW3lB,OAAO4lB,EAASxlB,OAAS,EAAGulB,EAAWvlB,OAASwlB,EAASxlB,OAAS,GAE5E,SAAbwlB,IACFA,EAAW,UAEmC,OAA5CA,EAAS5lB,OAAO4lB,EAASxlB,OAAS,EAAG,IACvCwlB,EAAWA,EAAS5lB,OAAO,EAAG4lB,EAASxlB,OAAS,GAChD2S,EAAS1L,KAAKue,GAAY7S,EAAS1L,KAAKue,OACxC7S,EAAS1L,KAAKue,GAAU1jB,KAAK2jB,IAGT,QAAbD,GACPJ,gBAAgBzS,EAAS1L,KAAMue,EAAUC,QAI3C9S,EAAS1L,KAAKse,IAAc,ICnjBlC,GAAuB,oBAAZrjB,QACT,MAAM,IAAIhC,MAAM,sCAElB,GAAwB,oBAAb7B,SAA0B,CACnC,IAAIqnB,QAAUrnB,SAASgB,qBAAqB,UACxCsmB,UAAYD,QAAQA,QAAQ1lB,OAAS,GACrC3B,SAASunB,gBAAkBD,UAAUE,OAASF,UAAU/W,SAC1D+W,UAAYtnB,SAASunB,eAEvBT,UAAYQ,WAAaA,UAAUhY,SAGhC,GAA6B,oBAAlB1C,cACd,IACE,MAAM,IAAI/K,MAAM,KAElB,MAAOkK,GACLA,EAAE1J,MAAMX,QAAQ,iCAAkC,SAAS6K,EAAGxB,GAC5D+b,UAAY/b,QAKa,oBAAf0c,aACdX,UAAYW,YAGd,SAASC,iBACPtgB,eAAeX,KAAK9B,MAGpBA,KAAKgjB,WAGLhjB,KAAK+H,aAGL/H,KAAK8H,SACHsB,QAASlN,QACTsN,SAEA4K,sBACA3C,qBACAhQ,OACAgO,YACAkI,YACAxR,QACAsR,WAEAN,YAAY,EAEZS,gBAAYpZ,EACZykB,iBAGA3a,UAAU,EACVkH,aAAa,EAGbyH,MAAM,GAIRjX,KAAKmiB,UAAYA,UAEjBniB,KAAKqJ,aAAe2V,YAGpBhf,KAAKC,SAASyB,IAAI,SAAU6F,aAE5B2P,cAAcpV,KAAK9B,MAAM,GAAO,GAGhCga,WAAWha,MACXsa,aAAata,MAIR,SAASkX,cAAegM,EAAcC,GAC3CnjB,KAAK8H,QAAQqP,WAAa+L,EAC1BljB,KAAKC,SAASyB,IAAI,cAAe0U,UAAYpW,KAAKia,WAChDqH,QAASnmB,UACTM,OAAQuE,KAAKqJ,aACb8N,YAAagM,GAAaD,EAC1BE,IAAKD,IAAcD,EACnB9L,MAAO+L,EACP5e,SAAW,KAIfwe,eAAeziB,UAAYZ,OAAO4C,OAAOG,eAAenC,WAExDyiB,eAAeziB,UAAUC,YAAcwiB,eAGvCA,eAAeziB,UAAUyiB,eAAe5jB,QAAUsD,eAAetD,SAAW4jB,eAAeziB,UAAUoP,UAAYA,UAEjHqT,eAAeziB,UAAU2D,KAAO,SAAUxD,EAAKuD,GAE7C,OADAmE,KAAKrG,KAAK9B,KAAK8H,QAAS,8BACjB9H,KAAKQ,OAAOC,EAAKuD,IAI1B+e,eAAeziB,UAAUoQ,eAAiBqS,eAAeziB,UAAUsQ,cAAgBmS,eAAeziB,UAAU+iB,YAAczS,cAE1HmS,eAAeziB,UAAUyiB,eAAe9f,YAAcR,eAAeQ,aAAeA,cAEpF8f,eAAeziB,UAAU+O,OAAS0H,UAClCgM,eAAeziB,UAAUqW,UAAYA,UAErCoM,eAAeziB,UAAUvE,OAASA,UAElCgnB,eAAeziB,UAAUE,OAAS,WAChC,OAAOiC,eAAenC,UAAUE,OAAOwK,MAAMhL,KAAMiL,WAClDrK,KAAK,SAAUgH,GACd,MAAO,iBAAkBA,EAAIA,EAAEpD,aAAeoD,KAOlD,IAHO,IAAIiP,aAAe,UAAW,MAAO,QAAS,WAAY,qBAAsB,WAAY,OAAQ,UAAW,aAAc,WAAY,cAAe,aAAc,QAEzKyM,SAA4B,oBAAVC,MACb3kB,EAAI,EAAGA,EAAIiY,YAAY7Z,OAAQ4B,KAAK,SAAWgY,GACtDlX,OAAOwC,eAAe6gB,eAAeziB,UAAWsW,GAC9CvV,IAAK,WACH,IAAI4U,EAAMQ,cAAczW,KAAK8H,QAAS8O,GAWtC,OATI0M,UAA2B,iBAARrN,IACrBA,EAAM,IAAIsN,MAAMtN,GACdvU,IAAK,SAAU0K,EAAQoX,GACrB,MAAM,IAAItmB,MAAM,uBAAyB0Z,EAAa,KAAO4M,EAAS,sCAAwC5M,EAAa,QAAU4M,EAAS,2BAM7IvN,GAETvU,IAAK,SAAUtF,GACb,MAAM,IAAIc,MAAM,qBAAuB0Z,EAAa,6DAA+DA,EAAa,iBAjBzF,CAoB1CC,YAAYjY,IAKf,SAAS6kB,aAAa9iB,EAAQ+iB,GAC5Bvb,KAAKrG,KAAKnB,EAAOmH,QAAS,YAAc4b,EAAS,wCAA0CA,GAE7FX,eAAeziB,UAAUyB,OAAS,SAAUtB,GAE1C,OADAgjB,aAAazjB,KAAM,UACZA,KAAKC,SAAS8B,OAAOtB,IAE9BsiB,eAAeziB,UAAUe,IAAM,SAAUZ,GAEvC,OADAgjB,aAAazjB,KAAM,OACZA,KAAKC,SAASoB,IAAIZ,IAE3BsiB,eAAeziB,UAAUsB,IAAM,SAAUnB,GAEvC,OADAgjB,aAAazjB,KAAM,OACZA,KAAKC,SAAS2B,IAAInB,IAE3BsiB,eAAeziB,UAAUoB,IAAM,SAAUjB,EAAKL,GAE5C,OADAqjB,aAAazjB,KAAM,OACZA,KAAKC,SAASyB,IAAIjB,EAAKL,IAEhC2iB,eAAeziB,UAAU2Z,UAAY,SAAUvS,GAC7C,OAAO,IAAIrH,gBAAgBqH,IAE7Bqb,eAAeziB,UAAUqH,SAAWA,SAGpCob,eAAeziB,UAAU2G,SAAW,SAAUxG,EAAKoE,EAAMG,GAGvD,MAFmB,iBAARvE,IACTA,EAAMiQ,eAAe5O,KAAK9B,KAAMA,KAAK8H,QAASrH,IACzCgC,eAAenC,UAAU2G,SAASnF,KAAK9B,KAAMS,EAAKoE,EAAMG,IAGjE+d,eAAeziB,UAAU4G,gBAAkB,SAAUzG,EAAKoE,EAAMlB,EAAkBD,GAGhF,MAFmB,iBAARjD,IACTA,EAAMiQ,eAAe5O,KAAK9B,KAAMA,KAAK8H,QAASrH,IACzCgC,eAAenC,UAAU4G,gBAAgBpF,KAAK9B,KAAMS,EAAKoE,EAAMlB,EAAkBD,IC/L1Fqf,eAAeziB,UAAUqjB,QAAU,aAEnC,IAAInK,OAAS,IAAIuJ,gBAGb5nB,WAAa6M,YACfjM,UAAO0d,SAAW1d,UAAOyd,OAASA,QAEd,oBAAXpZ,QAA0BA,OAAOkF,UAC1ClF,OAAOkF,QAAUkU","sourcesContent":["/*\n * Environment\n */\nexport var isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined';\nexport var isNode = typeof process !== 'undefined' && process.versions && process.versions.node;\nexport var isWindows = typeof process !== 'undefined' && typeof process.platform === 'string' && process.platform.match(/^win/);\n\nvar envGlobal = typeof self !== 'undefined' ? self : global;\nexport { envGlobal as global }\n\n/*\n * Simple Symbol() shim\n */\nvar hasSymbol = typeof Symbol !== 'undefined';\nexport function createSymbol (name) {\n  return hasSymbol ? Symbol() : '@@' + name;\n}\n\nexport function pathToFileUrl (filePath) {\n  return 'file://' + (isWindows ? '/' : '') + (isWindows ? filePath.replace(/\\\\/g, '/') : filePath);\n}\n\nexport function fileUrlToPath (fileUrl) {\n  if (fileUrl.substr(0, 7) !== 'file://')\n    throw new RangeError(fileUrl + ' is not a valid file url');\n  if (isWindows)\n    return fileUrl.substr(8).replace(/\\\\/g, '/');\n  else\n    return fileUrl.substr(7);\n}\n\n/*\n * Environment baseURI\n */\nexport var baseURI;\n\n// environent baseURI detection\nif (typeof document != 'undefined' && document.getElementsByTagName) {\n  baseURI = document.baseURI;\n\n  if (!baseURI) {\n    var bases = document.getElementsByTagName('base');\n    baseURI = bases[0] && bases[0].href || window.location.href;\n  }\n}\nelse if (typeof location != 'undefined') {\n  baseURI = location.href;\n}\n\n// sanitize out the hash and querystring\nif (baseURI) {\n  baseURI = baseURI.split('#')[0].split('?')[0];\n  var slashIndex = baseURI.lastIndexOf('/');\n  if (slashIndex !== -1)\n    baseURI = baseURI.substr(0, slashIndex + 1);\n}\nelse if (typeof process !== 'undefined' && process.cwd) {\n  baseURI = 'file://' + (isWindows ? '/' : '') + process.cwd();\n  if (isWindows)\n    baseURI = baseURI.replace(/\\\\/g, '/');\n}\nelse {\n  throw new TypeError('No environment baseURI');\n}\n\n// ensure baseURI has trailing \"/\"\nif (baseURI[baseURI.length - 1] !== '/')\n  baseURI += '/';\n\n/*\n * LoaderError with chaining for loader stacks\n */\nvar errArgs = new Error(0, '_').fileName == '_';\nfunction LoaderError__Check_error_message_for_loader_stack (childErr, newMessage) {\n  // Convert file:/// URLs to paths in Node\n  if (!isBrowser)\n    newMessage = newMessage.replace(isWindows ? /file:\\/\\/\\//g : /file:\\/\\//g, '');\n\n  var message = (childErr.message || childErr) + '\\n  ' + newMessage;\n\n  var err;\n  if (errArgs && childErr.fileName)\n    err = new Error(message, childErr.fileName, childErr.lineNumber);\n  else\n    err = new Error(message);\n\n\n  var stack = childErr.originalErr ? childErr.originalErr.stack : childErr.stack;\n\n  if (isNode)\n    // node doesn't show the message otherwise\n    err.stack = message + '\\n  ' + stack;\n  else\n    err.stack = stack;\n\n  err.originalErr = childErr.originalErr || childErr;\n\n  return err;\n}\nexport { LoaderError__Check_error_message_for_loader_stack as addToError }\n","import { isNode } from './common.js';\n\n/*\n * Optimized URL normalization assuming a syntax-valid URL parent\n */\nfunction throwResolveError (relUrl, parentUrl) {\n  throw new RangeError('Unable to resolve \"' + relUrl + '\" to ' + parentUrl);\n}\nexport function resolveIfNotPlain (relUrl, parentUrl) {\n  relUrl = relUrl.trim();\n  var parentProtocol = parentUrl && parentUrl.substr(0, parentUrl.indexOf(':') + 1);\n\n  var firstChar = relUrl[0];\n  var secondChar = relUrl[1];\n\n  // protocol-relative\n  if (firstChar === '/' && secondChar === '/') {\n    if (!parentProtocol)\n      throwResolveError(relUrl, parentUrl);\n    return parentProtocol + relUrl;\n  }\n  // relative-url\n  else if (firstChar === '.' && (secondChar === '/' || secondChar === '.' && (relUrl[2] === '/' || relUrl.length === 2 && (relUrl += '/')) ||\n      relUrl.length === 1  && (relUrl += '/')) ||\n      firstChar === '/') {\n    var parentIsPlain = !parentProtocol || parentUrl[parentProtocol.length] !== '/';\n\n    // read pathname from parent if a URL\n    // pathname taken to be part after leading \"/\"\n    var pathname;\n    if (parentIsPlain) {\n      // resolving to a plain parent -> skip standard URL prefix, and treat entire parent as pathname\n      if (parentUrl === undefined)\n        throwResolveError(relUrl, parentUrl);\n      pathname = parentUrl;\n    }\n    else if (parentUrl[parentProtocol.length + 1] === '/') {\n      // resolving to a :// so we need to read out the auth and host\n      if (parentProtocol !== 'file:') {\n        pathname = parentUrl.substr(parentProtocol.length + 2);\n        pathname = pathname.substr(pathname.indexOf('/') + 1);\n      }\n      else {\n        pathname = parentUrl.substr(8);\n      }\n    }\n    else {\n      // resolving to :/ so pathname is the /... part\n      pathname = parentUrl.substr(parentProtocol.length + 1);\n    }\n\n    if (firstChar === '/') {\n      if (parentIsPlain)\n        throwResolveError(relUrl, parentUrl);\n      else\n        return parentUrl.substr(0, parentUrl.length - pathname.length - 1) + relUrl;\n    }\n\n    // join together and split for removal of .. and . segments\n    // looping the string instead of anything fancy for perf reasons\n    // '../../../../../z' resolved to 'x/y' is just 'z' regardless of parentIsPlain\n    var segmented = pathname.substr(0, pathname.lastIndexOf('/') + 1) + relUrl;\n\n    var output = [];\n    var segmentIndex = -1;\n\n    for (var i = 0; i < segmented.length; i++) {\n      // busy reading a segment - only terminate on '/'\n      if (segmentIndex !== -1) {\n        if (segmented[i] === '/') {\n          output.push(segmented.substring(segmentIndex, i + 1));\n          segmentIndex = -1;\n        }\n        continue;\n      }\n\n      // new segment - check if it is relative\n      if (segmented[i] === '.') {\n        // ../ segment\n        if (segmented[i + 1] === '.' && (segmented[i + 2] === '/' || i + 2 === segmented.length)) {\n          output.pop();\n          i += 2;\n        }\n        // ./ segment\n        else if (segmented[i + 1] === '/' || i + 1 === segmented.length) {\n          i += 1;\n        }\n        else {\n          // the start of a new segment as below\n          segmentIndex = i;\n          continue;\n        }\n\n        // this is the plain URI backtracking error (../, package:x -> error)\n        if (parentIsPlain && output.length === 0)\n          throwResolveError(relUrl, parentUrl);\n\n        continue;\n      }\n\n      // it is the start of a new segment\n      segmentIndex = i;\n    }\n    // finish reading out the last segment\n    if (segmentIndex !== -1)\n      output.push(segmented.substr(segmentIndex));\n\n    return parentUrl.substr(0, parentUrl.length - pathname.length) + output.join('');\n  }\n\n  // sanitizes and verifies (by returning undefined if not a valid URL-like form)\n  // Windows filepath compatibility is an added convenience here\n  var protocolIndex = relUrl.indexOf(':');\n  if (protocolIndex !== -1) {\n    if (isNode) {\n      // C:\\x becomes file:///c:/x (we don't support C|\\x)\n      if (relUrl[1] === ':' && relUrl[2] === '\\\\' && relUrl[0].match(/[a-z]/i))\n        return 'file:///' + relUrl.replace(/\\\\/g, '/');\n    }\n    return relUrl;\n  }\n}\n","import { addToError, createSymbol } from './common.js';\n\nexport { Loader, ModuleNamespace, REGISTRY }\n\nvar resolvedPromise = Promise.resolve();\n\n/*\n * Simple Array values shim\n */\nfunction arrayValues (arr) {\n  if (arr.values)\n    return arr.values();\n\n  if (typeof Symbol === 'undefined' || !Symbol.iterator)\n    throw new Error('Symbol.iterator not supported in this browser');\n\n  var iterable = {};\n  iterable[Symbol.iterator] = function () {\n    var keys = Object.keys(arr);\n    var keyIndex = 0;\n    return {\n      next: function () {\n        if (keyIndex < keys.length)\n          return {\n            value: arr[keys[keyIndex++]],\n            done: false\n          };\n        else\n          return {\n            value: undefined,\n            done: true\n          };\n      }\n    };\n  };\n  return iterable;\n}\n\n/*\n * 3. Reflect.Loader\n *\n * We skip the entire native internal pipeline, just providing the bare API\n */\n// 3.1.1\nfunction Loader () {\n  this.registry = new Registry();\n}\n// 3.3.1\nLoader.prototype.constructor = Loader;\n\nfunction ensureInstantiated (module) {\n  if (!(module instanceof ModuleNamespace))\n    throw new TypeError('Module instantiation did not return a valid namespace object.');\n  return module;\n}\n\n// 3.3.2\nLoader.prototype.import = function (key, parent) {\n  if (typeof key !== 'string')\n    throw new TypeError('Loader import method must be passed a module key string');\n  // custom resolveInstantiate combined hook for better perf\n  var loader = this;\n  return resolvedPromise\n  .then(function () {\n    return loader[RESOLVE_INSTANTIATE](key, parent);\n  })\n  .then(ensureInstantiated)\n  //.then(Module.evaluate)\n  .catch(function (err) {\n    throw addToError(err, 'Loading ' + key + (parent ? ' from ' + parent : ''));\n  });\n};\n// 3.3.3\nvar RESOLVE = Loader.resolve = createSymbol('resolve');\n\n/*\n * Combined resolve / instantiate hook\n *\n * Not in current reduced spec, but necessary to separate RESOLVE from RESOLVE + INSTANTIATE as described\n * in the spec notes of this repo to ensure that loader.resolve doesn't instantiate when not wanted.\n *\n * We implement RESOLVE_INSTANTIATE as a single hook instead of a separate INSTANTIATE in order to avoid\n * the need for double registry lookups as a performance optimization.\n */\nvar RESOLVE_INSTANTIATE = Loader.resolveInstantiate = createSymbol('resolveInstantiate');\n\n// default resolveInstantiate is just to call resolve and then get from the registry\n// this provides compatibility for the resolveInstantiate optimization\nLoader.prototype[RESOLVE_INSTANTIATE] = function (key, parent) {\n  var loader = this;\n  return loader.resolve(key, parent)\n  .then(function (resolved) {\n    return loader.registry.get(resolved);\n  });\n};\n\nfunction ensureResolution (resolvedKey) {\n  if (resolvedKey === undefined)\n    throw new RangeError('No resolution found.');\n  return resolvedKey;\n}\n\nLoader.prototype.resolve = function (key, parent) {\n  var loader = this;\n  return resolvedPromise\n  .then(function() {\n    return loader[RESOLVE](key, parent);\n  })\n  .then(ensureResolution)\n  .catch(function (err) {\n    throw addToError(err, 'Resolving ' + key + (parent ? ' to ' + parent : ''));\n  });\n};\n\n// 3.3.4 (import without evaluate)\n// this is not documented because the use of deferred evaluation as in Module.evaluate is not\n// documented, as it is not considered a stable feature to be encouraged\n// Loader.prototype.load may well be deprecated if this stays disabled\n/* Loader.prototype.load = function (key, parent) {\n  return Promise.resolve(this[RESOLVE_INSTANTIATE](key, parent || this.key))\n  .catch(function (err) {\n    throw addToError(err, 'Loading ' + key + (parent ? ' from ' + parent : ''));\n  });\n}; */\n\n/*\n * 4. Registry\n *\n * Instead of structuring through a Map, just use a dictionary object\n * We throw for construction attempts so this doesn't affect the public API\n *\n * Registry has been adjusted to use Namespace objects over ModuleStatus objects\n * as part of simplifying loader API implementation\n */\nvar iteratorSupport = typeof Symbol !== 'undefined' && Symbol.iterator;\nvar REGISTRY = createSymbol('registry');\nfunction Registry() {\n  this[REGISTRY] = {};\n}\n// 4.4.1\nif (iteratorSupport) {\n  // 4.4.2\n  Registry.prototype[Symbol.iterator] = function () {\n    return this.entries()[Symbol.iterator]();\n  };\n\n  // 4.4.3\n  Registry.prototype.entries = function () {\n    var registry = this[REGISTRY];\n    return arrayValues(Object.keys(registry).map(function (key) {\n      return [key, registry[key]];\n    }));\n  };\n}\n\n// 4.4.4\nRegistry.prototype.keys = function () {\n  return arrayValues(Object.keys(this[REGISTRY]));\n};\n// 4.4.5\nRegistry.prototype.values = function () {\n  var registry = this[REGISTRY];\n  return arrayValues(Object.keys(registry).map(function (key) {\n    return registry[key];\n  }));\n};\n// 4.4.6\nRegistry.prototype.get = function (key) {\n  return this[REGISTRY][key];\n};\n// 4.4.7\nRegistry.prototype.set = function (key, namespace) {\n  if (!(namespace instanceof ModuleNamespace))\n    throw new Error('Registry must be set with an instance of Module Namespace');\n  this[REGISTRY][key] = namespace;\n  return this;\n};\n// 4.4.8\nRegistry.prototype.has = function (key) {\n  return Object.hasOwnProperty.call(this[REGISTRY], key);\n};\n// 4.4.9\nRegistry.prototype.delete = function (key) {\n  if (Object.hasOwnProperty.call(this[REGISTRY], key)) {\n    delete this[REGISTRY][key];\n    return true;\n  }\n  return false;\n};\n\n/*\n * Simple ModuleNamespace Exotic object based on a baseObject\n * We export this for allowing a fast-path for module namespace creation over Module descriptors\n */\n// var EVALUATE = createSymbol('evaluate');\nvar BASE_OBJECT = createSymbol('baseObject');\n\n// 8.3.1 Reflect.Module\n/*\n * Best-effort simplified non-spec implementation based on\n * a baseObject referenced via getters.\n *\n * Allows:\n *\n *   loader.registry.set('x', new Module({ default: 'x' }));\n *\n * Optional evaluation function provides experimental Module.evaluate\n * support for non-executed modules in registry.\n */\nfunction ModuleNamespace (baseObject/*, evaluate*/) {\n  Object.defineProperty(this, BASE_OBJECT, {\n    value: baseObject\n  });\n\n  // evaluate defers namespace population\n  /* if (evaluate) {\n    Object.defineProperty(this, EVALUATE, {\n      value: evaluate,\n      configurable: true,\n      writable: true\n    });\n  }\n  else { */\n    Object.keys(baseObject).forEach(extendNamespace, this);\n  //}\n};\n// 8.4.2\nModuleNamespace.prototype = Object.create(null);\n\nif (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n  Object.defineProperty(ModuleNamespace.prototype, Symbol.toStringTag, {\n    value: 'Module'\n  });\n\nfunction extendNamespace (key) {\n  Object.defineProperty(this, key, {\n    enumerable: true,\n    get: function () {\n      return this[BASE_OBJECT][key];\n    }\n  });\n}\n\n/* function doEvaluate (evaluate, context) {\n  try {\n    evaluate.call(context);\n  }\n  catch (e) {\n    return e;\n  }\n}\n\n// 8.4.1 Module.evaluate... not documented or used because this is potentially unstable\nModule.evaluate = function (ns) {\n  var evaluate = ns[EVALUATE];\n  if (evaluate) {\n    ns[EVALUATE] = undefined;\n    var err = doEvaluate(evaluate);\n    if (err) {\n      // cache the error\n      ns[EVALUATE] = function () {\n        throw err;\n      };\n      throw err;\n    }\n    Object.keys(ns[BASE_OBJECT]).forEach(extendNamespace, ns);\n  }\n  // make chainable\n  return ns;\n}; */\n","import { Loader, ModuleNamespace, REGISTRY } from './loader-polyfill.js';\nimport { resolveIfNotPlain } from './resolve.js';\nimport { addToError, global, createSymbol, baseURI } from './common.js';\n\nexport default RegisterLoader;\n\n/*\n * Register Loader\n *\n * Builds directly on top of loader polyfill to provide:\n * - loader.register support\n * - hookable higher-level resolve\n * - instantiate hook returning a ModuleNamespace or undefined for es module loading\n * - loader error behaviour as in HTML and loader specs, caching load and eval errors separately\n * - build tracing support by providing a .trace=true and .loads object format\n */\n\nvar REGISTER_INTERNAL = createSymbol('register-internal');\n\nfunction RegisterLoader () {\n  Loader.call(this);\n\n  var registryDelete = this.registry.delete;\n  this.registry.delete = function (key) {\n    var deleted = registryDelete.call(this, key);\n\n    // also delete from register registry if linked\n    if (records.hasOwnProperty(key) && !records[key].linkRecord) {\n      delete records[key];\n      deleted = true;\n    }\n\n    return deleted;\n  };\n\n  var records = {};\n\n  this[REGISTER_INTERNAL] = {\n    // last anonymous System.register call\n    lastRegister: undefined,\n    // in-flight es module load records\n    records: records\n  };\n\n  // tracing\n  this.trace = false;\n}\n\nRegisterLoader.prototype = Object.create(Loader.prototype);\nRegisterLoader.prototype.constructor = RegisterLoader;\n\nvar INSTANTIATE = RegisterLoader.instantiate = createSymbol('instantiate');\n\n// default normalize is the WhatWG style normalizer\nRegisterLoader.prototype[RegisterLoader.resolve = Loader.resolve] = function (key, parentKey) {\n  return resolveIfNotPlain(key, parentKey || baseURI);\n};\n\nRegisterLoader.prototype[INSTANTIATE] = function (key, processAnonRegister) {};\n\n// once evaluated, the linkRecord is set to undefined leaving just the other load record properties\n// this allows tracking new binding listeners for es modules through importerSetters\n// for dynamic modules, the load record is removed entirely.\nfunction createLoadRecord (state, key, registration) {\n  return state.records[key] = {\n    key: key,\n\n    // defined System.register cache\n    registration: registration,\n\n    // module namespace object\n    module: undefined,\n\n    // es-only\n    // this sticks around so new module loads can listen to binding changes\n    // for already-loaded modules by adding themselves to their importerSetters\n    importerSetters: undefined,\n\n    loadError: undefined,\n    evalError: undefined,\n\n    // in-flight linking record\n    linkRecord: {\n      // promise for instantiated\n      instantiatePromise: undefined,\n      dependencies: undefined,\n      execute: undefined,\n      executingRequire: false,\n\n      // underlying module object bindings\n      moduleObj: undefined,\n\n      // es only, also indicates if es or not\n      setters: undefined,\n\n      // promise for instantiated dependencies (dependencyInstantiations populated)\n      depsInstantiatePromise: undefined,\n      // will be the array of dependency load record or a module namespace\n      dependencyInstantiations: undefined,\n\n      // NB optimization and way of ensuring module objects in setters\n      // indicates setters which should run pre-execution of that dependency\n      // setters is then just for completely executed module objects\n      // alternatively we just pass the partially filled module objects as\n      // arguments into the execute function\n      // hoisted: undefined\n    }\n  };\n}\n\nRegisterLoader.prototype[Loader.resolveInstantiate] = function (key, parentKey) {\n  var loader = this;\n  var state = this[REGISTER_INTERNAL];\n  var registry = this.registry[REGISTRY];\n\n  return resolveInstantiate(loader, key, parentKey, registry, state)\n  .then(function (instantiated) {\n    if (instantiated instanceof ModuleNamespace)\n      return instantiated;\n\n    // resolveInstantiate always returns a load record with a link record and no module value\n    var link = instantiated.linkRecord;\n\n    // if already beaten to done, return\n    if (!link) {\n      if (instantiated.module)\n        return instantiated.module;\n      throw instantiated.evalError;\n    }\n\n    return deepInstantiateDeps(loader, instantiated, link, registry, state)\n    .then(function () {\n      return ensureEvaluate(loader, instantiated, link, registry, state, undefined);\n    });\n  });\n};\n\nfunction resolveInstantiate (loader, key, parentKey, registry, state) {\n  // normalization shortpath for already-normalized key\n  // could add a plain name filter, but doesn't yet seem necessary for perf\n  var module = registry[key];\n  if (module)\n    return Promise.resolve(module);\n\n  var load = state.records[key];\n\n  // already linked but not in main registry is ignored\n  if (load && !load.module) {\n    if (load.loadError)\n      return Promise.reject(load.loadError);\n    return instantiate(loader, load, load.linkRecord, registry, state);\n  }\n\n  return loader.resolve(key, parentKey)\n  .then(function (resolvedKey) {\n    // main loader registry always takes preference\n    module = registry[resolvedKey];\n    if (module)\n      return module;\n\n    load = state.records[resolvedKey];\n\n    // already has a module value but not already in the registry (load.module)\n    // means it was removed by registry.delete, so we should\n    // disgard the current load record creating a new one over it\n    // but keep any existing registration\n    if (!load || load.module)\n      load = createLoadRecord(state, resolvedKey, load && load.registration);\n\n    if (load.loadError)\n      return Promise.reject(load.loadError);\n\n    var link = load.linkRecord;\n    if (!link)\n      return load;\n\n    return instantiate(loader, load, link, registry, state);\n  });\n}\n\nfunction createProcessAnonRegister (loader, load, state) {\n  return function () {\n    var lastRegister = state.lastRegister;\n\n    if (!lastRegister)\n      return !!load.registration;\n\n    state.lastRegister = undefined;\n    load.registration = lastRegister;\n\n    return true;\n  };\n}\n\nfunction instantiate (loader, load, link, registry, state) {\n  return link.instantiatePromise || (link.instantiatePromise =\n  // if there is already an existing registration, skip running instantiate\n  (load.registration ? Promise.resolve() : Promise.resolve().then(function () {\n    state.lastRegister = undefined;\n    return loader[INSTANTIATE](load.key, loader[INSTANTIATE].length > 1 && createProcessAnonRegister(loader, load, state));\n  }))\n  .then(function (instantiation) {\n    // direct module return from instantiate -> we're done\n    if (instantiation !== undefined) {\n      if (!(instantiation instanceof ModuleNamespace))\n        throw new TypeError('Instantiate did not return a valid Module object.');\n\n      delete state.records[load.key];\n      if (loader.trace)\n        traceLoad(loader, load, link);\n      return registry[load.key] = instantiation;\n    }\n\n    // run the cached loader.register declaration if there is one\n    var registration = load.registration;\n    // clear to allow new registrations for future loads (combined with registry delete)\n    load.registration = undefined;\n    if (!registration)\n      throw new TypeError('Module instantiation did not call an anonymous or correctly named System.register.');\n\n    link.dependencies = registration[0];\n\n    load.importerSetters = [];\n\n    link.moduleObj = {};\n\n    // process System.registerDynamic declaration\n    if (registration[2]) {\n      link.moduleObj.default = link.moduleObj.__useDefault = {};\n      link.executingRequire = registration[1];\n      link.execute = registration[2];\n    }\n\n    // process System.register declaration\n    else {\n      registerDeclarative(loader, load, link, registration[1]);\n    }\n\n    return load;\n  })\n  .catch(function (err) {\n    load.linkRecord = undefined;\n    throw load.loadError = load.loadError || addToError(err, 'Instantiating ' + load.key);\n  }));\n}\n\n// like resolveInstantiate, but returning load records for linking\nfunction resolveInstantiateDep (loader, key, parentKey, registry, state, traceDepMap) {\n  // normalization shortpaths for already-normalized key\n  // DISABLED to prioritise consistent resolver calls\n  // could add a plain name filter, but doesn't yet seem necessary for perf\n  /* var load = state.records[key];\n  var module = registry[key];\n\n  if (module) {\n    if (traceDepMap)\n      traceDepMap[key] = key;\n\n    // registry authority check in case module was deleted or replaced in main registry\n    if (load && load.module && load.module === module)\n      return load;\n    else\n      return module;\n  }\n\n  // already linked but not in main registry is ignored\n  if (load && !load.module) {\n    if (traceDepMap)\n      traceDepMap[key] = key;\n    return instantiate(loader, load, load.linkRecord, registry, state);\n  } */\n  return loader.resolve(key, parentKey)\n  .then(function (resolvedKey) {\n    if (traceDepMap)\n      traceDepMap[key] = resolvedKey;\n\n    // normalization shortpaths for already-normalized key\n    var load = state.records[resolvedKey];\n    var module = registry[resolvedKey];\n\n    // main loader registry always takes preference\n    if (module && (!load || load.module && module !== load.module))\n      return module;\n\n    if (load && load.loadError)\n      throw load.loadError;\n\n    // already has a module value but not already in the registry (load.module)\n    // means it was removed by registry.delete, so we should\n    // disgard the current load record creating a new one over it\n    // but keep any existing registration\n    if (!load || !module && load.module)\n      load = createLoadRecord(state, resolvedKey, load && load.registration);\n\n    var link = load.linkRecord;\n    if (!link)\n      return load;\n\n    return instantiate(loader, load, link, registry, state);\n  });\n}\n\nfunction traceLoad (loader, load, link) {\n  loader.loads = loader.loads || {};\n  loader.loads[load.key] = {\n    key: load.key,\n    deps: link.dependencies,\n    dynamicDeps: [],\n    depMap: link.depMap || {}\n  };\n}\n\n/*\n * Convert a CJS module.exports into a valid object for new Module:\n *\n *   new Module(getEsModule(module.exports))\n *\n * Sets the default value to the module, while also reading off named exports carefully.\n */\nfunction registerDeclarative (loader, load, link, declare) {\n  var moduleObj = link.moduleObj;\n  var importerSetters = load.importerSetters;\n\n  var definedExports = false;\n\n  // closure especially not based on link to allow link record disposal\n  var declared = declare.call(global, function (name, value) {\n    if (typeof name === 'object') {\n      var changed = false;\n      for (var p in name) {\n        value = name[p];\n        if (p !== '__useDefault' && (!(p in moduleObj) || moduleObj[p] !== value)) {\n          changed = true;\n          moduleObj[p] = value;\n        }\n      }\n      if (changed === false)\n        return value;\n    }\n    else {\n      if ((definedExports || name in moduleObj) && moduleObj[name] === value)\n        return value;\n      moduleObj[name] = value;\n    }\n\n    for (var i = 0; i < importerSetters.length; i++)\n      importerSetters[i](moduleObj);\n\n    return value;\n  }, new ContextualLoader(loader, load.key));\n\n  link.setters = declared.setters;\n  link.execute = declared.execute;\n  if (declared.exports) {\n    link.moduleObj = moduleObj = declared.exports;\n    definedExports = true;\n  }\n}\n\nfunction instantiateDeps (loader, load, link, registry, state) {\n  if (link.depsInstantiatePromise)\n    return link.depsInstantiatePromise;\n\n  var depsInstantiatePromises = Array(link.dependencies.length);\n\n  for (var i = 0; i < link.dependencies.length; i++)\n    depsInstantiatePromises[i] = resolveInstantiateDep(loader, link.dependencies[i], load.key, registry, state, loader.trace && link.depMap || (link.depMap = {}));\n\n  var depsInstantiatePromise = Promise.all(depsInstantiatePromises)\n  .then(function (dependencyInstantiations) {\n    link.dependencyInstantiations = dependencyInstantiations;\n\n    // run setters to set up bindings to instantiated dependencies\n    if (link.setters) {\n      for (var i = 0; i < dependencyInstantiations.length; i++) {\n        var setter = link.setters[i];\n        if (setter) {\n          var instantiation = dependencyInstantiations[i];\n\n          if (instantiation instanceof ModuleNamespace) {\n            setter(instantiation);\n          }\n          else {\n            if (instantiation.loadError)\n              throw instantiation.loadError;\n            setter(instantiation.module || instantiation.linkRecord.moduleObj);\n            // this applies to both es and dynamic registrations\n            if (instantiation.importerSetters)\n              instantiation.importerSetters.push(setter);\n          }\n        }\n      }\n    }\n\n    return load;\n  });\n\n  if (loader.trace)\n    depsInstantiatePromise = depsInstantiatePromise.then(function () {\n      traceLoad(loader, load, link);\n      return load;\n    });\n\n  depsInstantiatePromise = depsInstantiatePromise.catch(function (err) {\n    // throw up the instantiateDeps stack\n    link.depsInstantiatePromise = undefined;\n    throw addToError(err, 'Loading ' + load.key);\n  });\n\n  depsInstantiatePromise.catch(function () {});\n\n  return link.depsInstantiatePromise = depsInstantiatePromise;\n}\n\nfunction deepInstantiateDeps (loader, load, link, registry, state) {\n  return new Promise(function (resolve, reject) {\n    var seen = [];\n    var loadCnt = 0;\n    function queueLoad (load) {\n      var link = load.linkRecord;\n      if (!link)\n        return;\n\n      if (seen.indexOf(load) !== -1)\n        return;\n      seen.push(load);\n\n      loadCnt++;\n      instantiateDeps(loader, load, link, registry, state)\n      .then(processLoad, reject);\n    }\n    function processLoad (load) {\n      loadCnt--;\n      var link = load.linkRecord;\n      if (link) {\n        for (var i = 0; i < link.dependencies.length; i++) {\n          var depLoad = link.dependencyInstantiations[i];\n          if (!(depLoad instanceof ModuleNamespace))\n            queueLoad(depLoad);\n        }\n      }\n      if (loadCnt === 0)\n        resolve();\n    }\n    queueLoad(load);\n  });\n}\n\n/*\n * System.register\n */\nRegisterLoader.prototype.register = function (key, deps, declare) {\n  var state = this[REGISTER_INTERNAL];\n\n  // anonymous modules get stored as lastAnon\n  if (declare === undefined) {\n    state.lastRegister = [key, deps, undefined];\n  }\n\n  // everything else registers into the register cache\n  else {\n    var load = state.records[key] || createLoadRecord(state, key, undefined);\n    load.registration = [deps, declare, undefined];\n  }\n};\n\n/*\n * System.registerDyanmic\n */\nRegisterLoader.prototype.registerDynamic = function (key, deps, executingRequire, execute) {\n  var state = this[REGISTER_INTERNAL];\n\n  // anonymous modules get stored as lastAnon\n  if (typeof key !== 'string') {\n    state.lastRegister = [key, deps, executingRequire];\n  }\n\n  // everything else registers into the register cache\n  else {\n    var load = state.records[key] || createLoadRecord(state, key, undefined);\n    load.registration = [deps, executingRequire, execute];\n  }\n};\n\n// ContextualLoader class\n// backwards-compatible with previous System.register context argument by exposing .id, .key\nfunction ContextualLoader (loader, key) {\n  this.loader = loader;\n  this.key = this.id = key;\n  this.meta = {\n    url: key\n    // scriptElement: null\n  };\n}\n/*ContextualLoader.prototype.constructor = function () {\n  throw new TypeError('Cannot subclass the contextual loader only Reflect.Loader.');\n};*/\nContextualLoader.prototype.import = function (key) {\n  if (this.loader.trace)\n    this.loader.loads[this.key].dynamicDeps.push(key);\n  return this.loader.import(key, this.key);\n};\n/*ContextualLoader.prototype.resolve = function (key) {\n  return this.loader.resolve(key, this.key);\n};*/\n\n// this is the execution function bound to the Module namespace record\nfunction ensureEvaluate (loader, load, link, registry, state, seen) {\n  if (load.module)\n    return load.module;\n\n  if (load.evalError)\n    throw load.evalError;\n\n  if (seen && seen.indexOf(load) !== -1)\n    return load.linkRecord.moduleObj;\n\n  // for ES loads we always run ensureEvaluate on top-level, so empty seen is passed regardless\n  // for dynamic loads, we pass seen if also dynamic\n  var err = doEvaluate(loader, load, link, registry, state, link.setters ? [] : seen || []);\n  if (err)\n    throw err;\n\n  return load.module;\n}\n\nfunction makeDynamicRequire (loader, key, dependencies, dependencyInstantiations, registry, state, seen) {\n  // we can only require from already-known dependencies\n  return function (name) {\n    for (var i = 0; i < dependencies.length; i++) {\n      if (dependencies[i] === name) {\n        var depLoad = dependencyInstantiations[i];\n        var module;\n\n        if (depLoad instanceof ModuleNamespace)\n          module = depLoad;\n        else\n          module = ensureEvaluate(loader, depLoad, depLoad.linkRecord, registry, state, seen);\n\n        return '__useDefault' in module ? module.__useDefault : module;\n      }\n    }\n    throw new Error('Module ' + name + ' not declared as a System.registerDynamic dependency of ' + key);\n  };\n}\n\n// ensures the given es load is evaluated\n// returns the error if any\nfunction doEvaluate (loader, load, link, registry, state, seen) {\n  seen.push(load);\n\n  var err;\n\n  // es modules evaluate dependencies first\n  // non es modules explicitly call moduleEvaluate through require\n  if (link.setters) {\n    var depLoad, depLink;\n    for (var i = 0; i < link.dependencies.length; i++) {\n      depLoad = link.dependencyInstantiations[i];\n\n      if (depLoad instanceof ModuleNamespace)\n        continue;\n\n      // custom Module returned from instantiate\n      depLink = depLoad.linkRecord;\n      if (depLink && seen.indexOf(depLoad) === -1) {\n        if (depLoad.evalError)\n          err = depLoad.evalError;\n        else\n          // dynamic / declarative boundaries clear the \"seen\" list\n          // we just let cross format circular throw as would happen in real implementations\n          err = doEvaluate(loader, depLoad, depLink, registry, state, depLink.setters ? seen : []);\n      }\n\n      if (err) {\n        load.linkRecord = undefined;\n        load.evalError = addToError(err, 'Evaluating ' + load.key);\n        return load.evalError;\n      }\n    }\n  }\n\n  // link.execute won't exist for Module returns from instantiate on top-level load\n  if (link.execute) {\n    // ES System.register execute\n    // \"this\" is null in ES\n    if (link.setters) {\n      err = declarativeExecute(link.execute);\n    }\n    // System.registerDynamic execute\n    // \"this\" is \"exports\" in CJS\n    else {\n      var module = { id: load.key };\n      var moduleObj = link.moduleObj;\n      Object.defineProperty(module, 'exports', {\n        configurable: true,\n        set: function (exports) {\n          moduleObj.default = moduleObj.__useDefault = exports;\n        },\n        get: function () {\n          return moduleObj.__useDefault;\n        }\n      });\n\n      var require = makeDynamicRequire(loader, load.key, link.dependencies, link.dependencyInstantiations, registry, state, seen);\n\n      // evaluate deps first\n      if (!link.executingRequire)\n        for (var i = 0; i < link.dependencies.length; i++)\n          require(link.dependencies[i]);\n\n      err = dynamicExecute(link.execute, require, moduleObj.default, module);\n\n      // pick up defineProperty calls to module.exports when we can\n      if (module.exports !== moduleObj.__useDefault)\n        moduleObj.default = moduleObj.__useDefault = module.exports;\n\n      var moduleDefault = moduleObj.default;\n\n      // __esModule flag extension support via lifting\n      if (moduleDefault && moduleDefault.__esModule) {\n        for (var p in moduleDefault) {\n          if (Object.hasOwnProperty.call(moduleDefault, p))\n            moduleObj[p] = moduleDefault[p];\n        }\n      }\n    }\n  }\n\n  // dispose link record\n  load.linkRecord = undefined;\n\n  if (err)\n    return load.evalError = addToError(err, 'Evaluating ' + load.key);\n\n  registry[load.key] = load.module = new ModuleNamespace(link.moduleObj);\n\n  // if not an esm module, run importer setters and clear them\n  // this allows dynamic modules to update themselves into es modules\n  // as soon as execution has completed\n  if (!link.setters) {\n    if (load.importerSetters)\n      for (var i = 0; i < load.importerSetters.length; i++)\n        load.importerSetters[i](load.module);\n    load.importerSetters = undefined;\n  }\n}\n\n// {} is the closest we can get to call(undefined)\nvar nullContext = {};\nif (Object.freeze)\n  Object.freeze(nullContext);\n\nfunction declarativeExecute (execute) {\n  try {\n    execute.call(nullContext);\n  }\n  catch (e) {\n    return e;\n  }\n}\n\nfunction dynamicExecute (execute, require, exports, module) {\n  try {\n    var output = execute.call(global, require, exports, module);\n    if (output !== undefined)\n      module.exports = output;\n  }\n  catch (e) {\n    return e;\n  }\n}\n","import { resolveIfNotPlain } from 'es-module-loader/core/resolve.js';\r\nimport { baseURI, isBrowser, isWindows, addToError, global, createSymbol } from 'es-module-loader/core/common.js';\r\nimport RegisterLoader from 'es-module-loader/core/register-loader.js';\r\nimport { ModuleNamespace } from 'es-module-loader/core/loader-polyfill.js';\r\n\r\nexport { baseURI, isBrowser, isWindows, addToError, global, resolveIfNotPlain, ModuleNamespace }\r\n\r\nexport var resolvedPromise = Promise.resolve();\r\nexport function noop () {};\r\n\r\nexport var emptyModule = new ModuleNamespace({});\r\n\r\nexport function protectedCreateNamespace (bindings) {\r\n  if (bindings instanceof ModuleNamespace)\r\n    return bindings;\r\n\r\n  if (bindings && bindings.__esModule)\r\n    return new ModuleNamespace(bindings);\r\n\r\n  return new ModuleNamespace({ default: bindings, __useDefault: bindings });\r\n}\r\n\r\nvar hasStringTag;\r\nexport function isModule (m) {\r\n  if (hasStringTag === undefined)\r\n    hasStringTag = typeof Symbol !== 'undefined' && !!Symbol.toStringTag;\r\n  return m instanceof ModuleNamespace || hasStringTag && Object.prototype.toString.call(m) == '[object Module]';\r\n}\r\n\r\nexport var CONFIG = createSymbol('loader-config');\r\nexport var METADATA = createSymbol('metadata');\r\nexport var PLAIN_RESOLVE = createSymbol('plain-resolve');\r\nexport var PLAIN_RESOLVE_SYNC = createSymbol('plain-resolve-sync');\r\n\r\nexport var isWorker = typeof window === 'undefined' && typeof self !== 'undefined' && typeof importScripts !== 'undefined';\r\n\r\nexport function warn (msg, force) {\r\n  if (force || this.warnings && typeof console !== 'undefined' && console.warn)\r\n    console.warn(msg);\r\n}\r\n\r\nexport function checkInstantiateWasm (loader, wasmBuffer, processAnonRegister) {\r\n  var bytes = new Uint8Array(wasmBuffer);\r\n\r\n  // detect by leading bytes\r\n  // Can be (new Uint32Array(fetched))[0] === 0x6D736100 when working in Node\r\n  if (bytes[0] === 0 && bytes[1] === 97 && bytes[2] === 115) {\r\n    return WebAssembly.compile(wasmBuffer).then(function (m) {\r\n      var deps = [];\r\n      var setters = [];\r\n      var importObj = {};\r\n\r\n      // we can only set imports if supported (eg Safari doesnt support)\r\n      if (WebAssembly.Module.imports)\r\n        WebAssembly.Module.imports(m).forEach(function (i) {\r\n          var key = i.module;\r\n          setters.push(function (m) {\r\n            importObj[key] = m;\r\n          });\r\n          if (deps.indexOf(key) === -1)\r\n            deps.push(key);\r\n        });\r\n      loader.register(deps, function (_export) {\r\n        return {\r\n          setters: setters,\r\n          execute: function () {\r\n            _export(new WebAssembly.Instance(m, importObj).exports);\r\n          }\r\n        };\r\n      });\r\n      processAnonRegister();\r\n\r\n      return true;\r\n    });\r\n  }\r\n\r\n  return Promise.resolve(false);\r\n}\r\n\r\nvar parentModuleContext;\r\nexport function loadNodeModule (key, baseURL) {\r\n  if (key[0] === '.')\r\n    throw new Error('Node module ' + key + ' can\\'t be loaded as it is not a package require.');\r\n\r\n  if (!parentModuleContext) {\r\n    var Module = this._nodeRequire('module');\r\n    var base = decodeURI(baseURL.substr(isWindows ? 8 : 7));\r\n    parentModuleContext = new Module(base);\r\n    parentModuleContext.paths = Module._nodeModulePaths(base);\r\n  }\r\n  return parentModuleContext.require(key);\r\n}\r\n\r\nexport function extend (a, b) {\r\n  for (var p in b) {\r\n    if (!Object.hasOwnProperty.call(b, p))\r\n      continue;\r\n    a[p] = b[p];\r\n  }\r\n  return a;\r\n}\r\n\r\nexport function prepend (a, b) {\r\n  for (var p in b) {\r\n    if (!Object.hasOwnProperty.call(b, p))\r\n      continue;\r\n    if (a[p] === undefined)\r\n      a[p] = b[p];\r\n  }\r\n  return a;\r\n}\r\n\r\n// meta first-level extends where:\r\n// array + array appends\r\n// object + object extends\r\n// other properties replace\r\nexport function extendMeta (a, b, _prepend) {\r\n  for (var p in b) {\r\n    if (!Object.hasOwnProperty.call(b, p))\r\n      continue;\r\n    var val = b[p];\r\n    if (a[p] === undefined)\r\n      a[p] = val;\r\n    else if (val instanceof Array && a[p] instanceof Array)\r\n      a[p] = [].concat(_prepend ? val : a[p]).concat(_prepend ? a[p] : val);\r\n    else if (typeof val == 'object' && val !== null && typeof a[p] == 'object')\r\n      a[p] = (_prepend ? prepend : extend)(extend({}, a[p]), val);\r\n    else if (!_prepend)\r\n      a[p] = val;\r\n  }\r\n}\r\n\r\nvar supportsPreload = false, supportsPrefetch = false;\r\nif (isBrowser)\r\n  (function () {\r\n    var relList = document.createElement('link').relList;\r\n    if (relList && relList.supports) {\r\n      supportsPrefetch = true;\r\n      try {\r\n        supportsPreload = relList.supports('preload');\r\n      }\r\n      catch (e) {}\r\n    }\r\n  })();\r\n\r\nexport function preloadScript (url) {\r\n  // fallback to old fashioned image technique which still works in safari\r\n  if (!supportsPreload && !supportsPrefetch) {\r\n    var preloadImage = new Image();\r\n    preloadImage.src = url;\r\n    return;\r\n  }\r\n\r\n  var link = document.createElement('link');\r\n  if (supportsPreload) {\r\n    link.rel = 'preload';\r\n    link.as = 'script';\r\n  }\r\n  else {\r\n    // this works for all except Safari (detected by relList.supports lacking)\r\n    link.rel = 'prefetch';\r\n  }\r\n  link.href = url;\r\n  document.head.appendChild(link);\r\n}\r\n\r\nfunction workerImport (src, resolve, reject) {\r\n  try {\r\n    importScripts(src);\r\n  }\r\n  catch (e) {\r\n    reject(e);\r\n  }\r\n  resolve();\r\n}\r\n\r\nif (isBrowser) {\r\n  var onerror = window.onerror;\r\n  window.onerror = function globalOnerror (msg, src) {\r\n    if (onerror)\r\n      onerror.apply(this, arguments);\r\n  };\r\n}\r\n\r\nexport function scriptLoad (src, crossOrigin, integrity, resolve, reject) {\r\n  // percent encode just \"#\" for HTTP requests\r\n  src = src.replace(/#/g, '%23');\r\n\r\n  // subresource integrity is not supported in web workers\r\n  if (isWorker)\r\n    return workerImport(src, resolve, reject);\r\n\r\n  var script = document.createElement('script');\r\n  script.type = 'text/javascript';\r\n  script.charset = 'utf-8';\r\n  script.async = true;\r\n\r\n  if (crossOrigin)\r\n    script.crossOrigin = crossOrigin;\r\n  if (integrity)\r\n    script.integrity = integrity;\r\n\r\n  script.addEventListener('load', load, false);\r\n  script.addEventListener('error', error, false);\r\n\r\n  script.src = src;\r\n  document.head.appendChild(script);\r\n\r\n  function load () {\r\n    resolve();\r\n    cleanup();\r\n  }\r\n\r\n  // note this does not catch execution errors\r\n  function error (err) {\r\n    cleanup();\r\n    reject(new Error('Fetching ' + src));\r\n  }\r\n\r\n  function cleanup () {\r\n    script.removeEventListener('load', load, false);\r\n    script.removeEventListener('error', error, false);\r\n    document.head.removeChild(script);\r\n  }\r\n}\r\n\r\nexport function readMemberExpression (p, value) {\r\n  var pParts = p.split('.');\r\n  while (pParts.length)\r\n    value = value[pParts.shift()];\r\n  return value;\r\n}\r\n\r\n// separate out paths cache as a baseURL lock process\r\nexport function applyPaths (baseURL, paths, key) {\r\n  var mapMatch = getMapMatch(paths, key);\r\n  if (mapMatch) {\r\n    var target = paths[mapMatch] + key.substr(mapMatch.length);\r\n\r\n    var resolved = resolveIfNotPlain(target, baseURI);\r\n    if (resolved !== undefined)\r\n      return resolved;\r\n\r\n    return baseURL + target;\r\n  }\r\n  else if (key.indexOf(':') !== -1) {\r\n    return key;\r\n  }\r\n  else {\r\n    return baseURL + key;\r\n  }\r\n}\r\n\r\nfunction checkMap (p) {\r\n  var name = this.name;\r\n  // can add ':' here if we want paths to match the behaviour of map\r\n  if (name.substr(0, p.length) === p && (name.length === p.length || name[p.length] === '/' || p[p.length - 1] === '/' || p[p.length - 1] === ':')) {\r\n    var curLen = p.split('/').length;\r\n    if (curLen > this.len) {\r\n      this.match = p;\r\n      this.len = curLen;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getMapMatch (map, name) {\r\n  if (Object.hasOwnProperty.call(map, name))\r\n    return name;\r\n\r\n  var bestMatch = {\r\n    name: name,\r\n    match: undefined,\r\n    len: 0\r\n  };\r\n\r\n  Object.keys(map).forEach(checkMap, bestMatch);\r\n\r\n  return bestMatch.match;\r\n}\r\n\r\n// RegEx adjusted from https://github.com/jbrantly/yabble/blob/master/lib/yabble.js#L339\r\nexport var cjsRequireRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.\"'])require\\s*\\(\\s*(\"[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*\"|'[^'\\\\]*(?:\\\\.[^'\\\\]*)*'|`[^`\\\\]*(?:\\\\.[^`\\\\]*)*`)\\s*\\)/g\r\n","import { isWindows } from './common.js';\r\n\r\n/*\r\n * Source loading\r\n */\r\nfunction fetchFetch (url, authorization, integrity, asBuffer) {\r\n  // fetch doesn't support file:/// urls\r\n  if (url.substr(0, 8) === 'file:///') {\r\n    if (hasXhr)\r\n      return xhrFetch(url, authorization, integrity, asBuffer);\r\n    else\r\n      throw new Error('Unable to fetch file URLs in this environment.');\r\n  }\r\n\r\n  // percent encode just \"#\" for HTTP requests\r\n  url = url.replace(/#/g, '%23');\r\n\r\n  var opts = {\r\n    // NB deprecate\r\n    headers: { Accept: 'application/x-es-module, */*' }\r\n  };\r\n\r\n  if (integrity)\r\n    opts.integrity = integrity;\r\n\r\n  if (authorization) {\r\n    if (typeof authorization == 'string')\r\n      opts.headers['Authorization'] = authorization;\r\n    opts.credentials = 'include';\r\n  }\r\n\r\n  return fetch(url, opts)\r\n  .then(function(res) {\r\n    if (res.ok)\r\n      return asBuffer ? res.arrayBuffer() : res.text();\r\n    else\r\n      throw new Error('Fetch error: ' + res.status + ' ' + res.statusText);\r\n  });\r\n}\r\n\r\nfunction xhrFetch (url, authorization, integrity, asBuffer) {\r\n  return new Promise(function (resolve, reject) {\r\n    // percent encode just \"#\" for HTTP requests\r\n    url = url.replace(/#/g, '%23');\r\n\r\n    var xhr = new XMLHttpRequest();\r\n    if (asBuffer)\r\n      xhr.responseType = 'arraybuffer';\r\n    function load() {\r\n      resolve(asBuffer ? xhr.response : xhr.responseText);\r\n    }\r\n    function error() {\r\n      reject(new Error('XHR error: ' + (xhr.status ? ' (' + xhr.status + (xhr.statusText ? ' ' + xhr.statusText  : '') + ')' : '') + ' loading ' + url));\r\n    }\r\n\r\n    xhr.onreadystatechange = function () {\r\n      if (xhr.readyState === 4) {\r\n        // in Chrome on file:/// URLs, status is 0\r\n        if (xhr.status == 0) {\r\n          if (xhr.response) {\r\n            load();\r\n          }\r\n          else {\r\n            // when responseText is empty, wait for load or error event\r\n            // to inform if it is a 404 or empty file\r\n            xhr.addEventListener('error', error);\r\n            xhr.addEventListener('load', load);\r\n          }\r\n        }\r\n        else if (xhr.status === 200) {\r\n          load();\r\n        }\r\n        else {\r\n          error();\r\n        }\r\n      }\r\n    };\r\n    xhr.open(\"GET\", url, true);\r\n\r\n    if (xhr.setRequestHeader) {\r\n      xhr.setRequestHeader('Accept', 'application/x-es-module, */*');\r\n      // can set \"authorization: true\" to enable withCredentials only\r\n      if (authorization) {\r\n        if (typeof authorization == 'string')\r\n          xhr.setRequestHeader('Authorization', authorization);\r\n        xhr.withCredentials = true;\r\n      }\r\n    }\r\n\r\n    xhr.send(null);\r\n  });\r\n}\r\n\r\nvar fs;\r\nfunction nodeFetch (url, authorization, integrity, asBuffer) {\r\n  if (url.substr(0, 8) != 'file:///') {\r\n    if (hasFetch)\r\n      return fetchFetch(url, authorization, integrity, asBuffer);\r\n    else\r\n      return Promise.reject(new Error('Unable to fetch \"' + url + '\". Only file URLs of the form file:/// supported running in Node without fetch.'));\r\n  }\r\n  \r\n  fs = fs || require('fs');\r\n  if (isWindows)\r\n    url = url.replace(/\\//g, '\\\\').substr(8);\r\n  else\r\n    url = url.substr(7);\r\n\r\n  return new Promise(function (resolve, reject) {\r\n    fs.readFile(url, function(err, data) {\r\n      if (err) {\r\n        return reject(err);\r\n      }\r\n      else {\r\n        if (asBuffer) {\r\n          resolve(data);\r\n        }\r\n        else {\r\n          // Strip Byte Order Mark out if it's the leading char\r\n          var dataString = data + '';\r\n          if (dataString[0] === '\\ufeff')\r\n            dataString = dataString.substr(1);\r\n\r\n          resolve(dataString);\r\n        }\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction noFetch () {\r\n  throw new Error('No fetch method is defined for this environment.');\r\n}\r\n\r\nvar fetchFunction;\r\n\r\nvar hasXhr = typeof XMLHttpRequest !== 'undefined';\r\nvar hasFetch = typeof fetch !== 'undefined';\r\n\r\nif (typeof self !== 'undefined' && typeof self.fetch !== 'undefined')\r\n fetchFunction = fetchFetch;\r\nelse if (hasXhr)\r\n  fetchFunction = xhrFetch;\r\nelse if (typeof require !== 'undefined' && typeof process !== 'undefined')\r\n  fetchFunction = nodeFetch;\r\nelse\r\n  fetchFunction = noFetch;\r\n\r\nexport default fetchFunction;\r\n","import RegisterLoader from 'es-module-loader/core/register-loader.js';\r\nimport { getMapMatch, readMemberExpression, extendMeta, addToError, resolveIfNotPlain,\r\n    baseURI, CONFIG, METADATA, applyPaths, resolvedPromise, getPackage } from './common.js';\r\nimport { setPkgConfig, createPackage } from './config.js';\r\nimport fetch from './fetch.js';\r\n\r\nexport function createMetadata () {\r\n  return {\r\n    pluginKey: undefined,\r\n    pluginArgument: undefined,\r\n    pluginModule: undefined,\r\n    packageKey: undefined,\r\n    packageConfig: undefined,\r\n    load: undefined\r\n  };\r\n}\r\n\r\nfunction getCoreParentMetadata (loader, config, parentKey) {\r\n  var parentMetadata = createMetadata();\r\n\r\n  if (parentKey) {\r\n    // detect parent plugin\r\n    // we just need pluginKey to be truthy for package configurations\r\n    // so we duplicate it as pluginArgument - although not correct its not used\r\n    var parentPluginIndex;\r\n    if (config.pluginFirst) {\r\n      if ((parentPluginIndex = parentKey.lastIndexOf('!')) !== -1)\r\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(0, parentPluginIndex);\r\n    }\r\n    else {\r\n      if ((parentPluginIndex = parentKey.indexOf('!')) !== -1)\r\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(parentPluginIndex + 1);\r\n    }\r\n  }\r\n\r\n  return parentMetadata;\r\n}\r\n\r\nfunction getParentMetadata (loader, config, parentKey) {\r\n  var parentMetadata = createMetadata();\r\n\r\n  if (parentKey) {\r\n    // detect parent plugin\r\n    // we just need pluginKey to be truthy for package configurations\r\n    // so we duplicate it as pluginArgument - although not correct its not used\r\n    var parentPluginIndex;\r\n    if (config.pluginFirst) {\r\n      if ((parentPluginIndex = parentKey.lastIndexOf('!')) !== -1)\r\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(0, parentPluginIndex);\r\n    }\r\n    else {\r\n      if ((parentPluginIndex = parentKey.indexOf('!')) !== -1)\r\n        parentMetadata.pluginArgument = parentMetadata.pluginKey = parentKey.substr(parentPluginIndex + 1);\r\n    }\r\n\r\n    // detect parent package\r\n    parentMetadata.packageKey = getMapMatch(config.packages, parentKey);\r\n    if (parentMetadata.packageKey)\r\n      parentMetadata.packageConfig = config.packages[parentMetadata.packageKey];\r\n  }\r\n\r\n  return parentMetadata;\r\n}\r\n\r\nexport function normalize (key, parentKey) {\r\n  var config = this[CONFIG];\r\n\r\n  var metadata = createMetadata();\r\n  var parentMetadata = getParentMetadata(this, config, parentKey);\r\n\r\n  var loader = this;\r\n\r\n  return Promise.resolve()\r\n\r\n  // boolean conditional\r\n  .then(function () {\r\n    // first we normalize the conditional\r\n    var booleanIndex = key.lastIndexOf('#?');\r\n\r\n    if (booleanIndex === -1)\r\n      return Promise.resolve(key);\r\n\r\n    var conditionObj = parseCondition.call(loader, key.substr(booleanIndex + 2));\r\n\r\n    // in builds, return normalized conditional\r\n    /*if (this.builder)\r\n      return this.resolve(conditionObj.module, parentKey)\r\n      .then(function (conditionModule) {\r\n        conditionObj.module = conditionModule;\r\n        return key.substr(0, booleanIndex) + '#?' + serializeCondition(conditionObj);\r\n      });*/\r\n\r\n    return resolveCondition.call(loader, conditionObj, parentKey, true)\r\n    .then(function (conditionValue) {\r\n      return conditionValue ? key.substr(0, booleanIndex) : '@empty';\r\n    });\r\n  })\r\n\r\n  // plugin\r\n  .then(function (key) {\r\n    var parsed = parsePlugin(config.pluginFirst, key);\r\n\r\n    if (!parsed)\r\n      return packageResolve.call(loader, config, key, parentMetadata && parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, false);\r\n\r\n    metadata.pluginKey = parsed.plugin;\r\n\r\n    return Promise.all([\r\n      packageResolve.call(loader, config, parsed.argument, parentMetadata && parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, true),\r\n      loader.resolve(parsed.plugin, parentKey)\r\n    ])\r\n    .then(function (normalized) {\r\n      metadata.pluginArgument = normalized[0];\r\n      metadata.pluginKey = normalized[1];\r\n\r\n      // don't allow a plugin to load itself\r\n      if (metadata.pluginArgument === metadata.pluginKey)\r\n        throw new Error('Plugin ' + metadata.pluginArgument + ' cannot load itself, make sure it is excluded from any wildcard meta configuration via a custom loader: false rule.');\r\n\r\n      return combinePluginParts(config.pluginFirst, normalized[0], normalized[1]);\r\n    });\r\n  })\r\n  .then(function (normalized) {\r\n    return interpolateConditional.call(loader, normalized, parentKey, parentMetadata);\r\n  })\r\n  .then(function (normalized) {\r\n    setMeta.call(loader, config, normalized, metadata);\r\n\r\n    if (metadata.pluginKey || !metadata.load.loader)\r\n      return normalized;\r\n\r\n    // loader by configuration\r\n    // normalizes to parent to support package loaders\r\n    return loader.resolve(metadata.load.loader, normalized)\r\n    .then(function (pluginKey) {\r\n      metadata.pluginKey = pluginKey;\r\n      metadata.pluginArgument = normalized;\r\n      return normalized;\r\n    });\r\n  })\r\n  .then(function (normalized) {\r\n    loader[METADATA][normalized] = metadata;\r\n    return normalized;\r\n  });\r\n}\r\n\r\n// normalization function used for registry keys\r\n// just does coreResolve without map\r\nexport function decanonicalize (config, key) {\r\n  var parsed = parsePlugin(config.pluginFirst, key);\r\n\r\n  // plugin\r\n  if (parsed) {\r\n    var pluginKey = decanonicalize.call(this, config, parsed.plugin);\r\n    return combinePluginParts(config.pluginFirst, coreResolve.call(this, config, parsed.argument, undefined, false, false), pluginKey);\r\n  }\r\n\r\n  return coreResolve.call(this, config, key, undefined, false, false);\r\n}\r\n\r\nexport function normalizeSync (key, parentKey) {\r\n  var config = this[CONFIG];\r\n\r\n  // normalizeSync is metadataless, so create metadata\r\n  var metadata = createMetadata();\r\n  var parentMetadata = parentMetadata || getParentMetadata(this, config, parentKey);\r\n\r\n  var parsed = parsePlugin(config.pluginFirst, key);\r\n\r\n  // plugin\r\n  if (parsed) {\r\n    metadata.pluginKey = normalizeSync.call(this, parsed.plugin, parentKey);\r\n    return combinePluginParts(config.pluginFirst,\r\n        packageResolveSync.call(this, config, parsed.argument, parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, !!metadata.pluginKey),\r\n        metadata.pluginKey);\r\n  }\r\n\r\n  return packageResolveSync.call(this, config, key, parentMetadata.pluginArgument || parentKey, metadata, parentMetadata, !!metadata.pluginKey);\r\n}\r\n\r\nexport function coreResolve (config, key, parentKey, doMap, packageName) {\r\n  var relativeResolved = resolveIfNotPlain(key, parentKey || baseURI);\r\n\r\n  // standard URL resolution\r\n  if (relativeResolved)\r\n    return applyPaths(config.baseURL, config.paths, relativeResolved);\r\n\r\n  // plain keys not starting with './', 'x://' and '/' go through custom resolution\r\n  if (doMap) {\r\n    var mapMatch = getMapMatch(config.map, key);\r\n\r\n    if (mapMatch) {\r\n      key = config.map[mapMatch] + key.substr(mapMatch.length);\r\n\r\n      relativeResolved = resolveIfNotPlain(key, baseURI);\r\n      if (relativeResolved)\r\n        return applyPaths(config.baseURL, config.paths, relativeResolved);\r\n    }\r\n  }\r\n\r\n  if (this.registry.has(key))\r\n    return key;\r\n\r\n  if (key.substr(0, 6) === '@node/')\r\n    return key;\r\n\r\n  var trailingSlash = packageName && key[key.length - 1] !== '/';\r\n  var resolved = applyPaths(config.baseURL, config.paths, trailingSlash ? key + '/' : key);\r\n  if (trailingSlash)\r\n    return resolved.substr(0, resolved.length - 1);\r\n  return resolved;\r\n}\r\n\r\nfunction packageResolveSync (config, key, parentKey, metadata, parentMetadata, skipExtensions) {\r\n  // ignore . since internal maps handled by standard package resolution\r\n  if (parentMetadata && parentMetadata.packageConfig && key[0] !== '.') {\r\n    var parentMap = parentMetadata.packageConfig.map;\r\n    var parentMapMatch = parentMap && getMapMatch(parentMap, key);\r\n\r\n    if (parentMapMatch && typeof parentMap[parentMapMatch] === 'string') {\r\n      var mapped = doMapSync(this, config, parentMetadata.packageConfig, parentMetadata.packageKey, parentMapMatch, key, metadata, skipExtensions);\r\n      if (mapped)\r\n        return mapped;\r\n    }\r\n  }\r\n\r\n  var normalized = coreResolve.call(this, config, key, parentKey, true, true);\r\n\r\n  var pkgConfigMatch = getPackageConfigMatch(config, normalized);\r\n  metadata.packageKey = pkgConfigMatch && pkgConfigMatch.packageKey || getMapMatch(config.packages, normalized);\r\n\r\n  if (!metadata.packageKey)\r\n    return normalized;\r\n\r\n  if (config.packageConfigKeys.indexOf(normalized) !== -1) {\r\n    metadata.packageKey = undefined;\r\n    return normalized;\r\n  }\r\n\r\n  metadata.packageConfig = config.packages[metadata.packageKey] || (config.packages[metadata.packageKey] = createPackage());\r\n\r\n  var subPath = normalized.substr(metadata.packageKey.length + 1);\r\n\r\n  return applyPackageConfigSync(this, config, metadata.packageConfig, metadata.packageKey, subPath, metadata, skipExtensions);\r\n}\r\n\r\nfunction packageResolve (config, key, parentKey, metadata, parentMetadata, skipExtensions) {\r\n  var loader = this;\r\n\r\n  return resolvedPromise\r\n  .then(function () {\r\n    // ignore . since internal maps handled by standard package resolution\r\n    if (parentMetadata && parentMetadata.packageConfig && key.substr(0, 2) !== './') {\r\n      var parentMap = parentMetadata.packageConfig.map;\r\n      var parentMapMatch = parentMap && getMapMatch(parentMap, key);\r\n\r\n      if (parentMapMatch)\r\n        return doMap(loader, config, parentMetadata.packageConfig, parentMetadata.packageKey, parentMapMatch, key, metadata, skipExtensions);\r\n    }\r\n\r\n    return resolvedPromise;\r\n  })\r\n  .then(function (mapped) {\r\n    if (mapped)\r\n      return mapped;\r\n\r\n    // apply map, core, paths, contextual package map\r\n    var normalized = coreResolve.call(loader, config, key, parentKey, true, true);\r\n\r\n    var pkgConfigMatch = getPackageConfigMatch(config, normalized);\r\n    metadata.packageKey = pkgConfigMatch && pkgConfigMatch.packageKey || getMapMatch(config.packages, normalized);\r\n\r\n    if (!metadata.packageKey)\r\n      return Promise.resolve(normalized);\r\n\r\n    if (config.packageConfigKeys.indexOf(normalized) !== -1) {\r\n      metadata.packageKey = undefined;\r\n      metadata.load = createMeta();\r\n      metadata.load.format = 'json';\r\n      // ensure no loader\r\n      metadata.load.loader = '';\r\n      return Promise.resolve(normalized);\r\n    }\r\n\r\n    metadata.packageConfig = config.packages[metadata.packageKey] || (config.packages[metadata.packageKey] = createPackage());\r\n\r\n    // load configuration when it matches packageConfigPaths, not already configured, and not the config itself\r\n    var loadConfig = pkgConfigMatch && !metadata.packageConfig.configured;\r\n\r\n    return (loadConfig ? loadPackageConfigPath(loader, config, pkgConfigMatch.configPath, metadata) : resolvedPromise)\r\n    .then(function () {\r\n      var subPath = normalized.substr(metadata.packageKey.length + 1);\r\n\r\n      return applyPackageConfig(loader, config, metadata.packageConfig, metadata.packageKey, subPath, metadata, skipExtensions);\r\n    });\r\n  });\r\n}\r\n\r\nfunction createMeta () {\r\n  return {\r\n    extension: '',\r\n    deps: undefined,\r\n    format: undefined,\r\n    loader: undefined,\r\n    scriptLoad: undefined,\r\n    globals: undefined,\r\n    nonce: undefined,\r\n    integrity: undefined,\r\n    sourceMap: undefined,\r\n    exports: undefined,\r\n    encapsulateGlobal: false,\r\n    crossOrigin: undefined,\r\n    cjsRequireDetection: true,\r\n    cjsDeferDepsExecute: false,\r\n    esModule: false\r\n  };\r\n}\r\n\r\nfunction setMeta (config, key, metadata) {\r\n  metadata.load = metadata.load || createMeta();\r\n\r\n  // apply wildcard metas\r\n  var bestDepth = 0;\r\n  var wildcardIndex;\r\n  for (var module in config.meta) {\r\n    wildcardIndex = module.indexOf('*');\r\n    if (wildcardIndex === -1)\r\n      continue;\r\n    if (module.substr(0, wildcardIndex) === key.substr(0, wildcardIndex)\r\n        && module.substr(wildcardIndex + 1) === key.substr(key.length - module.length + wildcardIndex + 1)) {\r\n      var depth = module.split('/').length;\r\n      if (depth > bestDepth)\r\n        bestDepth = depth;\r\n      extendMeta(metadata.load, config.meta[module], bestDepth !== depth);\r\n    }\r\n  }\r\n\r\n  // apply exact meta\r\n  if (config.meta[key])\r\n    extendMeta(metadata.load, config.meta[key], false);\r\n\r\n  // apply package meta\r\n  if (metadata.packageKey) {\r\n    var subPath = key.substr(metadata.packageKey.length + 1);\r\n\r\n    var meta = {};\r\n    if (metadata.packageConfig.meta) {\r\n      var bestDepth = 0;\r\n      getMetaMatches(metadata.packageConfig.meta, subPath, function (metaPattern, matchMeta, matchDepth) {\r\n        if (matchDepth > bestDepth)\r\n          bestDepth = matchDepth;\r\n        extendMeta(meta, matchMeta, matchDepth && bestDepth > matchDepth);\r\n      });\r\n\r\n      extendMeta(metadata.load, meta, false);\r\n    }\r\n\r\n    // format\r\n    if (metadata.packageConfig.format && !metadata.pluginKey && !metadata.load.loader)\r\n      metadata.load.format = metadata.load.format || metadata.packageConfig.format;\r\n  }\r\n}\r\n\r\nfunction parsePlugin (pluginFirst, key) {\r\n  var argumentKey;\r\n  var pluginKey;\r\n\r\n  var pluginIndex = pluginFirst ? key.indexOf('!') : key.lastIndexOf('!');\r\n\r\n  if (pluginIndex === -1)\r\n    return;\r\n\r\n  if (pluginFirst) {\r\n    argumentKey = key.substr(pluginIndex + 1);\r\n    pluginKey = key.substr(0, pluginIndex);\r\n  }\r\n  else {\r\n    argumentKey = key.substr(0, pluginIndex);\r\n    pluginKey = key.substr(pluginIndex + 1) || argumentKey.substr(argumentKey.lastIndexOf('.') + 1);\r\n  }\r\n\r\n  return {\r\n    argument: argumentKey,\r\n    plugin: pluginKey\r\n  };\r\n}\r\n\r\n// put key back together after parts have been normalized\r\nfunction combinePluginParts (pluginFirst, argumentKey, pluginKey) {\r\n  if (pluginFirst)\r\n    return pluginKey + '!' + argumentKey;\r\n  else\r\n    return argumentKey + '!' + pluginKey;\r\n}\r\n\r\n/*\r\n * Package Configuration Extension\r\n *\r\n * Example:\r\n *\r\n * SystemJS.packages = {\r\n *   jquery: {\r\n *     main: 'index.js', // when not set, package key is requested directly\r\n *     format: 'amd',\r\n *     defaultExtension: 'ts', // defaults to 'js', can be set to false\r\n *     modules: {\r\n *       '*.ts': {\r\n *         loader: 'typescript'\r\n *       },\r\n *       'vendor/sizzle.js': {\r\n *         format: 'global'\r\n *       }\r\n *     },\r\n *     map: {\r\n *        // map internal require('sizzle') to local require('./vendor/sizzle')\r\n *        sizzle: './vendor/sizzle.js',\r\n *        // map any internal or external require of 'jquery/vendor/another' to 'another/index.js'\r\n *        './vendor/another.js': './another/index.js',\r\n *        // test.js / test -> lib/test.js\r\n *        './test.js': './lib/test.js',\r\n *\r\n *        // environment-specific map configurations\r\n *        './index.js': {\r\n *          '~browser': './index-node.js',\r\n *          './custom-condition.js|~export': './index-custom.js'\r\n *        }\r\n *     },\r\n *     // allows for setting package-prefixed depCache\r\n *     // keys are normalized module keys relative to the package itself\r\n *     depCache: {\r\n *       // import 'package/index.js' loads in parallel package/lib/test.js,package/vendor/sizzle.js\r\n *       './index.js': ['./test'],\r\n *       './test.js': ['external-dep'],\r\n *       'external-dep/path.js': ['./another.js']\r\n *     }\r\n *   }\r\n * };\r\n *\r\n * Then:\r\n *   import 'jquery'                       -> jquery/index.js\r\n *   import 'jquery/submodule'             -> jquery/submodule.js\r\n *   import 'jquery/submodule.ts'          -> jquery/submodule.ts loaded as typescript\r\n *   import 'jquery/vendor/another'        -> another/index.js\r\n *\r\n * Detailed Behaviours\r\n * - main can have a leading \"./\" can be added optionally\r\n * - map and defaultExtension are applied to the main\r\n * - defaultExtension adds the extension only if the exact extension is not present\r\n\r\n * - if a meta value is available for a module, map and defaultExtension are skipped\r\n * - like global map, package map also applies to subpaths (sizzle/x, ./vendor/another/sub)\r\n * - condition module map is '@env' module in package or '@system-env' globally\r\n * - map targets support conditional interpolation ('./x': './x.#{|env}.js')\r\n * - internal package map targets cannot use boolean conditionals\r\n *\r\n * Package Configuration Loading\r\n *\r\n * Not all packages may already have their configuration present in the System config\r\n * For these cases, a list of packageConfigPaths can be provided, which when matched against\r\n * a request, will first request a \".json\" file by the package key to derive the package\r\n * configuration from. This allows dynamic loading of non-predetermined code, a key use\r\n * case in SystemJS.\r\n *\r\n * Example:\r\n *\r\n *   SystemJS.packageConfigPaths = ['packages/test/package.json', 'packages/*.json'];\r\n *\r\n *   // will first request 'packages/new-package/package.json' for the package config\r\n *   // before completing the package request to 'packages/new-package/path'\r\n *   SystemJS.import('packages/new-package/path');\r\n *\r\n *   // will first request 'packages/test/package.json' before the main\r\n *   SystemJS.import('packages/test');\r\n *\r\n * When a package matches packageConfigPaths, it will always send a config request for\r\n * the package configuration.\r\n * The package key itself is taken to be the match up to and including the last wildcard\r\n * or trailing slash.\r\n * The most specific package config path will be used.\r\n * Any existing package configurations for the package will deeply merge with the\r\n * package config, with the existing package configurations taking preference.\r\n * To opt-out of the package configuration request for a package that matches\r\n * packageConfigPaths, use the { configured: true } package config option.\r\n *\r\n */\r\n\r\nfunction addDefaultExtension (config, pkg, pkgKey, subPath, skipExtensions) {\r\n  // don't apply extensions to folders or if defaultExtension = false\r\n  if (!subPath || !pkg.defaultExtension || subPath[subPath.length - 1] === '/' || skipExtensions)\r\n    return subPath;\r\n\r\n  var metaMatch = false;\r\n\r\n  // exact meta or meta with any content after the last wildcard skips extension\r\n  if (pkg.meta)\r\n    getMetaMatches(pkg.meta, subPath, function (metaPattern, matchMeta, matchDepth) {\r\n      if (matchDepth === 0 || metaPattern.lastIndexOf('*') !== metaPattern.length - 1)\r\n        return metaMatch = true;\r\n    });\r\n\r\n  // exact global meta or meta with any content after the last wildcard skips extension\r\n  if (!metaMatch && config.meta)\r\n    getMetaMatches(config.meta, pkgKey + '/' + subPath, function (metaPattern, matchMeta, matchDepth) {\r\n      if (matchDepth === 0 || metaPattern.lastIndexOf('*') !== metaPattern.length - 1)\r\n        return metaMatch = true;\r\n    });\r\n\r\n  if (metaMatch)\r\n    return subPath;\r\n\r\n  // work out what the defaultExtension is and add if not there already\r\n  var defaultExtension = '.' + pkg.defaultExtension;\r\n  if (subPath.substr(subPath.length - defaultExtension.length) !== defaultExtension)\r\n    return subPath + defaultExtension;\r\n  else\r\n    return subPath;\r\n}\r\n\r\nfunction applyPackageConfigSync (loader, config, pkg, pkgKey, subPath, metadata, skipExtensions) {\r\n  // main\r\n  if (!subPath) {\r\n    if (pkg.main)\r\n      subPath = pkg.main.substr(0, 2) === './' ? pkg.main.substr(2) : pkg.main;\r\n    else\r\n      // also no submap if key is package itself (import 'pkg' -> 'path/to/pkg.js')\r\n      // NB can add a default package main convention here\r\n      // if it becomes internal to the package then it would no longer be an exit path\r\n      return pkgKey;\r\n  }\r\n\r\n  // map config checking without then with extensions\r\n  if (pkg.map) {\r\n    var mapPath = './' + subPath;\r\n\r\n    var mapMatch = getMapMatch(pkg.map, mapPath);\r\n\r\n    // we then check map with the default extension adding\r\n    if (!mapMatch) {\r\n      mapPath = './' + addDefaultExtension(config, pkg, pkgKey, subPath, skipExtensions);\r\n      if (mapPath !== './' + subPath)\r\n        mapMatch = getMapMatch(pkg.map, mapPath);\r\n    }\r\n    if (mapMatch) {\r\n      var mapped = doMapSync(loader, config, pkg, pkgKey, mapMatch, mapPath, metadata, skipExtensions);\r\n      if (mapped)\r\n        return mapped;\r\n    }\r\n  }\r\n\r\n  // normal package resolution\r\n  return pkgKey + '/' + addDefaultExtension(config, pkg, pkgKey, subPath, skipExtensions);\r\n}\r\n\r\nfunction validMapping (mapMatch, mapped, path) {\r\n  // allow internal ./x -> ./x/y or ./x/ -> ./x/y recursive maps\r\n  // but only if the path is exactly ./x and not ./x/z\r\n  if (mapped.substr(0, mapMatch.length) === mapMatch && path.length > mapMatch.length)\r\n    return false;\r\n\r\n  return true;\r\n}\r\n\r\nfunction doMapSync (loader, config, pkg, pkgKey, mapMatch, path, metadata, skipExtensions) {\r\n  if (path[path.length - 1] === '/')\r\n    path = path.substr(0, path.length - 1);\r\n  var mapped = pkg.map[mapMatch];\r\n\r\n  if (typeof mapped === 'object')\r\n    throw new Error('Synchronous conditional normalization not supported sync normalizing ' + mapMatch + ' in ' + pkgKey);\r\n\r\n  if (!validMapping(mapMatch, mapped, path) || typeof mapped !== 'string')\r\n    return;\r\n\r\n  return packageResolveSync.call(loader, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions);\r\n}\r\n\r\nfunction applyPackageConfig (loader, config, pkg, pkgKey, subPath, metadata, skipExtensions) {\r\n  // main\r\n  if (!subPath) {\r\n    if (pkg.main)\r\n      subPath = pkg.main.substr(0, 2) === './' ? pkg.main.substr(2) : pkg.main;\r\n    // also no submap if key is package itself (import 'pkg' -> 'path/to/pkg.js')\r\n    else\r\n      // NB can add a default package main convention here\r\n      // if it becomes internal to the package then it would no longer be an exit path\r\n      return Promise.resolve(pkgKey);\r\n  }\r\n\r\n  // map config checking without then with extensions\r\n  var mapPath, mapMatch;\r\n\r\n  if (pkg.map) {\r\n    mapPath = './' + subPath;\r\n    mapMatch = getMapMatch(pkg.map, mapPath);\r\n\r\n    // we then check map with the default extension adding\r\n    if (!mapMatch) {\r\n      mapPath = './' + addDefaultExtension(config, pkg, pkgKey, subPath, skipExtensions);\r\n      if (mapPath !== './' + subPath)\r\n        mapMatch = getMapMatch(pkg.map, mapPath);\r\n    }\r\n  }\r\n\r\n  return (mapMatch ? doMap(loader, config, pkg, pkgKey, mapMatch, mapPath, metadata, skipExtensions) : resolvedPromise)\r\n  .then(function (mapped) {\r\n    if (mapped)\r\n      return Promise.resolve(mapped);\r\n\r\n    // normal package resolution / fallback resolution for no conditional match\r\n    return Promise.resolve(pkgKey + '/' + addDefaultExtension(config, pkg, pkgKey, subPath, skipExtensions));\r\n  });\r\n}\r\n\r\nfunction doMap (loader, config, pkg, pkgKey, mapMatch, path, metadata, skipExtensions) {\r\n  if (path[path.length - 1] === '/')\r\n    path = path.substr(0, path.length - 1);\r\n\r\n  var mapped = pkg.map[mapMatch];\r\n\r\n  if (typeof mapped === 'string') {\r\n    if (!validMapping(mapMatch, mapped, path))\r\n      return resolvedPromise;\r\n    return packageResolve.call(loader, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions)\r\n    .then(function (normalized) {\r\n      return interpolateConditional.call(loader, normalized, pkgKey + '/', metadata);\r\n    });\r\n  }\r\n\r\n  // we use a special conditional syntax to allow the builder to handle conditional branch points further\r\n  /*if (loader.builder)\r\n    return Promise.resolve(pkgKey + '/#:' + path);*/\r\n\r\n  // we load all conditions upfront\r\n  var conditionPromises = [];\r\n  var conditions = [];\r\n  for (var e in mapped) {\r\n    var c = parseCondition(e);\r\n    conditions.push({\r\n      condition: c,\r\n      map: mapped[e]\r\n    });\r\n    conditionPromises.push(RegisterLoader.prototype.import.call(loader, c.module, pkgKey));\r\n  }\r\n\r\n  // map object -> conditional map\r\n  return Promise.all(conditionPromises)\r\n  .then(function (conditionValues) {\r\n    // first map condition to match is used\r\n    for (var i = 0; i < conditions.length; i++) {\r\n      var c = conditions[i].condition;\r\n      var value = readMemberExpression(c.prop, '__useDefault' in conditionValues[i] ? conditionValues[i].__useDefault : conditionValues[i]);\r\n      if (!c.negate && value || c.negate && !value)\r\n        return conditions[i].map;\r\n    }\r\n  })\r\n  .then(function (mapped) {\r\n    if (mapped) {\r\n      if (!validMapping(mapMatch, mapped, path))\r\n        return resolvedPromise;\r\n      return packageResolve.call(loader, config, mapped + path.substr(mapMatch.length), pkgKey + '/', metadata, metadata, skipExtensions)\r\n      .then(function (normalized) {\r\n        return interpolateConditional.call(loader, normalized, pkgKey + '/', metadata);\r\n      });\r\n    }\r\n\r\n    // no environment match -> fallback to original subPath by returning undefined\r\n  });\r\n}\r\n\r\n// check if the given normalized key matches a packageConfigPath\r\n// if so, loads the config\r\nvar packageConfigPaths = {};\r\n\r\n// data object for quick checks against package paths\r\nfunction createPkgConfigPathObj (path) {\r\n  var lastWildcard = path.lastIndexOf('*');\r\n  var length = Math.max(lastWildcard + 1, path.lastIndexOf('/'));\r\n  return {\r\n    length: length,\r\n    regEx: new RegExp('^(' + path.substr(0, length).replace(/[.+?^${}()|[\\]\\\\]/g, '\\\\$&').replace(/\\*/g, '[^\\\\/]+') + ')(\\\\/|$)'),\r\n    wildcard: lastWildcard !== -1\r\n  };\r\n}\r\n\r\n// most specific match wins\r\nfunction getPackageConfigMatch (config, normalized) {\r\n  var pkgKey, exactMatch = false, configPath;\r\n  for (var i = 0; i < config.packageConfigPaths.length; i++) {\r\n    var packageConfigPath = config.packageConfigPaths[i];\r\n    var p = packageConfigPaths[packageConfigPath] || (packageConfigPaths[packageConfigPath] = createPkgConfigPathObj(packageConfigPath));\r\n    if (normalized.length < p.length)\r\n      continue;\r\n    var match = normalized.match(p.regEx);\r\n    if (match && (!pkgKey || (!(exactMatch && p.wildcard) && pkgKey.length < match[1].length))) {\r\n      pkgKey = match[1];\r\n      exactMatch = !p.wildcard;\r\n      configPath = pkgKey + packageConfigPath.substr(p.length);\r\n    }\r\n  }\r\n\r\n  if (!pkgKey)\r\n    return;\r\n\r\n  return {\r\n    packageKey: pkgKey,\r\n    configPath: configPath\r\n  };\r\n}\r\n\r\nfunction loadPackageConfigPath (loader, config, pkgConfigPath, metadata, normalized) {\r\n  var configLoader = loader.pluginLoader || loader;\r\n\r\n  // ensure we note this is a package config file path\r\n  // it will then be skipped from getting other normalizations itself to ensure idempotency\r\n  if (config.packageConfigKeys.indexOf(pkgConfigPath) === -1)\r\n    config.packageConfigKeys.push(pkgConfigPath);\r\n\r\n  return configLoader.import(pkgConfigPath)\r\n  .then(function (pkgConfig) {\r\n    setPkgConfig(metadata.packageConfig, pkgConfig, metadata.packageKey, true, config);\r\n    metadata.packageConfig.configured = true;\r\n  })\r\n  .catch(function (err) {\r\n    throw addToError(err, 'Unable to fetch package configuration file ' + pkgConfigPath);\r\n  });\r\n}\r\n\r\nfunction getMetaMatches (pkgMeta, subPath, matchFn) {\r\n  // wildcard meta\r\n  var wildcardIndex;\r\n  for (var module in pkgMeta) {\r\n    // allow meta to start with ./ for flexibility\r\n    var dotRel = module.substr(0, 2) === './' ? './' : '';\r\n    if (dotRel)\r\n      module = module.substr(2);\r\n\r\n    wildcardIndex = module.indexOf('*');\r\n    if (wildcardIndex === -1)\r\n      continue;\r\n\r\n    if (module.substr(0, wildcardIndex) === subPath.substr(0, wildcardIndex)\r\n        && module.substr(wildcardIndex + 1) === subPath.substr(subPath.length - module.length + wildcardIndex + 1)) {\r\n      // alow match function to return true for an exit path\r\n      if (matchFn(module, pkgMeta[dotRel + module], module.split('/').length))\r\n        return;\r\n    }\r\n  }\r\n  // exact meta\r\n  var exactMeta = pkgMeta[subPath] && Object.hasOwnProperty.call(pkgMeta, subPath) ? pkgMeta[subPath] : pkgMeta['./' + subPath];\r\n  if (exactMeta)\r\n    matchFn(exactMeta, exactMeta, 0);\r\n}\r\n\r\n\r\n/*\r\n * Conditions Extension\r\n *\r\n *   Allows a condition module to alter the resolution of an import via syntax:\r\n *\r\n *     import $ from 'jquery/#{browser}';\r\n *\r\n *   Will first load the module 'browser' via `SystemJS.import('browser')` and\r\n *   take the default export of that module.\r\n *   If the default export is not a string, an error is thrown.\r\n *\r\n *   We then substitute the string into the require to get the conditional resolution\r\n *   enabling environment-specific variations like:\r\n *\r\n *     import $ from 'jquery/ie'\r\n *     import $ from 'jquery/firefox'\r\n *     import $ from 'jquery/chrome'\r\n *     import $ from 'jquery/safari'\r\n *\r\n *   It can be useful for a condition module to define multiple conditions.\r\n *   This can be done via the `|` modifier to specify an export member expression:\r\n *\r\n *     import 'jquery/#{./browser.js|grade.version}'\r\n *\r\n *   Where the `grade` export `version` member in the `browser.js` module  is substituted.\r\n *\r\n *\r\n * Boolean Conditionals\r\n *\r\n *   For polyfill modules, that are used as imports but have no module value,\r\n *   a binary conditional allows a module not to be loaded at all if not needed:\r\n *\r\n *     import 'es5-shim#?./conditions.js|needs-es5shim'\r\n *\r\n *   These conditions can also be negated via:\r\n *\r\n *     import 'es5-shim#?./conditions.js|~es6'\r\n *\r\n */\r\n\r\nvar sysConditions = ['browser', 'node', 'dev', 'build', 'production', 'default'];\r\n\r\nfunction parseCondition (condition) {\r\n  var conditionExport, conditionModule, negation;\r\n\r\n  var negation;\r\n  var conditionExportIndex = condition.lastIndexOf('|');\r\n  if (conditionExportIndex !== -1) {\r\n    conditionExport = condition.substr(conditionExportIndex + 1);\r\n    conditionModule = condition.substr(0, conditionExportIndex);\r\n\r\n    if (conditionExport[0] === '~') {\r\n      negation = true;\r\n      conditionExport = conditionExport.substr(1);\r\n    }\r\n  }\r\n  else {\r\n    negation = condition[0] === '~';\r\n    conditionExport = 'default';\r\n    conditionModule = condition.substr(negation);\r\n    if (sysConditions.indexOf(conditionModule) !== -1) {\r\n      conditionExport = conditionModule;\r\n      conditionModule = null;\r\n    }\r\n  }\r\n\r\n  return {\r\n    module: conditionModule || '@system-env',\r\n    prop: conditionExport,\r\n    negate: negation\r\n  };\r\n}\r\n\r\nfunction resolveCondition (conditionObj, parentKey, bool) {\r\n  // import without __useDefault handling here\r\n  return RegisterLoader.prototype.import.call(this, conditionObj.module, parentKey)\r\n  .then(function (condition) {\r\n    var m = readMemberExpression(conditionObj.prop, condition);\r\n\r\n    if (bool && typeof m !== 'boolean')\r\n      throw new TypeError('Condition did not resolve to a boolean.');\r\n\r\n    return conditionObj.negate ? !m : m;\r\n  });\r\n}\r\n\r\nvar interpolationRegEx = /#\\{[^\\}]+\\}/;\r\nfunction interpolateConditional (key, parentKey, parentMetadata) {\r\n  // first we normalize the conditional\r\n  var conditionalMatch = key.match(interpolationRegEx);\r\n\r\n  if (!conditionalMatch)\r\n    return Promise.resolve(key);\r\n\r\n  var conditionObj = parseCondition.call(this, conditionalMatch[0].substr(2, conditionalMatch[0].length - 3));\r\n\r\n  // in builds, return normalized conditional\r\n  /*if (this.builder)\r\n    return this.normalize(conditionObj.module, parentKey, createMetadata(), parentMetadata)\r\n    .then(function (conditionModule) {\r\n      conditionObj.module = conditionModule;\r\n      return key.replace(interpolationRegEx, '#{' + serializeCondition(conditionObj) + '}');\r\n    });*/\r\n\r\n  return resolveCondition.call(this, conditionObj, parentKey, false)\r\n  .then(function (conditionValue) {\r\n    if (typeof conditionValue !== 'string')\r\n      throw new TypeError('The condition value for ' + key + ' doesn\\'t resolve to a string.');\r\n\r\n    if (conditionValue.indexOf('/') !== -1)\r\n      throw new TypeError('Unabled to interpolate conditional ' + key + (parentKey ? ' in ' + parentKey : '') + '\\n\\tThe condition value ' + conditionValue + ' cannot contain a \"/\" separator.');\r\n\r\n    return key.replace(interpolationRegEx, conditionValue);\r\n  });\r\n}\r\n","import { envModule, setProduction, configNames } from './systemjs-loader.js';\r\nimport { extend, prepend, warn, resolveIfNotPlain, baseURI, CONFIG } from './common.js';\r\nimport { coreResolve } from './resolve.js';\r\n\r\n/*\r\n Extend config merging one deep only\r\n\r\n  loader.config({\r\n    some: 'random',\r\n    config: 'here',\r\n    deep: {\r\n      config: { too: 'too' }\r\n    }\r\n  });\r\n\r\n  <=>\r\n\r\n  loader.some = 'random';\r\n  loader.config = 'here'\r\n  loader.deep = loader.deep || {};\r\n  loader.deep.config = { too: 'too' };\r\n\r\n\r\n  Normalizes meta and package configs allowing for:\r\n\r\n  SystemJS.config({\r\n    meta: {\r\n      './index.js': {}\r\n    }\r\n  });\r\n\r\n  To become\r\n\r\n  SystemJS.meta['https://thissite.com/index.js'] = {};\r\n\r\n  For easy normalization canonicalization with latest URL support.\r\n\r\n*/\r\nvar envConfigNames = ['browserConfig', 'nodeConfig', 'devConfig', 'buildConfig', 'productionConfig'];\r\nfunction envSet(loader, cfg, envCallback) {\r\n  for (var i = 0; i < envConfigNames.length; i++) {\r\n    var envConfig = envConfigNames[i];\r\n    if (cfg[envConfig] && envModule[envConfig.substr(0, envConfig.length - 6)])\r\n      envCallback(cfg[envConfig]);\r\n  }\r\n}\r\n\r\nfunction cloneObj (obj, maxDepth) {\r\n  var clone = {};\r\n  for (var p in obj) {\r\n    var prop = obj[p];\r\n    if (maxDepth > 1) {\r\n      if (prop instanceof Array)\r\n        clone[p] = [].concat(prop);\r\n      else if (typeof prop === 'object')\r\n        clone[p] = cloneObj(prop, maxDepth - 1);\r\n      else if (p !== 'packageConfig')\r\n        clone[p] = prop;\r\n    }\r\n    else {\r\n      clone[p] = prop;\r\n    }\r\n  }\r\n  return clone;\r\n}\r\n\r\nexport function getConfigItem (config, p) {\r\n  var cfgItem = config[p];\r\n\r\n  // getConfig must return an unmodifiable clone of the configuration\r\n  if (cfgItem instanceof Array)\r\n    return config[p].concat([]);\r\n  else if (typeof cfgItem === 'object')\r\n    return cloneObj(cfgItem, 3)\r\n  else\r\n    return config[p];\r\n}\r\n\r\nexport function getConfig (configName) {\r\n  if (configName) {\r\n    if (configNames.indexOf(configName) !== -1)\r\n      return getConfigItem(this[CONFIG], configName);\r\n    throw new Error('\"' + configName + '\" is not a valid configuration name. Must be one of ' + configNames.join(', ') + '.');\r\n  }\r\n\r\n  var cfg = {};\r\n  for (var i = 0; i < configNames.length; i++) {\r\n    var p = configNames[i];\r\n    var configItem = getConfigItem(this[CONFIG], p);\r\n    if (configItem !== undefined)\r\n      cfg[p] = configItem;\r\n  }\r\n  return cfg;\r\n}\r\n\r\nexport function setConfig (cfg, isEnvConfig) {\r\n  var loader = this;\r\n  var config = this[CONFIG];\r\n\r\n  if ('warnings' in cfg)\r\n    config.warnings = cfg.warnings;\r\n\r\n  if ('wasm' in cfg)\r\n    config.wasm = typeof WebAssembly !== 'undefined' && cfg.wasm;\r\n\r\n  if ('production' in cfg || 'build' in cfg)\r\n    setProduction.call(loader, !!cfg.production, !!(cfg.build || envModule && envModule.build));\r\n\r\n  if (!isEnvConfig) {\r\n    // if using nodeConfig / browserConfig / productionConfig, take baseURL from there\r\n    // these exceptions will be unnecessary when we can properly implement config queuings\r\n    var baseURL;\r\n    envSet(loader, cfg, function(cfg) {\r\n      baseURL = baseURL || cfg.baseURL;\r\n    });\r\n    baseURL = baseURL || cfg.baseURL;\r\n\r\n    // always configure baseURL first\r\n    if (baseURL) {\r\n      config.baseURL = resolveIfNotPlain(baseURL, baseURI) || resolveIfNotPlain('./' + baseURL, baseURI);\r\n      if (config.baseURL[config.baseURL.length - 1] !== '/')\r\n        config.baseURL += '/';\r\n    }\r\n\r\n    if (cfg.paths)\r\n      extend(config.paths, cfg.paths);\r\n\r\n    envSet(loader, cfg, function(cfg) {\r\n      if (cfg.paths)\r\n        extend(config.paths, cfg.paths);\r\n    });\r\n\r\n    for (var p in config.paths) {\r\n      if (config.paths[p].indexOf('*') === -1)\r\n        continue;\r\n      warn.call(config, 'Path config ' + p + ' -> ' + config.paths[p] + ' is no longer supported as wildcards are deprecated.');\r\n      delete config.paths[p];\r\n    }\r\n  }\r\n\r\n  if (cfg.defaultJSExtensions)\r\n    warn.call(config, 'The defaultJSExtensions configuration option is deprecated.\\n  Use packages defaultExtension instead.', true);\r\n\r\n  if (typeof cfg.pluginFirst === 'boolean')\r\n    config.pluginFirst = cfg.pluginFirst;\r\n\r\n  if (cfg.map) {\r\n    for (var p in cfg.map) {\r\n      var v = cfg.map[p];\r\n\r\n      if (typeof v === 'string') {\r\n        var mapped = coreResolve.call(loader, config, v, undefined, false, false);\r\n        if (mapped[mapped.length -1] === '/' && p[p.length - 1] !== ':' && p[p.length - 1] !== '/')\r\n          mapped = mapped.substr(0, mapped.length - 1);\r\n        config.map[p] = mapped;\r\n      }\r\n\r\n      // object map\r\n      else {\r\n        var pkgName = coreResolve.call(loader, config, p[p.length - 1] !== '/' ? p + '/' : p, undefined, true, true);\r\n        pkgName = pkgName.substr(0, pkgName.length - 1);\r\n\r\n        var pkg = config.packages[pkgName];\r\n        if (!pkg) {\r\n          pkg = config.packages[pkgName] = createPackage();\r\n          // use '' instead of false to keep type consistent\r\n          pkg.defaultExtension = '';\r\n        }\r\n        setPkgConfig(pkg, { map: v }, pkgName, false, config);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (cfg.packageConfigPaths) {\r\n    var packageConfigPaths = [];\r\n    for (var i = 0; i < cfg.packageConfigPaths.length; i++) {\r\n      var path = cfg.packageConfigPaths[i];\r\n      var packageLength = Math.max(path.lastIndexOf('*') + 1, path.lastIndexOf('/'));\r\n      var normalized = coreResolve.call(loader, config, path.substr(0, packageLength), undefined, false, false);\r\n      packageConfigPaths[i] = normalized + path.substr(packageLength);\r\n    }\r\n    config.packageConfigPaths = packageConfigPaths;\r\n  }\r\n\r\n  if (cfg.bundles) {\r\n    for (var p in cfg.bundles) {\r\n      var bundle = [];\r\n      for (var i = 0; i < cfg.bundles[p].length; i++)\r\n        bundle.push(loader.normalizeSync(cfg.bundles[p][i]));\r\n      config.bundles[p] = bundle;\r\n    }\r\n  }\r\n\r\n  if (cfg.packages) {\r\n    for (var p in cfg.packages) {\r\n      if (p.match(/^([^\\/]+:)?\\/\\/$/))\r\n        throw new TypeError('\"' + p + '\" is not a valid package name.');\r\n\r\n      var pkgName = coreResolve.call(loader, config, p[p.length - 1] !== '/' ? p + '/' : p, undefined, true, true);\r\n      pkgName = pkgName.substr(0, pkgName.length - 1);\r\n\r\n      setPkgConfig(config.packages[pkgName] = config.packages[pkgName] || createPackage(), cfg.packages[p], pkgName, false, config);\r\n    }\r\n  }\r\n\r\n  if (cfg.depCache) {\r\n    for (var p in cfg.depCache)\r\n      config.depCache[loader.normalizeSync(p)] = [].concat(cfg.depCache[p]);\r\n  }\r\n\r\n  if (cfg.meta) {\r\n    for (var p in cfg.meta) {\r\n      // base wildcard stays base\r\n      if (p[0] === '*') {\r\n        extend(config.meta[p] = config.meta[p] || {}, cfg.meta[p]);\r\n      }\r\n      else {\r\n        var resolved = coreResolve.call(loader, config, p, undefined, true, true);\r\n        extend(config.meta[resolved] = config.meta[resolved] || {}, cfg.meta[p]);\r\n      }\r\n    }\r\n  }\r\n\r\n  if ('transpiler' in cfg)\r\n    config.transpiler = cfg.transpiler;\r\n\r\n\r\n  // copy any remaining non-standard configuration properties\r\n  for (var c in cfg) {\r\n    if (configNames.indexOf(c) !== -1)\r\n      continue;\r\n    if (envConfigNames.indexOf(c) !== -1)\r\n      continue;\r\n\r\n    // warn.call(config, 'Setting custom config option `System.config({ ' + c + ': ... })` is deprecated. Avoid custom config options or set SystemJS.' + c + ' = ... directly.');\r\n    loader[c] = cfg[c];\r\n  }\r\n\r\n  envSet(loader, cfg, function(cfg) {\r\n    loader.config(cfg, true);\r\n  });\r\n}\r\n\r\nexport function createPackage () {\r\n  return {\r\n    defaultExtension: undefined,\r\n    main: undefined,\r\n    format: undefined,\r\n    meta: undefined,\r\n    map: undefined,\r\n    packageConfig: undefined,\r\n    configured: false\r\n  };\r\n}\r\n\r\n// deeply-merge (to first level) config with any existing package config\r\nexport function setPkgConfig (pkg, cfg, pkgName, prependConfig, config) {\r\n  for (var prop in cfg) {\r\n    if (prop === 'main' || prop === 'format' || prop === 'defaultExtension' || prop === 'configured') {\r\n      if (!prependConfig || pkg[prop] === undefined)\r\n        pkg[prop] = cfg[prop];\r\n    }\r\n    else if (prop === 'map') {\r\n      (prependConfig ? prepend : extend)(pkg.map = pkg.map || {}, cfg.map);\r\n    }\r\n    else if (prop === 'meta') {\r\n      (prependConfig ? prepend : extend)(pkg.meta = pkg.meta || {}, cfg.meta);\r\n    }\r\n    else if (Object.hasOwnProperty.call(cfg, prop)) {\r\n      warn.call(config, '\"' + prop + '\" is not a valid package configuration option in package ' + pkgName);\r\n    }\r\n  }\r\n\r\n  // default defaultExtension for packages only\r\n  if (pkg.defaultExtension === undefined)\r\n    pkg.defaultExtension = 'js';\r\n\r\n  if (pkg.main === undefined && pkg.map && pkg.map['.']) {\r\n    pkg.main = pkg.map['.'];\r\n    delete pkg.map['.'];\r\n  }\r\n  // main object becomes main map\r\n  else if (typeof pkg.main === 'object') {\r\n    pkg.map = pkg.map || {};\r\n    pkg.map['./@main'] = pkg.main;\r\n    pkg.main['default'] = pkg.main['default'] || './';\r\n    pkg.main = '@main';\r\n  }\r\n\r\n  return pkg;\r\n}\r\n","import { isBrowser, global } from './common.js';\r\n\r\nvar hasBuffer = typeof Buffer !== 'undefined';\r\ntry {\r\n  if (hasBuffer && new Buffer('a').toString('base64') !== 'YQ==')\r\n    hasBuffer = false;\r\n}\r\ncatch (e) {\r\n  hasBuffer = false;\r\n}\r\n\r\nvar sourceMapPrefix = '\\n//# sourceMapping' + 'URL=data:application/json;base64,';\r\nfunction inlineSourceMap (sourceMapString) {\r\n  if (hasBuffer)\r\n    return sourceMapPrefix + new Buffer(sourceMapString).toString('base64');\r\n  else if (typeof btoa !== 'undefined')\r\n    return sourceMapPrefix + btoa(unescape(encodeURIComponent(sourceMapString)));\r\n  else\r\n    return '';\r\n}\r\n\r\nfunction getSource(source, sourceMap, address, wrap) {\r\n  var lastLineIndex = source.lastIndexOf('\\n');\r\n\r\n  if (sourceMap) {\r\n    if (typeof sourceMap != 'object')\r\n      throw new TypeError('load.metadata.sourceMap must be set to an object.');\r\n\r\n    sourceMap = JSON.stringify(sourceMap);\r\n  }\r\n\r\n  return (wrap ? '(function(System, SystemJS) {' : '') + source + (wrap ? '\\n})(System, System);' : '')\r\n      // adds the sourceURL comment if not already present\r\n      + (source.substr(lastLineIndex, 15) != '\\n//# sourceURL='\r\n        ? '\\n//# sourceURL=' + address + (sourceMap ? '!transpiled' : '') : '')\r\n      // add sourceMappingURL if load.metadata.sourceMap is set\r\n      + (sourceMap && inlineSourceMap(sourceMap) || '');\r\n}\r\n\r\n// script execution via injecting a script tag into the page\r\n// this allows CSP nonce to be set for CSP environments\r\nvar head;\r\nfunction scriptExec(loader, source, sourceMap, address, nonce) {\r\n  if (!head)\r\n    head = document.head || document.body || document.documentElement;\r\n\r\n  var script = document.createElement('script');\r\n  script.text = getSource(source, sourceMap, address, false);\r\n  var onerror = window.onerror;\r\n  var e;\r\n  window.onerror = function(_e) {\r\n    e = addToError(_e, 'Evaluating ' + address);\r\n    if (onerror)\r\n      onerror.apply(this, arguments);\r\n  }\r\n  preExec(loader);\r\n\r\n  if (nonce)\r\n    script.setAttribute('nonce', nonce);\r\n\r\n  head.appendChild(script);\r\n  head.removeChild(script);\r\n  postExec();\r\n  window.onerror = onerror;\r\n  if (e)\r\n    return e;\r\n}\r\n\r\nvar vm;\r\nvar useVm;\r\n\r\nvar curSystem;\r\n\r\nvar callCounter = 0;\r\nfunction preExec (loader) {\r\n  if (callCounter++ == 0)\r\n    curSystem = global.System;\r\n  global.System = global.SystemJS = loader;\r\n}\r\nfunction postExec () {\r\n  if (--callCounter == 0)\r\n    global.System = global.SystemJS = curSystem;\r\n}\r\n\r\nvar supportsScriptExec = false;\r\nif (isBrowser && typeof document != 'undefined' && document.getElementsByTagName) {\r\n  if (!(window.chrome && window.chrome.extension || navigator.userAgent.match(/^Node\\.js/)))\r\n    supportsScriptExec = true;\r\n}\r\n\r\nexport function evaluate (loader, source, sourceMap, address, integrity, nonce, noWrap) {\r\n  if (!source)\r\n    return;\r\n  if (nonce && supportsScriptExec)\r\n    return scriptExec(loader, source, sourceMap, address, nonce);\r\n  try {\r\n    preExec(loader);\r\n    // global scoped eval for node (avoids require scope leak)\r\n    if (!vm && loader._nodeRequire) {\r\n      vm = loader._nodeRequire('vm');\r\n      useVm = vm.runInThisContext(\"typeof System !== 'undefined' && System\") === loader;\r\n    }\r\n    if (useVm)\r\n      vm.runInThisContext(getSource(source, sourceMap, address, !noWrap), { filename: address + (sourceMap ? '!transpiled' : '') });\r\n    else\r\n      (0, eval)(getSource(source, sourceMap, address, !noWrap));\r\n    postExec();\r\n  }\r\n  catch (e) {\r\n    postExec();\r\n    return e;\r\n  }\r\n}\r\n","\r\nimport { isWindows, global, readMemberExpression, cjsRequireRegEx, noop } from './common.js';\r\n\r\nexport function setHelpers (loader) {\r\n  loader.set('@@cjs-helpers', loader.newModule({\r\n    requireResolve: requireResolve.bind(loader),\r\n    getPathVars: getPathVars\r\n  }));\r\n\r\n  loader.set('@@global-helpers', loader.newModule({\r\n    prepareGlobal: prepareGlobal\r\n  }));\r\n}\r\n\r\nexport function setAmdHelper (loader) {\r\n\r\n  /*\r\n    AMD-compatible require\r\n    To copy RequireJS, set window.require = window.requirejs = loader.amdRequire\r\n  */\r\n  function require (names, callback, errback, referer) {\r\n    // in amd, first arg can be a config object... we just ignore\r\n    if (typeof names === 'object' && !(names instanceof Array))\r\n      return require.apply(null, Array.prototype.splice.call(arguments, 1, arguments.length - 1));\r\n\r\n    // amd require\r\n    if (typeof names === 'string' && typeof callback === 'function')\r\n      names = [names];\r\n    if (names instanceof Array) {\r\n      var dynamicRequires = [];\r\n      for (var i = 0; i < names.length; i++)\r\n        dynamicRequires.push(loader.import(names[i], referer));\r\n      Promise.all(dynamicRequires).then(function (modules) {\r\n        if (callback)\r\n          callback.apply(null, modules);\r\n      }, errback);\r\n    }\r\n\r\n    // commonjs require\r\n    else if (typeof names === 'string') {\r\n      var normalized = loader.decanonicalize(names, referer);\r\n      var module = loader.get(normalized);\r\n      if (!module)\r\n        throw new Error('Module not already loaded loading \"' + names + '\" as ' + normalized + (referer ? ' from \"' + referer + '\".' : '.'));\r\n      return '__useDefault' in module ? module.__useDefault : module;\r\n    }\r\n\r\n    else\r\n      throw new TypeError('Invalid require');\r\n  }\r\n\r\n  function define (name, deps, factory) {\r\n    if (typeof name !== 'string') {\r\n      factory = deps;\r\n      deps = name;\r\n      name = null;\r\n    }\r\n\r\n    if (!(deps instanceof Array)) {\r\n      factory = deps;\r\n      deps = ['require', 'exports', 'module'].splice(0, factory.length);\r\n    }\r\n\r\n    if (typeof factory !== 'function')\r\n      factory = (function (factory) {\r\n        return function() { return factory; }\r\n      })(factory);\r\n\r\n    if (!name) {\r\n      if (curMetaDeps) {\r\n        deps = deps.concat(curMetaDeps);\r\n        curMetaDeps = undefined;\r\n      }\r\n    }\r\n\r\n    // remove system dependencies\r\n    var requireIndex, exportsIndex, moduleIndex;\r\n\r\n    if ((requireIndex = deps.indexOf('require')) !== -1) {\r\n\r\n      deps.splice(requireIndex, 1);\r\n\r\n      // only trace cjs requires for non-named\r\n      // named defines assume the trace has already been done\r\n      if (!name)\r\n        deps = deps.concat(amdGetCJSDeps(factory.toString(), requireIndex));\r\n    }\r\n\r\n    if ((exportsIndex = deps.indexOf('exports')) !== -1)\r\n      deps.splice(exportsIndex, 1);\r\n\r\n    if ((moduleIndex = deps.indexOf('module')) !== -1)\r\n      deps.splice(moduleIndex, 1);\r\n\r\n    function execute (req, exports, module) {\r\n      var depValues = [];\r\n      for (var i = 0; i < deps.length; i++)\r\n        depValues.push(req(deps[i]));\r\n\r\n      module.uri = module.id;\r\n\r\n      module.config = noop;\r\n\r\n      // add back in system dependencies\r\n      if (moduleIndex !== -1)\r\n        depValues.splice(moduleIndex, 0, module);\r\n\r\n      if (exportsIndex !== -1)\r\n        depValues.splice(exportsIndex, 0, exports);\r\n\r\n      if (requireIndex !== -1) {\r\n        var contextualRequire = function (names, callback, errback) {\r\n          if (typeof names === 'string' && typeof callback !== 'function')\r\n            return req(names);\r\n          return require.call(loader, names, callback, errback, module.id);\r\n        };\r\n        contextualRequire.toUrl = function (name) {\r\n          return loader.normalizeSync(name, module.id);\r\n        };\r\n        depValues.splice(requireIndex, 0, contextualRequire);\r\n      }\r\n\r\n      // set global require to AMD require\r\n      var curRequire = global.require;\r\n      global.require = require;\r\n\r\n      var output = factory.apply(exportsIndex === -1 ? global : exports, depValues);\r\n\r\n      global.require = curRequire;\r\n\r\n      if (typeof output !== 'undefined')\r\n        module.exports = output;\r\n    }\r\n\r\n    // anonymous define\r\n    if (!name) {\r\n      loader.registerDynamic(deps, false, curEsModule ? wrapEsModuleExecute(execute) : execute);\r\n    }\r\n    else {\r\n      loader.registerDynamic(name, deps, false, execute);\r\n\r\n      // if we don't have any other defines,\r\n      // then let this be an anonymous define\r\n      // this is just to support single modules of the form:\r\n      // define('jquery')\r\n      // still loading anonymously\r\n      // because it is done widely enough to be useful\r\n      // as soon as there is more than one define, this gets removed though\r\n      if (lastNamedDefine) {\r\n        lastNamedDefine = undefined;\r\n        multipleNamedDefines = true;\r\n      }\r\n      else if (!multipleNamedDefines) {\r\n        lastNamedDefine = [deps, execute];\r\n      }\r\n    }\r\n  }\r\n  define.amd = {};\r\n\r\n  loader.amdDefine = define;\r\n  loader.amdRequire = require;\r\n}\r\n\r\n// CJS\r\nvar windowOrigin;\r\nif (typeof window !== 'undefined' && typeof document !== 'undefined' && window.location)\r\n  windowOrigin = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');\r\n\r\nfunction stripOrigin(path) {\r\n  if (path.substr(0, 8) === 'file:///')\r\n    return path.substr(7 + !!isWindows);\r\n\r\n  if (windowOrigin && path.substr(0, windowOrigin.length) === windowOrigin)\r\n    return path.substr(windowOrigin.length);\r\n\r\n  return path;\r\n}\r\n\r\nexport function requireResolve (request, parentId) {\r\n  return stripOrigin(this.normalizeSync(request, parentId));\r\n}\r\n\r\nexport function getPathVars (moduleId) {\r\n  // remove any plugin syntax\r\n  var pluginIndex = moduleId.lastIndexOf('!');\r\n  var filename;\r\n  if (pluginIndex !== -1)\r\n    filename = moduleId.substr(0, pluginIndex);\r\n  else\r\n    filename = moduleId;\r\n\r\n  var dirname = filename.split('/');\r\n  dirname.pop();\r\n  dirname = dirname.join('/');\r\n\r\n  return {\r\n    filename: stripOrigin(filename),\r\n    dirname: stripOrigin(dirname)\r\n  };\r\n}\r\n\r\nvar commentRegEx = /(^|[^\\\\])(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/mg;\r\nvar stringRegEx = /(\"[^\"\\\\\\n\\r]*(\\\\.[^\"\\\\\\n\\r]*)*\"|'[^'\\\\\\n\\r]*(\\\\.[^'\\\\\\n\\r]*)*')/g;\r\n\r\n// used to support leading #!/usr/bin/env in scripts as supported in Node\r\nvar hashBangRegEx = /^\\#\\!.*/;\r\n\r\n// extract CJS dependencies from source text via regex static analysis\r\n// read require('x') statements not in comments or strings\r\nexport function getCJSDeps (source) {\r\n  cjsRequireRegEx.lastIndex = commentRegEx.lastIndex = stringRegEx.lastIndex = 0;\r\n\r\n  var deps = [];\r\n\r\n  var match;\r\n\r\n  // track string and comment locations for unminified source\r\n  var stringLocations = [], commentLocations = [];\r\n\r\n  function inLocation (locations, match) {\r\n    for (var i = 0; i < locations.length; i++)\r\n      if (locations[i][0] < match.index && locations[i][1] > match.index)\r\n        return true;\r\n    return false;\r\n  }\r\n\r\n  if (source.length / source.split('\\n').length < 200) {\r\n    while (match = stringRegEx.exec(source))\r\n      stringLocations.push([match.index, match.index + match[0].length]);\r\n\r\n    // TODO: track template literals here before comments\r\n\r\n    while (match = commentRegEx.exec(source)) {\r\n      // only track comments not starting in strings\r\n      if (!inLocation(stringLocations, match))\r\n        commentLocations.push([match.index + match[1].length, match.index + match[0].length - 1]);\r\n    }\r\n  }\r\n\r\n  while (match = cjsRequireRegEx.exec(source)) {\r\n    // ensure we're not within a string or comment location\r\n    if (!inLocation(stringLocations, match) && !inLocation(commentLocations, match)) {\r\n      var dep = match[1].substr(1, match[1].length - 2);\r\n      // skip cases like require('\" + file + \"')\r\n      if (dep.match(/\"|'/))\r\n        continue;\r\n      deps.push(dep);\r\n    }\r\n  }\r\n\r\n  return deps;\r\n}\r\n\r\n// Global\r\n// bare minimum ignores\r\nvar ignoredGlobalProps = ['_g', 'sessionStorage', 'localStorage', 'clipboardData', 'frames', 'frameElement', 'external',\r\n  'mozAnimationStartTime', 'mozPaintCount', 'webkitStorageInfo', 'webkitIndexedDB', 'mozInnerScreenY', 'mozInnerScreenX'];\r\n\r\nvar globalSnapshot;\r\nexport function globalIterator (globalName) {\r\n  if (ignoredGlobalProps.indexOf(globalName) !== -1)\r\n    return;\r\n  try {\r\n    var value = global[globalName];\r\n  }\r\n  catch (e) {\r\n    ignoredGlobalProps.push(globalName);\r\n  }\r\n  this(globalName, value);\r\n}\r\n\r\nexport function getGlobalValue (exports) {\r\n  if (typeof exports === 'string')\r\n    return readMemberExpression(exports, global);\r\n\r\n  if (!(exports instanceof Array))\r\n    throw new Error('Global exports must be a string or array.');\r\n\r\n  var globalValue = {};\r\n  for (var i = 0; i < exports.length; i++)\r\n    globalValue[exports[i].split('.').pop()] = readMemberExpression(exports[i], global);\r\n  return globalValue;\r\n}\r\n\r\nexport function prepareGlobal (moduleName, exports, globals, encapsulate) {\r\n  // disable module detection\r\n  var curDefine = global.define;\r\n\r\n  global.define = undefined;\r\n\r\n  // set globals\r\n  var oldGlobals;\r\n  if (globals) {\r\n    oldGlobals = {};\r\n    for (var g in globals) {\r\n      oldGlobals[g] = global[g];\r\n      global[g] = globals[g];\r\n    }\r\n  }\r\n\r\n  // store a complete copy of the global object in order to detect changes\r\n  if (!exports) {\r\n    globalSnapshot = {};\r\n\r\n    Object.keys(global).forEach(globalIterator, function (name, value) {\r\n      globalSnapshot[name] = value;\r\n    });\r\n  }\r\n\r\n  // return function to retrieve global\r\n  return function () {\r\n    var globalValue = exports ? getGlobalValue(exports) : {};\r\n\r\n    var singleGlobal;\r\n    var multipleExports = !!exports;\r\n\r\n    if (!exports || encapsulate)\r\n      Object.keys(global).forEach(globalIterator, function (name, value) {\r\n        if (globalSnapshot[name] === value)\r\n          return;\r\n        if (value === undefined)\r\n          return;\r\n\r\n        // allow global encapsulation where globals are removed\r\n        if (encapsulate)\r\n          global[name] = undefined;\r\n\r\n        if (!exports) {\r\n          globalValue[name] = value;\r\n\r\n          if (singleGlobal !== undefined) {\r\n            if (!multipleExports && singleGlobal !== value)\r\n              multipleExports = true;\r\n          }\r\n          else {\r\n            singleGlobal = value;\r\n          }\r\n        }\r\n      });\r\n\r\n    globalValue = multipleExports ? globalValue : singleGlobal;\r\n\r\n    // revert globals\r\n    if (oldGlobals) {\r\n      for (var g in oldGlobals)\r\n        global[g] = oldGlobals[g];\r\n    }\r\n    global.define = curDefine;\r\n\r\n    return globalValue;\r\n  };\r\n}\r\n\r\n// AMD\r\nvar cjsRequirePre = \"(?:^|[^$_a-zA-Z\\\\xA0-\\\\uFFFF.])\";\r\nvar cjsRequirePost = \"\\\\s*\\\\(\\\\s*(\\\"([^\\\"]+)\\\"|'([^']+)')\\\\s*\\\\)\";\r\nvar fnBracketRegEx = /\\(([^\\)]*)\\)/;\r\nvar wsRegEx = /^\\s+|\\s+$/g;\r\n\r\nvar requireRegExs = {};\r\n\r\nfunction amdGetCJSDeps(source, requireIndex) {\r\n\r\n  // remove comments\r\n  source = source.replace(commentRegEx, '');\r\n\r\n  // determine the require alias\r\n  var params = source.match(fnBracketRegEx);\r\n  var requireAlias = (params[1].split(',')[requireIndex] || 'require').replace(wsRegEx, '');\r\n\r\n  // find or generate the regex for this requireAlias\r\n  var requireRegEx = requireRegExs[requireAlias] || (requireRegExs[requireAlias] = new RegExp(cjsRequirePre + requireAlias + cjsRequirePost, 'g'));\r\n\r\n  requireRegEx.lastIndex = 0;\r\n\r\n  var deps = [];\r\n\r\n  var match;\r\n  while (match = requireRegEx.exec(source))\r\n    deps.push(match[2] || match[3]);\r\n\r\n  return deps;\r\n}\r\n\r\nfunction wrapEsModuleExecute (execute) {\r\n  return function (require, exports, module) {\r\n    execute(require, exports, module);\r\n    exports = module.exports;\r\n    if ((typeof exports === 'object' || typeof exports === 'function') && !('__esModule' in exports))\r\n      Object.defineProperty(module.exports, '__esModule', {\r\n        value: true\r\n      });\r\n  };\r\n}\r\n\r\n// generate anonymous define from singular named define\r\nvar multipleNamedDefines = false;\r\nvar lastNamedDefine;\r\nvar curMetaDeps;\r\nvar curEsModule = false;\r\nexport function clearLastDefine (metaDeps, esModule) {\r\n  curMetaDeps = metaDeps;\r\n  curEsModule = esModule;\r\n  lastNamedDefine = undefined;\r\n  multipleNamedDefines = false;\r\n}\r\nexport function registerLastDefine (loader) {\r\n  if (lastNamedDefine)\r\n    loader.registerDynamic(curMetaDeps ? lastNamedDefine[0].concat(curMetaDeps) : lastNamedDefine[0],\r\n        false, curEsModule ? wrapEsModuleExecute(lastNamedDefine[1]) : lastNamedDefine[1]);\r\n\r\n  // bundles are an empty module\r\n  else if (multipleNamedDefines)\r\n    loader.registerDynamic([], false, noop);\r\n}\r\n","import { scriptLoad, isBrowser, isWorker, global, cjsRequireRegEx, addToError, loadNodeModule,\r\n    warn, CONFIG, METADATA, emptyModule, protectedCreateNamespace, resolvedPromise, preloadScript, checkInstantiateWasm } from './common.js';\r\nimport { evaluate } from './evaluate.js';\r\nimport fetch from './fetch.js';\r\nimport { getGlobalValue, getCJSDeps, requireResolve, getPathVars, prepareGlobal, clearLastDefine, registerLastDefine } from './format-helpers.js';\r\n\r\nvar supportsScriptLoad = (isBrowser || isWorker) && typeof navigator !== 'undefined' && navigator.userAgent && !navigator.userAgent.match(/MSIE (9|10).0/);\r\n\r\n// include the node require since we're overriding it\r\nexport var nodeRequire;\r\nif (typeof require !== 'undefined' && typeof process !== 'undefined' && !process.browser)\r\n  nodeRequire = require;\r\n\r\nfunction setMetaEsModule (metadata, moduleValue) {\r\n  if (metadata.load.esModule && (typeof moduleValue === 'object' || typeof moduleValue === 'function') &&\r\n      !('__esModule' in moduleValue))\r\n    Object.defineProperty(moduleValue, '__esModule', {\r\n      value: true\r\n    });\r\n}\r\n\r\nexport function instantiate (key, processAnonRegister) {\r\n  var loader = this;\r\n  var config = this[CONFIG];\r\n  // first do bundles and depCache\r\n  return (loadBundlesAndDepCache(config, this, key) || resolvedPromise)\r\n  .then(function () {\r\n    if (processAnonRegister())\r\n      return;\r\n\r\n    var metadata = loader[METADATA][key];\r\n\r\n    // node module loading\r\n    if (key.substr(0, 6) === '@node/') {\r\n      if (!loader._nodeRequire)\r\n        throw new TypeError('Error loading ' + key + '. Can only load node core modules in Node.');\r\n      loader.registerDynamic([], false, function () {\r\n        return loadNodeModule.call(loader, key.substr(6), loader.baseURL);\r\n      });\r\n      processAnonRegister();\r\n      return;\r\n    }\r\n\r\n    if (metadata.load.scriptLoad ) {\r\n      if (metadata.load.pluginKey || !supportsScriptLoad) {\r\n        metadata.load.scriptLoad = false;\r\n        warn.call(config, 'scriptLoad not supported for \"' + key + '\"');\r\n      }\r\n    }\r\n    else if (metadata.load.scriptLoad !== false && !metadata.load.pluginKey && supportsScriptLoad) {\r\n      // auto script load AMD, global without deps\r\n      if (!metadata.load.deps && !metadata.load.globals &&\r\n          (metadata.load.format === 'system' || metadata.load.format === 'register' || metadata.load.format === 'global' && metadata.load.exports))\r\n        metadata.load.scriptLoad = true;\r\n    }\r\n\r\n    // fetch / translate / instantiate pipeline\r\n    if (!metadata.load.scriptLoad)\r\n      return initializePlugin(loader, key, metadata)\r\n      .then(function () {\r\n        return runFetchPipeline(loader, key, metadata, processAnonRegister, config.wasm);\r\n      })\r\n\r\n    // just script loading\r\n    return new Promise(function (resolve, reject) {\r\n      if (metadata.load.format === 'amd' && global.define !== loader.amdDefine)\r\n        throw new Error('Loading AMD with scriptLoad requires setting the global `' + globalName + '.define = SystemJS.amdDefine`');\r\n\r\n      scriptLoad(key, metadata.load.crossOrigin, metadata.load.integrity, function () {\r\n        if (!processAnonRegister()) {\r\n          metadata.load.format = 'global';\r\n          var globalValue = metadata.load.exports && getGlobalValue(metadata.load.exports);\r\n          loader.registerDynamic([], false, function () {\r\n            setMetaEsModule(metadata, globalValue);\r\n            return globalValue;\r\n          });\r\n          processAnonRegister();\r\n        }\r\n\r\n        resolve();\r\n      }, reject);\r\n    });\r\n  })\r\n  .then(function (instantiated) {\r\n    delete loader[METADATA][key];\r\n    return instantiated;\r\n  });\r\n};\r\n\r\nfunction initializePlugin (loader, key, metadata) {\r\n  if (!metadata.pluginKey)\r\n    return resolvedPromise;\r\n\r\n  return loader.import(metadata.pluginKey).then(function (plugin) {\r\n    metadata.pluginModule = plugin;\r\n    metadata.pluginLoad = {\r\n      name: key,\r\n      address: metadata.pluginArgument,\r\n      source: undefined,\r\n      metadata: metadata.load\r\n    };\r\n    metadata.load.deps = metadata.load.deps || [];\r\n  });\r\n}\r\n\r\nfunction loadBundlesAndDepCache (config, loader, key) {\r\n  // load direct deps, in turn will pick up their trace trees\r\n  var deps;\r\n  if (isBrowser && (deps = config.depCache[key])) {\r\n    for (var i = 0; i < deps.length; i++)\r\n      loader.normalize(deps[i], key).then(preloadScript);\r\n  }\r\n  else {\r\n    var matched = false;\r\n    for (var b in config.bundles) {\r\n      for (var i = 0; i < config.bundles[b].length; i++) {\r\n        var curModule = config.bundles[b][i];\r\n\r\n        if (curModule === key) {\r\n          matched = true;\r\n          break;\r\n        }\r\n\r\n        // wildcard in bundles includes / boundaries\r\n        if (curModule.indexOf('*') !== -1) {\r\n          var parts = curModule.split('*');\r\n          if (parts.length !== 2) {\r\n            config.bundles[b].splice(i--, 1);\r\n            continue;\r\n          }\r\n\r\n          if (key.substr(0, parts[0].length) === parts[0] &&\r\n              key.substr(key.length - parts[1].length, parts[1].length) === parts[1]) {\r\n            matched = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (matched)\r\n        return loader.import(b);\r\n    }\r\n  }\r\n}\r\n\r\nfunction runFetchPipeline (loader, key, metadata, processAnonRegister, wasm) {\r\n  if (metadata.load.exports && !metadata.load.format)\r\n    metadata.load.format = 'global';\r\n\r\n  return resolvedPromise\r\n\r\n  // locate\r\n  .then(function () {\r\n    if (!metadata.pluginModule || !metadata.pluginModule.locate)\r\n      return;\r\n\r\n    return Promise.resolve(metadata.pluginModule.locate.call(loader, metadata.pluginLoad))\r\n    .then(function (address) {\r\n      if (address)\r\n        metadata.pluginLoad.address = address;\r\n    });\r\n  })\r\n\r\n  // fetch\r\n  .then(function () {\r\n    if (!metadata.pluginModule)\r\n      return fetch(key, metadata.load.authorization, metadata.load.integrity, wasm);\r\n\r\n    wasm = false;\r\n\r\n    if (!metadata.pluginModule.fetch)\r\n      return fetch(metadata.pluginLoad.address, metadata.load.authorization, metadata.load.integrity, false);\r\n\r\n    return metadata.pluginModule.fetch.call(loader, metadata.pluginLoad, function (load) {\r\n      return fetch(load.address, metadata.load.authorization, metadata.load.integrity, false);\r\n    });\r\n  })\r\n\r\n  .then(function (fetched) {\r\n    // fetch is already a utf-8 string if not doing wasm detection\r\n    if (!wasm || typeof fetched === 'string')\r\n      return translateAndInstantiate(loader, key, fetched, metadata, processAnonRegister);\r\n\r\n    return checkInstantiateWasm(loader, fetched, processAnonRegister)\r\n    .then(function (wasmInstantiated) {\r\n      if (wasmInstantiated)\r\n        return;\r\n\r\n      // not wasm -> convert buffer into utf-8 string to execute as a module\r\n      // TextDecoder compatibility matches WASM currently. Need to keep checking this.\r\n      // The TextDecoder interface is documented at http://encoding.spec.whatwg.org/#interface-textdecoder\r\n      var stringSource = isBrowser ? new TextDecoder('utf-8').decode(new Uint8Array(fetched)) : fetched.toString();\r\n      return translateAndInstantiate(loader, key, stringSource, metadata, processAnonRegister);\r\n    });\r\n  });\r\n}\r\n\r\nfunction translateAndInstantiate (loader, key, source, metadata, processAnonRegister) {\r\n  return Promise.resolve(source)\r\n  // translate\r\n  .then(function (source) {\r\n    if (metadata.load.format === 'detect')\r\n      metadata.load.format = undefined;\r\n\r\n    readMetaSyntax(source, metadata);\r\n\r\n    if (!metadata.pluginModule)\r\n      return source;\r\n\r\n    metadata.pluginLoad.source = source;\r\n\r\n    if (!metadata.pluginModule.translate)\r\n      return source;\r\n\r\n    return Promise.resolve(metadata.pluginModule.translate.call(loader, metadata.pluginLoad, metadata.traceOpts))\r\n    .then(function (translated) {\r\n      if (metadata.load.sourceMap) {\r\n        if (typeof metadata.load.sourceMap !== 'object')\r\n          throw new Error('metadata.load.sourceMap must be set to an object.');\r\n        sanitizeSourceMap(metadata.pluginLoad.address, metadata.load.sourceMap);\r\n      }\r\n\r\n      if (typeof translated === 'string')\r\n        return translated;\r\n      else\r\n        return metadata.pluginLoad.source;\r\n    });\r\n  })\r\n  .then(function (source) {\r\n    if (!metadata.load.format && source.substring(0, 8) === '\"bundle\"') {\r\n      metadata.load.format = 'system';\r\n      return source;\r\n    }\r\n\r\n    if (metadata.load.format === 'register' || !metadata.load.format && detectRegisterFormat(source)) {\r\n      metadata.load.format = 'register';\r\n      return source;\r\n    }\r\n\r\n    if (metadata.load.format !== 'esm' && (metadata.load.format || !source.match(esmRegEx))) {\r\n      return source;\r\n    }\r\n\r\n    metadata.load.format = 'esm';\r\n    return transpile(loader, source, key, metadata, processAnonRegister);\r\n  })\r\n\r\n  // instantiate\r\n  .then(function (translated) {\r\n    if (typeof translated !== 'string' || !metadata.pluginModule || !metadata.pluginModule.instantiate)\r\n      return translated;\r\n\r\n    var calledInstantiate = false;\r\n    metadata.pluginLoad.source = translated;\r\n    return Promise.resolve(metadata.pluginModule.instantiate.call(loader, metadata.pluginLoad, function (load) {\r\n      translated = load.source;\r\n      metadata.load = load.metadata;\r\n      if (calledInstantiate)\r\n        throw new Error('Instantiate must only be called once.');\r\n      calledInstantiate = true;\r\n    }))\r\n    .then(function (result) {\r\n      if (calledInstantiate)\r\n        return translated;\r\n      return protectedCreateNamespace(result);\r\n    });\r\n  })\r\n  .then(function (source) {\r\n    // plugin instantiate result case\r\n    if (typeof source !== 'string')\r\n      return source;\r\n\r\n    if (!metadata.load.format)\r\n      metadata.load.format = detectLegacyFormat(source);\r\n\r\n    var registered = false;\r\n\r\n    switch (metadata.load.format) {\r\n      case 'esm':\r\n      case 'register':\r\n      case 'system':\r\n        var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\r\n        if (err)\r\n          throw err;\r\n        if (!processAnonRegister())\r\n          return emptyModule;\r\n        return;\r\n      break;\r\n\r\n      case 'json':\r\n        // warn.call(config, '\"json\" module format is deprecated.');\r\n        var parsed = JSON.parse(source);\r\n        return loader.newModule({ default: parsed, __useDefault: parsed });\r\n\r\n      case 'amd':\r\n        var curDefine = global.define;\r\n        global.define = loader.amdDefine;\r\n\r\n        clearLastDefine(metadata.load.deps, metadata.load.esModule);\r\n\r\n        var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\r\n\r\n        // if didn't register anonymously, use the last named define if only one\r\n        registered = processAnonRegister();\r\n        if (!registered) {\r\n          registerLastDefine(loader);\r\n          registered = processAnonRegister();\r\n        }\r\n\r\n        global.define = curDefine;\r\n\r\n        if (err)\r\n          throw err;\r\n      break;\r\n\r\n      case 'cjs':\r\n        var metaDeps = metadata.load.deps;\r\n        var deps = (metadata.load.deps || []).concat(metadata.load.cjsRequireDetection ? getCJSDeps(source) : []);\r\n\r\n        for (var g in metadata.load.globals)\r\n          if (metadata.load.globals[g])\r\n            deps.push(metadata.load.globals[g]);\r\n\r\n        loader.registerDynamic(deps, true, function (require, exports, module) {\r\n          require.resolve = function (key) {\r\n            return requireResolve.call(loader, key, module.id);\r\n          };\r\n          // support module.paths ish\r\n          module.paths = [];\r\n          module.require = require;\r\n\r\n          // ensure meta deps execute first\r\n          if (!metadata.load.cjsDeferDepsExecute && metaDeps)\r\n            for (var i = 0; i < metaDeps.length; i++)\r\n              require(metaDeps[i]);\r\n\r\n          var pathVars = getPathVars(module.id);\r\n          var __cjsWrapper = {\r\n            exports: exports,\r\n            args: [require, exports, module, pathVars.filename, pathVars.dirname, global, global]\r\n          };\r\n\r\n          var cjsWrapper = \"(function (require, exports, module, __filename, __dirname, global, GLOBAL\";\r\n\r\n          // add metadata.globals to the wrapper arguments\r\n          if (metadata.load.globals)\r\n            for (var g in metadata.load.globals) {\r\n              __cjsWrapper.args.push(require(metadata.load.globals[g]));\r\n              cjsWrapper += \", \" + g;\r\n            }\r\n\r\n          // disable AMD detection\r\n          var define = global.define;\r\n          global.define = undefined;\r\n          global.__cjsWrapper = __cjsWrapper;\r\n\r\n          source = cjsWrapper + \") {\" + source.replace(hashBangRegEx, '') + \"\\n}).apply(__cjsWrapper.exports, __cjsWrapper.args);\";\r\n\r\n          var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, false);\r\n          if (err)\r\n            throw err;\r\n\r\n          setMetaEsModule(metadata, exports);\r\n\r\n          global.__cjsWrapper = undefined;\r\n          global.define = define;\r\n        });\r\n        registered = processAnonRegister();\r\n      break;\r\n\r\n      case 'global':\r\n        var deps = metadata.load.deps || [];\r\n        for (var g in metadata.load.globals) {\r\n          var gl = metadata.load.globals[g];\r\n          if (gl)\r\n            deps.push(gl);\r\n        }\r\n\r\n        loader.registerDynamic(deps, false, function (require, exports, module) {\r\n          var globals;\r\n          if (metadata.load.globals) {\r\n            globals = {};\r\n            for (var g in metadata.load.globals)\r\n              if (metadata.load.globals[g])\r\n                globals[g] = require(metadata.load.globals[g]);\r\n          }\r\n\r\n          var exportName = metadata.load.exports;\r\n\r\n          if (exportName)\r\n            source += '\\n' + globalName + '[\"' + exportName + '\"] = ' + exportName + ';';\r\n\r\n          var retrieveGlobal = prepareGlobal(module.id, exportName, globals, metadata.load.encapsulateGlobal);\r\n          var err = evaluate(loader, source, metadata.load.sourceMap, key, metadata.load.integrity, metadata.load.nonce, true);\r\n\r\n          if (err)\r\n            throw err;\r\n\r\n          var output = retrieveGlobal();\r\n          setMetaEsModule(metadata, output);\r\n          return output;\r\n        });\r\n        registered = processAnonRegister();\r\n      break;\r\n\r\n      default:\r\n        throw new TypeError('Unknown module format \"' + metadata.load.format + '\" for \"' + key + '\".' + (metadata.load.format === 'es6' ? ' Use \"esm\" instead here.' : ''));\r\n    }\r\n\r\n    if (!registered)\r\n      throw new Error('Module ' + key + ' detected as ' + metadata.load.format + ' but didn\\'t execute correctly.');\r\n  });\r\n}\r\n\r\nvar globalName = typeof self != 'undefined' ? 'self' : 'global';\r\n\r\n// good enough ES6 module detection regex - format detections not designed to be accurate, but to handle the 99% use case\r\nexport var esmRegEx = /(^\\s*|[}\\);\\n]\\s*)(import\\s*(['\"]|(\\*\\s+as\\s+)?(?!type)([^\"'\\(\\)\\n; ]+)\\s*from\\s*['\"]|\\{)|export\\s+\\*\\s+from\\s+[\"']|export\\s*(\\{|default|function|class|var|const|let|async\\s+function))/;\r\n\r\nvar leadingCommentAndMetaRegEx = /^(\\s*\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\s*\\/\\/[^\\n]*|\\s*\"[^\"]+\"\\s*;?|\\s*'[^']+'\\s*;?)*\\s*/;\r\nexport function detectRegisterFormat(source) {\r\n  var leadingCommentAndMeta = source.match(leadingCommentAndMetaRegEx);\r\n  if (!leadingCommentAndMeta)\r\n    return false;\r\n  var codeStart = leadingCommentAndMeta[0].length;\r\n  return source.startsWith('System.register', codeStart) || source.startsWith('SystemJS.register', codeStart);\r\n}\r\n\r\n// AMD Module Format Detection RegEx\r\n// define([.., .., ..], ...)\r\n// define(varName); || define(function(require, exports) {}); || define({})\r\nvar amdRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.])define\\s*\\(\\s*(\"[^\"]+\"\\s*,\\s*|'[^']+'\\s*,\\s*)?\\s*(\\[(\\s*((\"[^\"]+\"|'[^']+')\\s*,|\\/\\/.*\\r?\\n|\\/\\*(.|\\s)*?\\*\\/))*(\\s*(\"[^\"]+\"|'[^']+')\\s*,?)?(\\s*(\\/\\/.*\\r?\\n|\\/\\*(.|\\s)*?\\*\\/))*\\s*\\]|function\\s*|{|[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*\\))/;\r\n\r\n/// require('...') || exports[''] = ... || exports.asd = ... || module.exports = ...\r\nvar cjsExportsRegEx = /(?:^\\uFEFF?|[^$_a-zA-Z\\xA0-\\uFFFF.])(exports\\s*(\\[['\"]|\\.)|module(\\.exports|\\['exports'\\]|\\[\"exports\"\\])\\s*(\\[['\"]|[=,\\.]))/;\r\nvar commentRegEx = /(^|[^\\\\])(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/mg;\r\n\r\nvar stringRegEx = /(\"[^\"\\\\\\n\\r]*(\\\\.[^\"\\\\\\n\\r]*)*\"|'[^'\\\\\\n\\r]*(\\\\.[^'\\\\\\n\\r]*)*')/g;\r\n\r\n// used to support leading #!/usr/bin/env in scripts as supported in Node\r\nvar hashBangRegEx = /^\\#\\!.*/;\r\n\r\nexport function detectLegacyFormat (source) {\r\n  if (source.match(amdRegEx))\r\n    return 'amd';\r\n\r\n  cjsExportsRegEx.lastIndex = 0;\r\n  cjsRequireRegEx.lastIndex = 0;\r\n  if (cjsRequireRegEx.exec(source) || cjsExportsRegEx.exec(source))\r\n    return 'cjs';\r\n\r\n  // global is the fallback format\r\n  return 'global';\r\n}\r\n\r\nfunction sanitizeSourceMap (address, sourceMap) {\r\n  var originalName = address.split('!')[0];\r\n\r\n  // force set the filename of the original file\r\n  if (!sourceMap.file || sourceMap.file == address)\r\n    sourceMap.file = originalName + '!transpiled';\r\n\r\n  // force set the sources list if only one source\r\n  if (!sourceMap.sources || sourceMap.sources.length <= 1 && (!sourceMap.sources[0] || sourceMap.sources[0] === address))\r\n    sourceMap.sources = [originalName];\r\n}\r\n\r\nfunction transpile (loader, source, key, metadata, processAnonRegister) {\r\n  if (!loader.transpiler)\r\n    throw new TypeError('Unable to dynamically transpile ES module\\n   A loader plugin needs to be configured via `SystemJS.config({ transpiler: \\'transpiler-module\\' })`.');\r\n\r\n  // deps support for es transpile\r\n  if (metadata.load.deps) {\r\n    var depsPrefix = '';\r\n    for (var i = 0; i < metadata.load.deps.length; i++)\r\n      depsPrefix += 'import \"' + metadata.load.deps[i] + '\"; ';\r\n    source = depsPrefix + source;\r\n  }\r\n\r\n  // do transpilation\r\n  return loader.import.call(loader, loader.transpiler)\r\n  .then(function (transpiler) {\r\n    transpiler = transpiler.__useDefault || transpiler;\r\n\r\n    // translate hooks means this is a transpiler plugin instead of a raw implementation\r\n    if (!transpiler.translate)\r\n      throw new Error(loader.transpiler + ' is not a valid transpiler plugin.');\r\n\r\n    // if transpiler is the same as the plugin loader, then don't run twice\r\n    if (transpiler === metadata.pluginModule)\r\n      return source;\r\n\r\n    // convert the source map into an object for transpilation chaining\r\n    if (typeof metadata.load.sourceMap === 'string')\r\n      metadata.load.sourceMap = JSON.parse(metadata.load.sourceMap);\r\n\r\n    metadata.pluginLoad = metadata.pluginLoad || {\r\n      name: key,\r\n      address: key,\r\n      source: source,\r\n      metadata: metadata.load\r\n    };\r\n    metadata.load.deps = metadata.load.deps || [];\r\n\r\n    return Promise.resolve(transpiler.translate.call(loader, metadata.pluginLoad, metadata.traceOpts))\r\n    .then(function (source) {\r\n      // sanitize sourceMap if an object not a JSON string\r\n      var sourceMap = metadata.load.sourceMap;\r\n      if (sourceMap && typeof sourceMap === 'object')\r\n        sanitizeSourceMap(key, sourceMap);\r\n\r\n      if (metadata.load.format === 'esm' && detectRegisterFormat(source))\r\n        metadata.load.format = 'register';\r\n\r\n      return source;\r\n    });\r\n  }, function (err) {\r\n    throw addToError(err, 'Unable to load transpiler to transpile ' + key);\r\n  });\r\n}\r\n\r\n// detect any meta header syntax\r\n// only set if not already set\r\nvar metaRegEx = /^(\\s*\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\s*\\/\\/[^\\n]*|\\s*\"[^\"]+\"\\s*;?|\\s*'[^']+'\\s*;?)+/;\r\nvar metaPartRegEx = /\\/\\*[^\\*]*(\\*(?!\\/)[^\\*]*)*\\*\\/|\\/\\/[^\\n]*|\"[^\"]+\"\\s*;?|'[^']+'\\s*;?/g;\r\n\r\nfunction setMetaProperty(target, p, value) {\r\n  var pParts = p.split('.');\r\n  var curPart;\r\n  while (pParts.length > 1) {\r\n    curPart = pParts.shift();\r\n    target = target[curPart] = target[curPart] || {};\r\n  }\r\n  curPart = pParts.shift();\r\n  if (target[curPart] === undefined)\r\n    target[curPart] = value;\r\n}\r\n\r\nfunction readMetaSyntax (source, metadata) {\r\n  var meta = source.match(metaRegEx);\r\n  if (!meta)\r\n    return;\r\n\r\n  var metaParts = meta[0].match(metaPartRegEx);\r\n\r\n  for (var i = 0; i < metaParts.length; i++) {\r\n    var curPart = metaParts[i];\r\n    var len = curPart.length;\r\n\r\n    var firstChar = curPart.substr(0, 1);\r\n    if (curPart.substr(len - 1, 1) == ';')\r\n      len--;\r\n\r\n    if (firstChar != '\"' && firstChar != \"'\")\r\n      continue;\r\n\r\n    var metaString = curPart.substr(1, curPart.length - 3);\r\n    var metaName = metaString.substr(0, metaString.indexOf(' '));\r\n\r\n    if (metaName) {\r\n      var metaValue = metaString.substr(metaName.length + 1, metaString.length - metaName.length - 1);\r\n\r\n      if (metaName === 'deps')\r\n        metaName = 'deps[]';\r\n\r\n      if (metaName.substr(metaName.length - 2, 2) === '[]') {\r\n        metaName = metaName.substr(0, metaName.length - 2);\r\n        metadata.load[metaName] = metadata.load[metaName] || [];\r\n        metadata.load[metaName].push(metaValue);\r\n      }\r\n      // \"use strict\" is not meta\r\n      else if (metaName !== 'use') {\r\n        setMetaProperty(metadata.load, metaName, metaValue);\r\n      }\r\n    }\r\n    else {\r\n      metadata.load[metaString] = true;\r\n    }\r\n  }\r\n}\r\n","import RegisterLoader from 'es-module-loader/core/register-loader.js';\r\nimport { warn, isBrowser, global, baseURI, CONFIG, METADATA, ModuleNamespace, emptyModule, isModule } from './common.js';\r\n\r\nimport { getConfig, getConfigItem, setConfig } from './config.js';\r\nimport { decanonicalize, normalize, normalizeSync } from './resolve.js';\r\nimport { instantiate, nodeRequire } from './instantiate.js';\r\nimport { setHelpers, setAmdHelper } from './format-helpers.js';\r\n\r\nexport default SystemJSLoader;\r\n\r\nvar scriptSrc;\r\n\r\n// Promise detection and error message\r\nif (typeof Promise === 'undefined')\r\n  throw new Error('SystemJS needs a Promise polyfill.');\r\n\r\nif (typeof document !== 'undefined') {\r\n  var scripts = document.getElementsByTagName('script');\r\n  var curScript = scripts[scripts.length - 1];\r\n  if (document.currentScript && (curScript.defer || curScript.async))\r\n    curScript = document.currentScript;\r\n\r\n  scriptSrc = curScript && curScript.src;\r\n}\r\n// worker\r\nelse if (typeof importScripts !== 'undefined') {\r\n  try {\r\n    throw new Error('_');\r\n  }\r\n  catch (e) {\r\n    e.stack.replace(/(?:at|@).*(http.+):[\\d]+:[\\d]+/, function(m, url) {\r\n      scriptSrc = url;\r\n    });\r\n  }\r\n}\r\n// node\r\nelse if (typeof __filename !== 'undefined') {\r\n  scriptSrc = __filename;\r\n}\r\n\r\nfunction SystemJSLoader () {\r\n  RegisterLoader.call(this);\r\n\r\n  // NB deprecate\r\n  this._loader = {};\r\n\r\n  // internal metadata store\r\n  this[METADATA] = {};\r\n\r\n  // internal configuration\r\n  this[CONFIG] = {\r\n    baseURL: baseURI,\r\n    paths: {},\r\n\r\n    packageConfigPaths: [],\r\n    packageConfigKeys: [],\r\n    map: {},\r\n    packages: {},\r\n    depCache: {},\r\n    meta: {},\r\n    bundles: {},\r\n\r\n    production: false,\r\n\r\n    transpiler: undefined,\r\n    loadedBundles: {},\r\n\r\n    // global behaviour flags\r\n    warnings: false,\r\n    pluginFirst: false,\r\n\r\n    // enable wasm loading and detection when supported\r\n    wasm: false\r\n  };\r\n\r\n  // make the location of the system.js script accessible (if any)\r\n  this.scriptSrc = scriptSrc;\r\n\r\n  this._nodeRequire = nodeRequire;\r\n\r\n  // support the empty module, as a concept\r\n  this.registry.set('@empty', emptyModule);\r\n\r\n  setProduction.call(this, false, false);\r\n\r\n  // add module format helpers\r\n  setHelpers(this);\r\n  setAmdHelper(this);\r\n}\r\n\r\nexport var envModule;\r\nexport function setProduction (isProduction, isBuilder) {\r\n  this[CONFIG].production = isProduction;\r\n  this.registry.set('@system-env', envModule = this.newModule({\r\n    browser: isBrowser,\r\n    node: !!this._nodeRequire,\r\n    production: !isBuilder && isProduction,\r\n    dev: isBuilder || !isProduction,\r\n    build: isBuilder,\r\n    'default': true\r\n  }));\r\n}\r\n\r\nSystemJSLoader.prototype = Object.create(RegisterLoader.prototype);\r\n\r\nSystemJSLoader.prototype.constructor = SystemJSLoader;\r\n\r\n// NB deprecate normalize\r\nSystemJSLoader.prototype[SystemJSLoader.resolve = RegisterLoader.resolve] = SystemJSLoader.prototype.normalize = normalize;\r\n\r\nSystemJSLoader.prototype.load = function (key, parentKey) {\r\n  warn.call(this[CONFIG], 'System.load is deprecated.');\r\n  return this.import(key, parentKey);\r\n};\r\n\r\n// NB deprecate decanonicalize, normalizeSync\r\nSystemJSLoader.prototype.decanonicalize = SystemJSLoader.prototype.normalizeSync = SystemJSLoader.prototype.resolveSync = normalizeSync;\r\n\r\nSystemJSLoader.prototype[SystemJSLoader.instantiate = RegisterLoader.instantiate] = instantiate;\r\n\r\nSystemJSLoader.prototype.config = setConfig;\r\nSystemJSLoader.prototype.getConfig = getConfig;\r\n\r\nSystemJSLoader.prototype.global = global;\r\n\r\nSystemJSLoader.prototype.import = function () {\r\n  return RegisterLoader.prototype.import.apply(this, arguments)\r\n  .then(function (m) {\r\n    return '__useDefault' in m ? m.__useDefault : m;\r\n  });\r\n};\r\n\r\nexport var configNames = ['baseURL', 'map', 'paths', 'packages', 'packageConfigPaths', 'depCache', 'meta', 'bundles', 'transpiler', 'warnings', 'pluginFirst', 'production', 'wasm'];\r\n\r\nvar hasProxy = typeof Proxy !== 'undefined';\r\nfor (var i = 0; i < configNames.length; i++) (function (configName) {\r\n  Object.defineProperty(SystemJSLoader.prototype, configName, {\r\n    get: function () {\r\n      var cfg = getConfigItem(this[CONFIG], configName);\r\n\r\n      if (hasProxy && typeof cfg === 'object')\r\n        cfg = new Proxy(cfg, {\r\n          set: function (target, option) {\r\n            throw new Error('Cannot set SystemJS.' + configName + '[\"' + option + '\"] directly. Use SystemJS.config({ ' + configName + ': { \"' + option + '\": ... } }) rather.');\r\n          }\r\n        });\r\n\r\n      //if (typeof cfg === 'object')\r\n      //  warn.call(this[CONFIG], 'Referencing `SystemJS.' + configName + '` is deprecated. Use the config getter `SystemJS.getConfig(\\'' + configName + '\\')`');\r\n      return cfg;\r\n    },\r\n    set: function (name) {\r\n      throw new Error('Setting `SystemJS.' + configName + '` directly is no longer supported. Use `SystemJS.config({ ' + configName + ': ... })`.');\r\n    }\r\n  });\r\n})(configNames[i]);\r\n\r\n/*\r\n * Backwards-compatible registry API, to be deprecated\r\n */\r\nfunction registryWarn(loader, method) {\r\n  warn.call(loader[CONFIG], 'SystemJS.' + method + ' is deprecated for SystemJS.registry.' + method);\r\n}\r\nSystemJSLoader.prototype.delete = function (key) {\r\n  registryWarn(this, 'delete');\r\n  return this.registry.delete(key);\r\n};\r\nSystemJSLoader.prototype.get = function (key) {\r\n  registryWarn(this, 'get');\r\n  return this.registry.get(key);\r\n};\r\nSystemJSLoader.prototype.has = function (key) {\r\n  registryWarn(this, 'has');\r\n  return this.registry.has(key);\r\n};\r\nSystemJSLoader.prototype.set = function (key, module) {\r\n  registryWarn(this, 'set');\r\n  return this.registry.set(key, module);\r\n};\r\nSystemJSLoader.prototype.newModule = function (bindings) {\r\n  return new ModuleNamespace(bindings);\r\n};\r\nSystemJSLoader.prototype.isModule = isModule;\r\n\r\n// ensure System.register and System.registerDynamic decanonicalize\r\nSystemJSLoader.prototype.register = function (key, deps, declare) {\r\n  if (typeof key === 'string')\r\n    key = decanonicalize.call(this, this[CONFIG], key);\r\n  return RegisterLoader.prototype.register.call(this, key, deps, declare);\r\n};\r\n\r\nSystemJSLoader.prototype.registerDynamic = function (key, deps, executingRequire, execute) {\r\n  if (typeof key === 'string')\r\n    key = decanonicalize.call(this, this[CONFIG], key);\r\n  return RegisterLoader.prototype.registerDynamic.call(this, key, deps, executingRequire, execute);\r\n};\r\n","import { global, isBrowser, isWorker } from './common.js';\r\nimport SystemJSLoader from './systemjs-loader.js';\r\n\r\nSystemJSLoader.prototype.version = VERSION;\r\n\r\nvar System = new SystemJSLoader();\r\n\r\n// only set the global System on the global in browsers\r\nif (isBrowser || isWorker)\r\n  global.SystemJS = global.System = System;\r\n\r\nif (typeof module !== 'undefined' && module.exports)\r\n  module.exports = System;\r\n"]}